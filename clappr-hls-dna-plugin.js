/**
 * clappr-hls-dna-plugin
 * v1.0.87
 * 2021-02-15
 * - @streamroot/hlsjs-dna-wrapper@1.0.93
 * www.streamroot.io
 * Copyright Â© 2018
 **/
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("clappr")):"function"==typeof define&&define.amd?define(["clappr"],e):"object"==typeof exports?exports.HlsDnaPlugin=e(require("clappr")):t.HlsDnaPlugin=e(t.Clappr)}(this,function(t){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};return e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist",e(e.s=8)}([function(t,e,r){!function(e,r){t.exports=r()}(0,function(){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist",e(e.s=51)}([function(t,e){var r=t.exports={version:"2.6.12"};"number"==typeof __e&&(__e=r)},function(t,e){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,e,r){t.exports=!r(13)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,r){var n=r(60),i=r(25);t.exports=function(t){return n(i(t))}},function(t,e,r){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,r){var n=r(1),i=r(0),o=r(39),s=r(8),a=r(7),u=function(t,e,r){var c,l,f,d=t&u.F,h=t&u.G,p=t&u.S,v=t&u.P,g=t&u.B,y=t&u.W,m=h?i:i[e]||(i[e]={}),E=m.prototype,_=h?n:p?n[e]:(n[e]||{}).prototype;h&&(r=e);for(c in r)(l=!d&&_&&void 0!==_[c])&&a(m,c)||(f=l?_[c]:r[c],m[c]=h&&"function"!=typeof _[c]?r[c]:g&&l?o(f,n):y&&_[c]==f?function(t){var e=function(e,r,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,r)}return new t(e,r,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(f):v&&"function"==typeof f?o(Function.call,f):f,v&&((m.virtual||(m.virtual={}))[c]=f,t&u.R&&E&&!E[c]&&s(E,c,f)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e,r){var n=r(12),i=r(40),o=r(26),s=Object.defineProperty;e.f=r(2)?Object.defineProperty:function(t,e,r){if(n(t),e=o(e,!0),n(r),i)try{return s(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},function(t,e){var r={}.hasOwnProperty;t.exports=function(t,e){return r.call(t,e)}},function(t,e,r){var n=r(6),i=r(18);t.exports=r(2)?function(t,e,r){return n.f(t,e,i(1,r))}:function(t,e,r){return t[e]=r,t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,r){var n=r(30)("wks"),i=r(20),o=r(1).Symbol,s="function"==typeof o;(t.exports=function(t){return n[t]||(n[t]=s&&o[t]||(s?o:i)("Symbol."+t))}).store=n},function(t,e,r){"use strict";e.__esModule=!0;var n=r(48),i=function(t){return t&&t.__esModule?t:{default:t}}(n);e.default=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,i.default)(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}()},function(t,e,r){var n=r(9);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,r){!function(e,r){t.exports=r()}(window,function(){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var i in t)e.d(n,i,function(e){return t[e]}.bind(null,i));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=127)}([function(t,e,r){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){var r=t.exports={version:"2.6.12"};"number"==typeof __e&&(__e=r)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(11));e.default=(0,n.default)({STOPPED:"onStopped",MEDIA_ELEMENT_ATTACHED:"onMediaElementAttached",MEDIA_ELEMENT_DETACHED:"onMediaElementDetached",MEDIA_MAP_CREATED:"onMediaMapCreated",MEDIA_MAP_PROCESSED:"onMediaMapProcessed",MEDIA_SEGMENT_REQUESTED:"onMediaSegmentRequested",MEDIA_SEGMENT_FETCHED:"onMediaSegmentFetched",MEDIA_SEGMENT_CONSUMED:"onMediaSegmentConsumed",MEDIA_ENDED:"onMediaEnded",DISTRIBUTOR_ANSWERED:"onDistributorAnswered",DISTRIBUTOR_ANSWER_HANDLED:"onDistributorAnswerHandled",MODULE_CONF_INJECTED:"onModuleconfInjected",LOCAL_CONF_UPDATED:"onLocalConfUpdated",SUBNET_MATCHER_ANSWERED:"onSubnetMatcherAnswered",DNA_CLIENT_LOAD_CONDITION_REACHED:"onDnaClientLoadConditionReached",COMPASS_LOADED:"onCompassLoaded",DNA_CLIENT_LOADED:"onDnaClientLoaded",BACKEND_URLS_CHANGED:"onBackendUrlsChanged",ROUTER_AZ_CHANGED:"onRouterAzChanged",STOP_REPORTING_TRAFFIC:"stopReportingTraffic",RESTART_REPORTING_TRAFFIC:"restartReportingTraffic",NETWORK_TYPE_CHANGED:"networkTypeChanged",CDN_TIMING_EVENT:"cdnTimingEvent",CDN_DOWNLOAD_ERROR:"cdnDownloadError",STREAM_IDENTIFIED:"streamIdentified"}),t.exports=e.default},function(t,e,r){var n=r(5),i=r(1),o=r(13),s=r(14),a=r(18),u=function(t,e,r){var c,l,f,d=t&u.F,h=t&u.G,p=t&u.S,v=t&u.P,g=t&u.B,y=t&u.W,m=h?i:i[e]||(i[e]={}),E=m.prototype,_=h?n:p?n[e]:(n[e]||{}).prototype;for(c in h&&(r=e),r)(l=!d&&_&&void 0!==_[c])&&a(m,c)||(f=l?_[c]:r[c],m[c]=h&&"function"!=typeof _[c]?r[c]:g&&l?o(f,n):y&&_[c]==f?function(t){var e=function(e,r,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,r)}return new t(e,r,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(f):v&&"function"==typeof f?o(Function.call,f):f,v&&((m.virtual||(m.virtual={}))[c]=f,t&u.R&&E&&!E[c]&&s(E,c,f)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e,r){"use strict";e.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(r(66));e.default=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,n.default)(t,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}()},function(t,e){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,e,r){var n=r(63)("wks"),i=r(45),o=r(5).Symbol,s="function"==typeof o;(t.exports=function(t){return n[t]||(n[t]=s&&o[t]||(s?o:i)("Symbol."+t))}).store=n},function(t,e,r){"use strict";function n(t,e){return new s(t,e,o.TIMER_TYPE.INTERVAL)}function i(t,e){return new s(t,e,o.TIMER_TYPE.TIMEOUT)}Object.defineProperty(e,"__esModule",{value:!0}),e.createInterval=n,e.createTimeout=i;var o=r(106),s=r(186)},function(t,e,r){t.exports=!r(15)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,r){var n=r(12),i=r(82),o=r(59),s=Object.defineProperty;e.f=r(8)?Object.defineProperty:function(t,e,r){if(n(t),e=o(e,!0),n(r),i)try{return s(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},function(t,e,r){t.exports={default:r(177),__esModule:!0}},function(t,e,r){var n=r(9);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},function(t,e,r){var n=r(30);t.exports=function(t,e,r){if(n(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}}},function(t,e,r){var n=r(10),i=r(31);t.exports=r(8)?function(t,e,r){return n.f(t,e,i(1,r))}:function(t,e,r){return t[e]=r,t}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,r){t.exports={default:r(136),__esModule:!0}},function(t,e,r){t.exports={default:r(129),__esModule:!0}},function(t,e){var r={}.hasOwnProperty;t.exports=function(t,e){return r.call(t,e)}},function(t,e,r){var n=r(60),i=r(43);t.exports=function(t){return n(i(t))}},function(t,e,r){var n=r(43);t.exports=function(t){return Object(n(t))}},function(t,e,r){t.exports={default:r(145),__esModule:!0}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=n(r(168)),o=n(r(170)),s="function"==typeof o.default&&"symbol"==typeof i.default?function(t){return typeof t}:function(t){return t&&"function"==typeof o.default&&t.constructor===o.default&&t!==o.default.prototype?"symbol":typeof t};e.default="function"==typeof o.default&&"symbol"===s(i.default)?function(t){return void 0===t?"undefined":s(t)}:function(t){return t&&"function"==typeof o.default&&t.constructor===o.default&&t!==o.default.prototype?"symbol":void 0===t?"undefined":s(t)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={GET:"GET",POST:"POST"},i={JSON:"json",ARRAY_BUFFER:"arraybuffer"},o={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},s={INVALID_STATUS:"Response status is not part of valid status codes",REQUEST_ABORTED:"Request has been aborted",REQUEST_ERROR:"An error occured while sending the request",REQUEST_TIMEOUT:"Request timeout"};e.default={Methods:n,ResponseTypes:i,ReadyStates:o,Errors:s},t.exports=e.default},function(t,e,r){"use strict";function n(t,e){return parseFloat(t.toFixed(e))}function i(t,e){for(var r=[],n=e>=t?1:-1,i=Math.min(t*n,e*n),o=Math.max(t*n,e*n),s=i;s<=o;s++)r.push(s*n);return r}function o(t,e,r){for(var n=[],i=t;i<e;i+=r)n.push(i);return n.push(e),n}function s(t,e,r){return Math.min(Math.max(t,e),r)}function a(t,e){return Math.random()*(e-t)+t}Object.defineProperty(e,"__esModule",{value:!0}),e.toDecimal=n,e.range=i,e.steps=o,e.clamp=s,e.randomInRange=a},function(t,e,r){"use strict";e.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(r(17));e.default=n.default||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}},function(t,e,r){var n=r(83),i=r(64);t.exports=Object.keys||function(t){return n(t,i)}},function(t,e,r){"use strict";var n=r(148)(!0);r(69)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=n(e,r),this._i+=t.length,{value:t,done:!1})})},function(t,e){t.exports={}},function(t,e,r){t.exports={default:r(197),__esModule:!0}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,e){t.exports=!0},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,r){var n=r(10).f,i=r(18),o=r(6)("toStringTag");t.exports=function(t,e,r){t&&!i(t=r?t:t.prototype,o)&&n(t,o,{configurable:!0,value:e})}},function(t,e,r){r(153);for(var n=r(5),i=r(14),o=r(28),s=r(6)("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<a.length;u++){var c=a[u],l=n[c],f=l&&l.prototype;f&&!f[s]&&i(f,s,c),o[c]=o.Array}},function(t,e,r){var e,n=r(13),i=r(92),o=r(93),s=r(12),a=r(44),u=r(70),c={},l={};(e=t.exports=function(t,e,r,f,d){var h,p,v,g,y=d?function(){return t}:u(t),m=n(r,f,e?2:1),E=0;if("function"!=typeof y)throw TypeError(t+" is not iterable!");if(o(y)){for(h=a(t.length);h>E;E++)if((g=e?m(s(p=t[E])[0],p[1]):m(t[E]))===c||g===l)return g}else for(v=y.call(t);!(p=v.next()).done;)if((g=i(v,m,p.value,e))===c||g===l)return g}).BREAK=c,e.RETURN=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),i=function t(e,r,i){(0,n.default)(this,t),this.message=e,this.status=r,this.readyState=i};e.default=i,t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(r(22));e.default=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":(0,n.default)(e))&&"function"!=typeof e?t:e}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=n(r(187)),o=n(r(87)),s=n(r(22));e.default=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":(0,s.default)(e)));t.prototype=(0,o.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(i.default?(0,i.default)(t,e):t.__proto__=e)}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(199)),s=function(){function t(){(0,i.default)(this,t)}return t.getIsLive=function(t){return!!t&&!!t.getStreamInfoInteger(o.default.ISLIVE)},t.getManifestUrl=function(t){return t?t.getStreamInfoString(o.default.URL):void 0},t.getSegmentDuration=function(t,e){return t&&e?t.getSegmentInfoInteger(e.track,e.segment,o.default.DURATION):0},t.getTrackType=function(t,e){var r=e.track;return t?t.getTrackInfoString(r,o.default.TYPE):void 0},t.getTrackBitrate=function(t,e){var r=e.track;return t?t.getTrackInfoInteger(r,o.default.BITRATE):0},t.getStreamInfo=function(t){var e={};if(!t)return e;var r=t.getStreamInfoInteger(o.default.TRACKS_COUNT);r>-1&&(e.trackCount=r);var n=t.getTracks().find(function(e){return"video"===t.getTrackInfoString(e,o.default.TYPE)});if(n){var i=t.getTrackInfoInteger(n,o.default.SEGMENTS_COUNT);if(i>-1){e.playListLength=i;var s=t.getTrackInfoInteger(n,o.default.DURATION);s>-1&&i>0&&(e.segmentDuration=Math.round(s/i/1e3*1e3)/1e3)}}return e},t}();e.default=s,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){return"number"==typeof t&&!isNaN(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.isNumeric=e.Delta=void 0;var o=n(r(0)),s=n(r(4)),a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(0,o.default)(this,t),this.u=e}return t.prototype.calcDelta=function(t){var e=t-this.u;return this.u=t,e},t.prototype.override=function(t){this.u=t},(0,s.default)(t,[{key:"lastValue",get:function(){return this.u}}]),t}();e.Delta=a,e.isNumeric=i},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,r){var n=r(61),i=Math.min;t.exports=function(t){return t>0?i(n(t),9007199254740991):0}},function(t,e){var r=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+n).toString(36))}},function(t,e,r){var n=r(12),i=r(88),o=r(64),s=r(62)("IE_PROTO"),a=function(){},u=function(){var t,e=r(58)("iframe"),n=o.length;for(e.style.display="none",r(89).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;n--;)delete u.prototype[o[n]];return u()};t.exports=Object.create||function(t,e){var r;return null!==t?(a.prototype=n(t),r=new a,a.prototype=null,r[s]=t):r=u(),void 0===e?r:i(r,e)}},function(t,e,r){var n=r(32),i=r(6)("toStringTag"),o="Arguments"==n(function(){return arguments}()),s=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,r,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=s(e=Object(t),i))?r:o?n(e):"Object"==(a=n(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,r){t.exports={default:r(152),__esModule:!0}},function(t,e,r){var n=r(45)("meta"),i=r(9),o=r(18),s=r(10).f,a=0,u=Object.isExtensible||function(){return!0},c=!r(15)(function(){return u(Object.preventExtensions({}))}),l=function(t){s(t,n,{value:{i:"O"+ ++a,w:{}}})},f=function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,n)){if(!u(t))return"F";if(!e)return"E";l(t)}return t[n].i},d=function(t,e){if(!o(t,n)){if(!u(t))return!0;if(!e)return!1;l(t)}return t[n].w},h=function(t){return c&&p.NEED&&u(t)&&!o(t,n)&&l(t),t},p=t.exports={KEY:n,NEED:!1,fastKey:f,getWeak:d,onFreeze:h}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(11));e.default=(0,n.default)({DASH:"dash",HLS:"hls",SMOOTH:"smooth",UNKNNOWN:"unknown"}),t.exports=e.default},function(t,e,r){"use strict";(function(e){function n(t){var r,n=e&&e.location||{},i={},o=typeof(t=t||n);if("blob:"===t.protocol)i=new s(unescape(t.pathname),{});else if("string"===o)for(r in i=new s(t,{}),p)delete i[r];else if("object"===o){for(r in t)r in p||(i[r]=t[r]);void 0===i.slashes&&(i.slashes=d.test(t.href))}return i}function i(t){var e=f.exec(t);return{protocol:e[1]?e[1].toLowerCase():"",slashes:!!e[2],rest:e[3]}}function o(t,e){for(var r=(e||"/").split("/").slice(0,-1).concat(t.split("/")),n=r.length,i=r[n-1],o=!1,s=0;n--;)"."===r[n]?r.splice(n,1):".."===r[n]?(r.splice(n,1),s++):s&&(0===n&&(o=!0),r.splice(n,1),s--);return o&&r.unshift(""),"."!==i&&".."!==i||r.push(""),r.join("/")}function s(t,e,r){if(!(this instanceof s))return new s(t,e,r);var a,u,f,d,p,v,g=h.slice(),y=typeof e,m=this,E=0;for("object"!==y&&"string"!==y&&(r=e,e=null),r&&"function"!=typeof r&&(r=l.parse),e=n(e),a=!(u=i(t||"")).protocol&&!u.slashes,m.slashes=u.slashes||a&&e.slashes,m.protocol=u.protocol||e.protocol||"",t=u.rest,u.slashes||(g[3]=[/(.*)/,"pathname"]);E<g.length;E++)"function"!=typeof(d=g[E])?(f=d[0],v=d[1],f!=f?m[v]=t:"string"==typeof f?~(p=t.indexOf(f))&&("number"==typeof d[2]?(m[v]=t.slice(0,p),t=t.slice(p+d[2])):(m[v]=t.slice(p),t=t.slice(0,p))):(p=f.exec(t))&&(m[v]=p[1],t=t.slice(0,p.index)),m[v]=m[v]||a&&d[3]&&e[v]||"",d[4]&&(m[v]=m[v].toLowerCase())):t=d(t);r&&(m.query=r(m.query)),a&&e.slashes&&"/"!==m.pathname.charAt(0)&&(""!==m.pathname||""!==e.pathname)&&(m.pathname=o(m.pathname,e.pathname)),c(m.port,m.protocol)||(m.host=m.hostname,m.port=""),m.username=m.password="",m.auth&&(d=m.auth.split(":"),m.username=d[0]||"",m.password=d[1]||""),m.origin=m.protocol&&m.host&&"file:"!==m.protocol?m.protocol+"//"+m.host:"null",m.href=m.toString()}function a(t,e,r){var n=this;switch(t){case"query":"string"==typeof e&&e.length&&(e=(r||l.parse)(e)),n[t]=e;break;case"port":n[t]=e,c(e,n.protocol)?e&&(n.host=n.hostname+":"+e):(n.host=n.hostname,n[t]="");break;case"hostname":n[t]=e,n.port&&(e+=":"+n.port),n.host=e;break;case"host":n[t]=e,/:\d+$/.test(e)?(e=e.split(":"),n.port=e.pop(),n.hostname=e.join(":")):(n.hostname=e,n.port="");break;case"protocol":n.protocol=e.toLowerCase(),n.slashes=!r;break;case"pathname":case"hash":if(e){var i="pathname"===t?"/":"#";n[t]=e.charAt(0)!==i?i+e:e}else n[t]=e;break;default:n[t]=e}for(var o=0;o<h.length;o++){var s=h[o];s[4]&&(n[s[1]]=n[s[1]].toLowerCase())}return n.origin=n.protocol&&n.host&&"file:"!==n.protocol?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function u(t){t&&"function"==typeof t||(t=l.stringify);var e,r=this,n=r.protocol;n&&":"!==n.charAt(n.length-1)&&(n+=":");var i=n+(r.slashes?"//":"");return r.username&&(i+=r.username,r.password&&(i+=":"+r.password),i+="@"),i+=r.host+r.pathname,(e="object"==typeof r.query?t(r.query):r.query)&&(i+="?"!==e.charAt(0)?"?"+e:e),r.hash&&(i+=r.hash),i}var c=r(181),l=r(182),f=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,d=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,h=[["#","hash"],["?","query"],function(t){return t.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],p={hash:1,query:1};s.prototype={set:a,toString:u},s.extractProtocol=i,s.location=n,s.qs=l,t.exports=s}).call(this,r(67))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.noop=function(){}},function(t,e,r){"use strict";function n(){}function i(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function o(t,e,r,n,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new i(r,n||t,o),a=c?c+e:e;return t.h[a]?t.h[a].fn?t.h[a]=[t.h[a],s]:t.h[a].push(s):(t.h[a]=s,t._++),t}function s(t,e){0==--t._?t.h=new n:delete t.h[e]}function a(){this.h=new n,this._=0}var u=Object.prototype.hasOwnProperty,c="~";Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(c=!1)),a.prototype.eventNames=function(){var t,e,r=[];if(0===this._)return r;for(e in t=this.h)u.call(t,e)&&r.push(c?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},a.prototype.listeners=function(t){var e=c?c+t:t,r=this.h[e];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,i=r.length,o=new Array(i);n<i;n++)o[n]=r[n].fn;return o},a.prototype.listenerCount=function(t){var e=c?c+t:t,r=this.h[e];return r?r.fn?1:r.length:0},a.prototype.emit=function(t,e,r,n,i,o){var s=c?c+t:t;if(!this.h[s])return!1;var a,u,l=this.h[s],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,r),!0;case 4:return l.fn.call(l.context,e,r,n),!0;case 5:return l.fn.call(l.context,e,r,n,i),!0;case 6:return l.fn.call(l.context,e,r,n,i,o),!0}for(u=1,a=new Array(f-1);u<f;u++)a[u-1]=arguments[u];l.fn.apply(l.context,a)}else{var d,h=l.length;for(u=0;u<h;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),f){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,e);break;case 3:l[u].fn.call(l[u].context,e,r);break;case 4:l[u].fn.call(l[u].context,e,r,n);break;default:if(!a)for(d=1,a=new Array(f-1);d<f;d++)a[d-1]=arguments[d];l[u].fn.apply(l[u].context,a)}}return!0},a.prototype.on=function(t,e,r){return o(this,t,e,r,!1)},a.prototype.once=function(t,e,r){return o(this,t,e,r,!0)},a.prototype.removeListener=function(t,e,r,n){var i=c?c+t:t;if(!this.h[i])return this;if(!e)return s(this,i),this;var o=this.h[i];if(o.fn)o.fn!==e||n&&!o.once||r&&o.context!==r||s(this,i);else{for(var a=0,u=[],l=o.length;a<l;a++)(o[a].fn!==e||n&&!o[a].once||r&&o[a].context!==r)&&u.push(o[a]);u.length?this.h[i]=1===u.length?u[0]:u:s(this,i)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=c?c+t:t,this.h[e]&&s(this,e)):(this.h=new n,this._=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=c,a.EventEmitter=a,t.exports=a},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){return(0,c.default)(t,e)}function o(t){for(var e={},r=(0,u.default)(t),n=0;n<r.length;n++){var i=r[n];0!==t[i]&&null!==t[i]&&""!==t[i]&&(e[i]=t[i])}return e}function s(t){return JSON.parse((0,a.default)(t))}Object.defineProperty(e,"__esModule",{value:!0});var a=n(r(16)),u=n(r(21)),c=n(r(17));e.default={merge:i,cleanProperties:o,deepCopy:s},t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(){return{responseType:u.default.ResponseTypes.JSON,validStatusCodes:[].concat((0,o.default)((0,d.range)(200,206)),[304]),timeout:0,withCredentials:!1,headers:{},events:{onprogress:h.noop}}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(214)),s=n(r(0)),a=n(r(54)),u=n(r(23)),c=n(r(215)),l=n(r(223)),f=n(r(224)),d=r(24),h=r(52),p=function(){function t(e,r){(0,s.default)(this,t),this.g=e,this.T=r}return t.prototype.getRequest=function(t,e,r,n){var o=this,s=function(){var n=a.default.merge(i(),r);return new c.default(t,e,n,o.g,o.T&&o.T.CDN_ABORT_ERROR_TIME_THRESHOLD||0)};if(n){if(n.MIN_FACTOR)return new l.default(s(),n);if(n.RETRY)return new f.default(s(),n);throw new Error("Unsupported retryConfig")}return s()},t}();e.default=p,t.exports=e.default},function(t,e,r){t.exports={default:r(216),__esModule:!0}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(2)),s="idle",a="armed",u="triggered",c="disposed",l={IDLE:s,ARMED:a,TRIGGERED:u,DISPOSED:c},f=function(){function t(e){(0,i.default)(this,t),this.O=s,this.g=e}return t.prototype.isConditionMet=function(){return!1},t.prototype.arm=function(){if(this.O!==s&&this.O!==u)throw new Error("Attempt to arm the trigger that is neither idle nor triggered.");this.M(),this.O=a,this.checkTrigger()},t.prototype.M=function(){},t.prototype.checkTrigger=function(){this.O===a&&this.isConditionMet()&&(this.O=u,this.g.emit(o.default.DNA_CLIENT_LOAD_CONDITION_REACHED))},t.prototype.dispose=function(){this.O=c,this.g=null},t}();f.States=l,e.default=f,t.exports=e.default},function(t,e,r){var n=r(9),i=r(5).document,o=n(i)&&n(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,r){var n=r(9);t.exports=function(t,e){if(!n(t))return t;var r,i;if(e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!n(i=r.call(t)))return i;if(!e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,r){var n=r(32);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},function(t,e){var r=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:r)(t)}},function(t,e,r){var n=r(63)("keys"),i=r(45);t.exports=function(t){return n[t]||(n[t]=i(t))}},function(t,e,r){var n=r(1),i=r(5),o="__core-js_shared__",s=i[o]||(i[o]={});(t.exports=function(t,e){return s[t]||(s[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:r(33)?"pure":"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,r){t.exports={default:r(134),__esModule:!0}},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){var n=r(3),i=r(1),o=r(15);t.exports=function(t,e){var r=(i.Object||{})[t]||Object[t],s={};s[t]=e(r),n(n.S+n.F*o(function(){r(1)}),"Object",s)}},function(t,e,r){"use strict";var n=r(33),i=r(3),o=r(91),s=r(14),a=r(28),u=r(149),c=r(35),l=r(86),f=r(6)("iterator"),d=!([].keys&&"next"in[].keys()),h="keys",p="values",v=function(){return this};t.exports=function(t,e,r,g,y,m,E){u(r,e,g);var _,b,T,S=function(t){if(!d&&t in D)return D[t];switch(t){case h:case p:return function(){return new r(this,t)}}return function(){return new r(this,t)}},w=e+" Iterator",A=y==p,R=!1,D=t.prototype,O=D[f]||D["@@iterator"]||y&&D[y],L=O||S(y),C=y?A?S("entries"):L:void 0,I="Array"==e&&D.entries||O;if(I&&(T=l(I.call(new t)))!==Object.prototype&&T.next&&(c(T,w,!0),n||"function"==typeof T[f]||s(T,f,v)),A&&O&&O.name!==p&&(R=!0,L=function(){return O.call(this)}),n&&!E||!d&&!R&&D[f]||s(D,f,L),a[e]=L,a[w]=v,y)if(_={values:A?L:S(p),keys:m?L:S(h),entries:C},E)for(b in _)b in D||o(D,b,_[b]);else i(i.P+i.F*(d||R),e,_);return _}},function(t,e,r){var n=r(47),i=r(6)("iterator"),o=r(28);t.exports=r(1).getIteratorMethod=function(t){if(null!=t)return t[i]||t["@@iterator"]||o[n(t)]}},function(t,e){},function(t,e,r){var n=r(14);t.exports=function(t,e,r){for(var i in e)r&&t[i]?t[i]=e[i]:n(t,i,e[i]);return t}},function(t,e){t.exports=function(t,e,r,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(r+": incorrect invocation!");return t}},function(t,e,r){e.f=r(6)},function(t,e,r){var n=r(5),i=r(1),o=r(33),s=r(74),a=r(10).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:s.f(t)})}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(11));e.default=(0,n.default)({MANIFEST:"manifest",MEDIA_SEGMENT:"mediaSegment",INIT_SEGMENT:"initSegment",OTHER:"other"}),t.exports=e.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(11));e.default=(0,n.default)({EMERGENCY_TRACK_SWITCH:"onEmergencyTrackSwitch",PLAYBACK_ERROR:"onPlaybackError",TRACK_SWITCH:"onTrackSwitch",TRACK_CHANGE_EVENT:"onTrackChange",DROPPED_FRAMES_ABR_CAPPING:"droppedFramesAbrCapping"}),t.exports=e.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={WEB_DESKTOP:"web-desktop",WEB_MOBILE:"web-mobile",ANDROID:"android",IOS:"ios",CHROMECAST:"chromecast",ANDROID_WEBVIEW:"android-webview",UNKNOWN_NATIVE:"unknown-native",UNKNOWN:"unknown",LG_WEB:"lg-web",DESKTOP_ELECTRON:"desktop-electron",TIZEN_WEB:"tizen-web"};e.default=n,t.exports=e.default},function(t,e,r){"use strict";function n(t){var e,r;this.promise=new t(function(t,n){if(void 0!==e||void 0!==r)throw TypeError("Bad Promise constructor");e=t,r=n}),this.resolve=i(e),this.reject=i(r)}var i=r(30);t.exports.f=function(t){return new n(t)}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(4)),s=function(){function t(e,r,n,o,s){(0,i.default)(this,t),this.A=e,this.N=r,this.C=n,this.D=o,this.I=s}return(0,o.default)(t,[{key:"url",get:function(){return this.I}},{key:"requestStats",get:function(){return{startTimestamp:this.A,firstByteReceivedTimestamp:this.N,endTimestamp:this.C,bytesReceived:this.D}}}]),t}();e.default=s,t.exports=e.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={IDLE:0,PLAYING:1,SEEKING:2,BUFFERING:3,BUFFERING_WITH_BUFFER:4,PAUSED:5,ENDED:6};e.default=n,t.exports=e.default},function(t,e,r){t.exports=!r(8)&&!r(15)(function(){return 7!=Object.defineProperty(r(58)("div"),"a",{get:function(){return 7}}).a})},function(t,e,r){var n=r(18),i=r(19),o=r(132)(!1),s=r(62)("IE_PROTO");t.exports=function(t,e){var r,a=i(t),u=0,c=[];for(r in a)r!=s&&n(a,r)&&c.push(r);for(;e.length>u;)n(a,r=e[u++])&&(~o(c,r)||c.push(r));return c}},function(t,e,r){"use strict";e.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(r(66));e.default=function(t,e,r){return e in t?(0,n.default)(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}},function(t,e,r){"use strict";(function(e){function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){return t(e={exports:{}},e.exports),e.exports}function o(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}function s(t){try{return encodeURIComponent(t)}catch(t){return null}}function a(t){for(var e,r=/([^=?#&]+)=?([^&]*)/g,n={};e=r.exec(t);){var i=o(e[1]),s=o(e[2]);null===i||null===s||i in n||(n[i]=s)}return n}function u(t,e){e=e||"";var r,n,i=[];for(n in"string"!=typeof e&&(e="?"),t)if(x.call(t,n)){if((r=t[n])||null!==r&&r!==S&&!isNaN(r)||(r=""),n=s(n),r=s(r),null===n||null===r)continue;i.push(n+"="+r)}return i.length?e+i.join("&"):""}function c(t){return(t||"").toString().replace(j,"")}function l(t){var e,r=("undefined"!=typeof window?window:void 0!==N?N:"undefined"!=typeof self?self:{}).location||{},n={},i=(0,I.default)(t=t||r);if("blob:"===t.protocol)n=new h(unescape(t.pathname),{});else if("string"===i)for(e in n=new h(t,{}),H)delete n[e];else if("object"===i){for(e in t)e in H||(n[e]=t[e]);void 0===n.slashes&&(n.slashes=U.test(t.href))}return n}function f(t){t=c(t);var e=B.exec(t);return{protocol:e[1]?e[1].toLowerCase():"",slashes:!!e[2],rest:e[3]}}function d(t,e){if(""===t)return e;for(var r=(e||"/").split("/").slice(0,-1).concat(t.split("/")),n=r.length,i=r[n-1],o=!1,s=0;n--;)"."===r[n]?r.splice(n,1):".."===r[n]?(r.splice(n,1),s++):s&&(0===n&&(o=!0),r.splice(n,1),s--);return o&&r.unshift(""),"."!==i&&".."!==i||r.push(""),r.join("/")}function h(t,e,r){if(t=c(t),!(this instanceof h))return new h(t,e,r);var n,i,o,s,a,u,p=G.slice(),v=void 0===e?"undefined":(0,I.default)(e),g=this,y=0;for("object"!==v&&"string"!==v&&(r=e,e=null),r&&"function"!=typeof r&&(r=F.parse),e=l(e),n=!(i=f(t||"")).protocol&&!i.slashes,g.slashes=i.slashes||n&&e.slashes,g.protocol=i.protocol||e.protocol||"",t=i.rest,i.slashes||(p[3]=[/(.*)/,"pathname"]);y<p.length;y++)"function"!=typeof(s=p[y])?(o=s[0],u=s[1],o!=o?g[u]=t:"string"==typeof o?~(a=t.indexOf(o))&&("number"==typeof s[2]?(g[u]=t.slice(0,a),t=t.slice(a+s[2])):(g[u]=t.slice(a),t=t.slice(0,a))):(a=o.exec(t))&&(g[u]=a[1],t=t.slice(0,a.index)),g[u]=g[u]||n&&s[3]&&e[u]||"",s[4]&&(g[u]=g[u].toLowerCase())):t=s(t);r&&(g.query=r(g.query)),n&&e.slashes&&"/"!==g.pathname.charAt(0)&&(""!==g.pathname||""!==e.pathname)&&(g.pathname=d(g.pathname,e.pathname)),k(g.port,g.protocol)||(g.host=g.hostname,g.port=""),g.username=g.password="",g.auth&&(s=g.auth.split(":"),g.username=s[0]||"",g.password=s[1]||""),g.origin=g.protocol&&g.host&&"file:"!==g.protocol?g.protocol+"//"+g.host:"null",g.href=g.toString()}function p(t,e,r){var n=this;switch(t){case"query":"string"==typeof e&&e.length&&(e=(r||F.parse)(e)),n[t]=e;break;case"port":n[t]=e,k(e,n.protocol)?e&&(n.host=n.hostname+":"+e):(n.host=n.hostname,n[t]="");break;case"hostname":n[t]=e,n.port&&(e+=":"+n.port),n.host=e;break;case"host":n[t]=e,/:\d+$/.test(e)?(e=e.split(":"),n.port=e.pop(),n.hostname=e.join(":")):(n.hostname=e,n.port="");break;case"protocol":n.protocol=e.toLowerCase(),n.slashes=!r;break;case"pathname":case"hash":if(e){var i="pathname"===t?"/":"#";n[t]=e.charAt(0)!==i?i+e:e}else n[t]=e;break;default:n[t]=e}for(var o=0;o<G.length;o++){var s=G[o];s[4]&&(n[s[1]]=n[s[1]].toLowerCase())}return n.origin=n.protocol&&n.host&&"file:"!==n.protocol?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function v(t){t&&"function"==typeof t||(t=F.stringify);var e,r=this,n=r.protocol;n&&":"!==n.charAt(n.length-1)&&(n+=":");var i=n+(r.slashes?"//":"");return r.username&&(i+=r.username,r.password&&(i+=":"+r.password),i+="@"),i+=r.host+r.pathname,(e="object"==(0,I.default)(r.query)?t(r.query):r.query)&&(i+="?"!==e.charAt(0)?"?"+e:e),r.hash&&(i+=r.hash),i}function g(t){var e=t.reduce(function(t,e){return t+e});return t.map(function(t){return t/e})}function y(t){var e,r;this.promise=new t(function(t,n){if(void 0!==e||void 0!==r)throw TypeError("Bad Promise constructor");e=t,r=n}),this.resolve=At(e),this.reject=At(r)}function m(t,e){return t.substring(t.length-e.length,t.length)===e}function E(t){return m(t,"/")?t.slice(0,-1):t}function _(t){return-1!==t.indexOf("//")?new W(t).host:E(t)}function b(t,e){return t.protocol=e,t.slashes=!0,t}function T(t,e,r){return b("/"===e.charAt(0)?new W(""+t+e,{}):new W(t+"/"+e,{}),r).toString()}var S,w=n(r(137)),A=n(r(87)),R=n(r(142)),D=n(r(21)),O=n(r(66)),L=n(r(90)),C=n(r(48)),I=n(r(22)),P=n(r(17)),M=function(){return(M=P.default||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},k=function(t,e){if(e=e.split(":")[0],!(t=+t))return!1;switch(e){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t},x=Object.prototype.hasOwnProperty,F={stringify:u,parse:a},U=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,B=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,j=new RegExp("^[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]+"),G=[["#","hash"],["?","query"],function(t){return t.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],H={hash:1,query:1};h.prototype={set:p,toString:v},h.extractProtocol=f,h.location=l,h.trimLeft=c,h.qs=F;var V,q,W=h,Y=function(){function t(t,e){if(e<=0||e>=1)throw new RangeError('"weight" option should be > 0 and < 1: '+e);this.ewmaValue=t,this.weight=e}return t.prototype.update=function(t,e){var r=void 0===e?this.weight:e;this.ewmaValue=(1-r)*this.ewmaValue+r*t},Object.defineProperty(t.prototype,"value",{get:function(){return this.ewmaValue},enumerable:!1,configurable:!0}),t}(),K=function(){function t(t,e,r){var n=this;this.conf=e,this.interfaces=r,this.refresh=function(){n.handicapPower*=1-n.conf.ERROR_HANDICAP_DECREASE_RATE},this.errorRateEwma=new Y(t,this.conf.ERROR_RATE_EWMA_WEIGHT),this.handicapPower=0,this.conf.ENABLE_INITIAL_ERROR_HANDICAP&&this.updateHandicapPower(),this.refreshInterval=this.interfaces.timerFactory.createInterval(this.refresh,1e3)}return t.prototype.dispose=function(){this.refreshInterval.clear()},t.prototype.onRequestSuccess=function(){this.errorRateEwma.update(0)},t.prototype.onRequestError=function(){this.updateHandicapPower(),this.errorRateEwma.update(1)},t.prototype.compute=function(){return Math.pow(this.conf.ERROR_HANDICAP_BASE,this.handicapPower)},Object.defineProperty(t.prototype,"errorRate",{get:function(){return this.errorRateEwma.value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"errorHandicapPower",{get:function(){return this.handicapPower},enumerable:!1,configurable:!0}),t.prototype.updateHandicapPower=function(){this.handicapPower=Math.min(this.handicapPower+Math.pow(this.conf.ERROR_PERCENTAGE_BASE,100*this.errorRateEwma.value),this.conf.ERROR_HANDICAP_POWER_CAP)},t}(),z=function(){function t(t,e,r,n,i){this.conf=n,this.interfaces=i,this.scaleCount=0,this.ttfbEwma=null,this.bandwidthEwma=null,this.ttfbInit=t,this.bandwidthInit=this.bandwidthInitRef=e,this.cdnErrorHandicap=new K(r,n,i)}return t.prototype.dispose=function(){this.cdnErrorHandicap.dispose()},t.prototype.update=function(t,e){var r=this.conf.BANDWIDTH_EWMA_HARMONIC?1/e:e;this.ttfbEwma?this.ttfbEwma.update(t):this.ttfbEwma=new Y(t,this.conf.TTFB_EWMA_COEFF),this.bandwidthEwma?this.bandwidthEwma.update(r):this.bandwidthEwma=new Y(r,this.conf.BANDWIDTH_EWMA_COEFF),this.cdnErrorHandicap.onRequestSuccess()},t.prototype.scaleInitBandwidth=function(t){this.scaleCount++;var e=1/this.scaleCount;this.bandwidthInit=e*this.bandwidthInitRef*t+(1-e)*this.bandwidthInit},t.prototype.onError=function(){this.cdnErrorHandicap.onRequestError()},Object.defineProperty(t.prototype,"ttfb",{get:function(){return this.ttfbEwma?this.ttfbEwma.value:this.ttfbInit},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bandwidth",{get:function(){return this.bandwidthEwma?this.conf.BANDWIDTH_EWMA_HARMONIC?1/this.bandwidthEwma.value:this.bandwidthEwma.value:this.bandwidthInit},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"errorRate",{get:function(){return this.cdnErrorHandicap.errorRate},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"errorHandicap",{get:function(){return this.cdnErrorHandicap.compute()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"errorHandicapPower",{get:function(){return this.cdnErrorHandicap.errorHandicapPower},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"score",{get:function(){return this.bandwidth/this.errorHandicap},enumerable:!1,configurable:!0}),t}(),X=function(){function t(t){void 0===t&&(t=0),this.value=t}return t.prototype.calcDelta=function(t){var e=t-this.value;return this.value=t,e},t.prototype.override=function(t){this.value=t},Object.defineProperty(t.prototype,"lastValue",{get:function(){return this.value},enumerable:!1,configurable:!0}),t}(),Q=function(){function t(){this.requestCount=0,this.errorCount=0,this.clientErrorCount=0,this.serverErrorCount=0,this.unknownErrorCount=0,this.sampledTimeBetweenErrors=0,this.downloadedBytes=0,this.downloadedTime=0,this.ttfbSum=0,this.errorTimestampDelta=new X(Date.now())}return t.prototype.onSuccess=function(t,e,r){this.requestCount++,this.downloadedBytes+=t,this.downloadedTime+=e,this.ttfbSum+=r},t.prototype.onError=function(t){switch(this.requestCount++,this.errorCount++,Math.floor(t.status/100)){case 4:this.clientErrorCount++;break;case 5:this.serverErrorCount++;break;default:this.unknownErrorCount++}this.sampledTimeBetweenErrors=this.errorTimestampDelta.calcDelta(Date.now())},t}(),$=function(){function t(t,e,r){this.conf=e,this.interfaces=r,this.isPicked=!1,this.successLog=[],this.errorLog=[],this.id=t.id,this.host=t.host||"",this.name=t.name,this.businessScore=t.businessScore,this.qosScore=new z(e.DEFAULT_TTFB,t.bandwidth,t.errorRate,e,r),this.stats=new Q}return t.prototype.dispose=function(){this.qosScore.dispose()},t.prototype.reportSuccess=function(t){var e=0,r=t.bytesReceived,n=Math.max(t.firstByteReceivedTimestamp-t.startTimestamp,0),i=Math.max(t.endTimestamp-t.startTimestamp,0);if(i>0&&r>=this.conf.BANDWIDTH_MIN_BYTES_THRESHOLD){var o=8*r/i;e=o/this.qosScore.bandwidthInit,this.qosScore.update(n,o)}return this.stats.onSuccess(t.bytesReceived,i,n),this.successLog.push({ts:Date.now(),requestStats:t}),this.successLog.length>this.conf.CDN_REPORT_MAX_LOG_LENGTH&&this.successLog.shift(),{bandwidthInitRatio:e}},t.prototype.reportOtherSuccess=function(t){t.bandwidthInitRatio>0&&t.bandwidthInitRatio>=this.conf.BANDWIDTH_SCALING_RATIO_THRESHOLD&&this.qosScore.scaleInitBandwidth(t.bandwidthInitRatio)},t.prototype.reportError=function(t){this.qosScore.onError(),this.stats.onError(t),this.errorLog.push({ts:Date.now(),httpError:t}),this.errorLog.length>this.conf.CDN_REPORT_MAX_LOG_LENGTH&&this.errorLog.shift()},t.prototype.rewriteUrl=function(t){if(!this.host)return t;var e=new W(t);return e.set("host",this.host),e.href},Object.defineProperty(t.prototype,"score",{get:function(){return this.qosScore.score*this.businessScore},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"publicStats",{get:function(){return{name:this.name,bandwidth:this.qosScore.bandwidth,businessScore:this.businessScore,requestSuccessTs:this.successLog.slice(),requestErrorTs:this.errorLog.slice(),qosScore:this.qosScore.score,globalScore:this.score}},enumerable:!1,configurable:!0}),t}(),Z=function(){function t(t){this.conf=t,this.switchCount=0,this.riskyCount=0,this.lastPickedIndex=-1}return t.prototype.onPick=function(t,e){this.lastPickedIndex!==t&&(this.lastPickedIndex>=0&&this.switchCount++,this.lastPickedIndex=t),e[t]<=e.reduce(function(t,e){return Math.max(t,e)})*this.conf.RISKY_PICK_SCORE_RATIO_THRESHOLD&&this.riskyCount++},t}(),J=function(){function t(t,e,r){this.conf=e,this.currentCdnHost=null,this.cdnByHost=new C.default;for(var n=0,i=r;n<i.length;n++){var o=i[n];null!==o.host&&this.cdnByHost.set(o.host,new $(o,e,t))}this.stats=new Z(e)}return t.prototype.dispose=function(){for(var t=0,e=(0,L.default)(this.cdnByHost.values());t<e.length;t++)e[t].dispose();this.cdnByHost.clear()},t.prototype.findByHost=function(t){return this.cdnByHost.get(t)||null},t.prototype.findByUrl=function(t){var e=new W(t);return this.findByHost(e.host)},Object.defineProperty(t.prototype,"records",{get:function(){return(0,L.default)(this.cdnByHost.values())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"probabilities",{get:function(){var t=this,e=this.records.map(function(t){return t.score}).map(function(e){return Math.pow(e,t.conf.CAUTIOUSNESS)}),r=e.reduce(function(t,e){return t+e},0);return e.map(function(t){return r?t/r:1/e.length})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"publicStats",{get:function(){var t=this.probabilities;return this.records.map(function(e,r){return M(M({},e.publicStats),{probability:t[r]})})},enumerable:!1,configurable:!0}),t}(),tt=function(){function t(t){this.cdnCollection=t}return t.prototype.pick=function(){var t=this.cdnCollection.probabilities;if(0===t.length)return null;for(var e=Math.random(),r=0;r<t.length&&e>=t[r];)e-=t[r],r++;var n=this.cdnCollection.records.map(function(t){return t.score});return this.cdnCollection.stats.onPick(r,n),this.cdnCollection.records[r]},t}(),et=function(){function t(){}return t.prototype.pick=function(){return null},t}(),rt=function(){function t(t){this.cdnRecord=null;var e=t.records;e.length>0&&(this.cdnRecord=e.reduce(function(t,e){return t.score>e.score?t:e}))}return t.prototype.pick=function(){return this.cdnRecord},t}(),nt=function(){function t(t){this.cdnRecord=null;var e=t.records;e.length>0&&(this.cdnRecord=e[Math.floor(Math.random()*e.length)])}return t.prototype.pick=function(){return this.cdnRecord},t}(),it=function(){function t(t){this.sessionCDN=null;var e=t.records,r=[];e.length>0&&e.map(function(t){return t.businessScore}).reduce(function(t,e,n){return t+=e,r[n]=t,t},0);for(var n=Math.random()*r[r.length-1],i=0;i<r.length;i++)if(n<=r[i])return void(this.sessionCDN=e[i])}return t.prototype.pick=function(){return this.sessionCDN},t}(),ot=function(){function t(t){this.cdnRecords=null,this.cdnRecords=t.records}return t.prototype.pick=function(){return this.cdnRecords[Math.floor(Math.random()*this.cdnRecords.length)]},t}(),st=function(){function t(t,e){this.cdnRecord=null,this.cdnRecord=t.records.find(function(t){return t.id===e.QOS_TESTER_CDN_ID}),this.cdnRecord}return t.prototype.pick=function(){return this.cdnRecord||null},t}(),at=function(){function t(){}return t.determinePicker=function(t){return t.QOS_TESTER?t.QOS_TESTER_MODE:"normal"},t.createPicker=function(t,e,r){var n=this.determinePicker(t);switch(n){case"normal":return new tt(r);case"off":return new et;case"session":return new rt(r);case"equal":return new nt(r);case"bscore":return new it(r);case"random":return new ot(r);case"enforce":return new st(r,t);default:return e.errorFunnel.notifyError(new Error("Bogus picker config detected: "+n)),new tt(r)}},t}(),ut=function(){function t(t){this.record=t,this.downloadedBytes=new X,this.downloadedTime=new X,this.requestCount=new X,this.errorCount=new X,this.clientErrorCountDelta=new X,this.serverErrorCountDelta=new X,this.unknownErrorCountDelta=new X,this.ttfbSum=new X}return t.prototype.calculate=function(){var t=this.record,e=t.id,r=t.stats,n=t.host,i=t.publicStats,o=t.isPicked;return{id:e,businessScore:this.record.businessScore,downloadedBytes:this.downloadedBytes.calcDelta(r.downloadedBytes),downloadedTime:this.downloadedTime.calcDelta(r.downloadedTime),requestCount:this.requestCount.calcDelta(r.requestCount),errorCount:this.errorCount.calcDelta(r.errorCount),clientErrorCount:this.clientErrorCountDelta.calcDelta(r.clientErrorCount),serverErrorCount:this.serverErrorCountDelta.calcDelta(r.serverErrorCount),unknownErrorCount:this.unknownErrorCountDelta.calcDelta(r.unknownErrorCount),sampledTimeBetweenErrors:r.sampledTimeBetweenErrors,ttfbSum:this.ttfbSum.calcDelta(r.ttfbSum),cdnHost:n,sampledGlobalScore:i.globalScore,sampledBusinessScore:i.businessScore,sampleQosScore:i.qosScore,isCurrentCdn:o}},t}(),ct=function(){function t(t,e,r){this.cdnCollection=t,this.scoreSampler=e,this.conf=r,this.cdnAnalytics=t.records.map(function(t){return new ut(t)})}return t.prototype.calculate=function(){var t={compass:{provider:this.conf.SCORE_PROVIDER,cdns:this.cdnAnalytics.map(function(t){return function(t){return{id:t.id,bytes:t.downloadedBytes,dTime:t.downloadedTime,sCount:t.requestCount,seCount:t.errorCount,ttfb:t.ttfbSum}}(t.calculate())})}},e=this.scoreSampler.calculateAverageScoresAndDump();return t.compass.cdns.forEach(function(t,r){return(0,P.default)(t,e[r])}),t},t}(),lt=function(){function t(t,e,r,n){this.providerConfig=t,this.cdnCollection=e,this.conf=r,this.updateRequestStats=n,this.switchCount=new X,this.riskyCount=new X,this.downloadedBytes=new X,this.downloadedTime=new X,this.requestCount=new X,this.errorCount=new X,this.ttfbSum=new X,this.requestToUnknownDomain=new X,this.cdnAnalytics=e.records.map(function(t){return new ut(t)})}return t.prototype.calculate=function(){var t=this.calcSum(function(t){return t.stats.downloadedBytes}),e=this.calcSum(function(t){return t.stats.downloadedTime}),r=this.calcSum(function(t){return t.stats.requestCount}),n=this.calcSum(function(t){return t.stats.errorCount}),i=this.calcSum(function(t){return t.stats.ttfbSum}),o=this.cdnCollection.stats;return{compass:{pickerMode:at.determinePicker(this.conf),confLabel:this.conf.CONF_LABEL,cdns:this.cdnAnalytics.map(function(t){return t.calculate()}),switchCount:this.switchCount.calcDelta(o.switchCount),riskyCount:this.riskyCount.calcDelta(o.riskyCount),downloadedBytes:this.downloadedBytes.calcDelta(t),downloadedTime:this.downloadedTime.calcDelta(e),requestCount:this.requestCount.calcDelta(r),errorCount:this.errorCount.calcDelta(n),ttfbSum:this.ttfbSum.calcDelta(i),requestToUnknownDomainCount:this.requestToUnknownDomain.calcDelta(this.updateRequestStats.requestToUnknownDomainCount),cdnListName:this.providerConfig.cdnListName||"",currentCdnHost:this.cdnCollection.currentCdnHost}}},t.prototype.calcSum=function(t){return this.cdnCollection.records.map(t).reduce(function(t,e){return t+e},0)},t}(),ft=function(){function t(t,e){this.cdnCollection=t,this.conf=e}return t.prototype.calculate=function(){return{compass:{confLabel:this.conf.CONF_LABEL}}},t}(),dt=function(){function t(t){this.conf=t}return t.prototype.calculate=function(){return{compass:{pickerMode:at.determinePicker(this.conf)}}},t}(),ht=function(){function t(t,e,r,n,i){this.trafficAnalytics=new ct(r,i,e),this.statsAnalytics=new lt(t,r,e,n),this.controlAnalytics=new ft(r,e),this.supportAnalytics=new dt(e)}return t.prototype.calculatePayload=function(t){switch(t){case"traffic":return this.trafficAnalytics.calculate();case"stats":return this.statsAnalytics.calculate();case"control":return this.controlAnalytics.calculate();case"support":return this.supportAnalytics.calculate();default:return{}}},t}(),pt=function(){this.requestToUnknownDomainCount=0},vt=function(){function t(){this.sum=0,this.count=0}return t.prototype.put=function(t){this.sum+=t,this.count++},t.prototype.average=function(){return this.sum/this.count},t.prototype.dump=function(){this.sum=0,this.count=0},t}(),gt=function(){function t(t,e,r){var n=this;this.cdnCollection=t,this.samplingInterval=null,this.globalScoreBuckets=[],this.qosScoreBuckets=[],this.businessScores=[],this.hasSamples=!1,this.sampleCdnCollectionInfo=function(){var t=n.cdnCollection.records.map(function(t,e){return t.score}),e=n.cdnCollection.records.map(function(t,e){return t.qosScore.score}),r=g(t),i=g(e);r.forEach(function(t,e){return n.globalScoreBuckets[e].put(t)}),i.forEach(function(t,e){return n.qosScoreBuckets[e].put(t)}),n.hasSamples=!0},this.globalScoreBuckets=t.records.map(function(){return new vt}),this.qosScoreBuckets=t.records.map(function(){return new vt}),this.businessScores=this.cdnCollection.records.map(function(t){return t.businessScore}),this.samplingInterval=e.timerFactory.createInterval(this.sampleCdnCollectionInfo,r.SCORES_SAMPLING_RATE)}return t.prototype.calculateAverageScoresAndDump=function(){var t=this;this.hasSamples||this.sampleCdnCollectionInfo();var e=[];return this.globalScoreBuckets.forEach(function(r,n){e.push({angScore:t.globalScoreBuckets[n].average(),anqScore:t.qosScoreBuckets[n].average(),bScore:t.businessScores[n]}),t.globalScoreBuckets[n].dump(),t.qosScoreBuckets[n].dump()}),this.hasSamples=!1,e},t.prototype.dispose=function(){null!=this.samplingInterval&&this.samplingInterval.clear()},t}(),yt=function(){function t(t,e,r){var n=this;this.scoreProvider=t,this.interfaces=e,this.conf=r,this.cdnCollection=null,this.cdnPicker=null,this.lastPickedCdn=null,this.updateRequestStats=null,this.analyticsProvider=null,this.isDisposed=!1,this.scoreSampler=null,this.scoreProvider.fetch().then(function(i){n.isDisposed||(n.cdnCollection=new J(e,r,i),n.scoreSampler=new gt(n.cdnCollection,e,r),n.cdnPicker=at.createPicker(r,e,n.cdnCollection),n.updateRequestStats=new pt,n.analyticsProvider=new ht(t.providerConfig,r,n.cdnCollection,n.updateRequestStats,n.scoreSampler))}).catch(function(t){n.isDisposed||e.errorFunnel.notify("Failed to fetch CDN scores",t.toString())})}return t.prototype.dispose=function(){this.isDisposed=!0,this.cdnPicker=null,this.scoreSampler&&this.scoreSampler.dispose(),this.cdnCollection&&this.cdnCollection.dispose(),this.scoreProvider.dispose()},t.prototype.reportCdnSuccess=function(t,e){if(this.cdnCollection){var r=this.cdnCollection.findByUrl(t);if(r)for(var n=r.reportSuccess(e),i=0,o=this.cdnCollection.records;i<o.length;i++){var s=o[i];s!==r&&s.reportOtherSuccess(n)}}},t.prototype.reportCdnError=function(t,e){if(this.cdnCollection){var r=this.cdnCollection.findByUrl(t);r&&r.reportError(e)}},t.prototype.getUpdatedRequest=function(t){if(!this.cdnPicker)return t;var e=this.cdnPicker.pick();if(!e)return t;this.lastPickedCdn&&(this.lastPickedCdn.isPicked=!1),this.lastPickedCdn=e,e.isPicked=!0;var r=new W(t.url).host;if(!this.cdnCollection||!this.cdnCollection.findByHost(r))return this.updateRequestStats&&this.updateRequestStats.requestToUnknownDomainCount++,t;this.cdnCollection.currentCdnHost=e.host;var n=this.interfaces.compassConfig;if(n&&n.reconfigureRequest){var i={id:e.id,host:e.host,name:e.name};t.headers=t.headers||{},t.withCredentials=t.withCredentials||!1;var o=n.reconfigureRequest(t,i);if(o)return o}return t.url=e.rewriteUrl(t.url),t},t.prototype.getAnalytics=function(t){return this.analyticsProvider?this.analyticsProvider.calculatePayload(t):{}},Object.defineProperty(t.prototype,"stats",{get:function(){return{cdnList:this.cdnCollection?this.cdnCollection.publicStats:[]}},enumerable:!1,configurable:!0}),t}(),mt={CONF_LABEL:"default",SCORE_PROVIDER:"streamroot",CITRIX_API_URL:"//hopx.cedexis.com/zones/1/customers",COMPASS_API_URL:"https://backend.dna-delivery.com/compass/cdns",COMPASS_API_DIMENSIONS:["isp","country"],REQUEST_RETRY:{COMPASS:{TIMEOUT:1e4,MIN_DELAY:3e4,MAX_DELAY:3e5,MIN_FACTOR:2,MAX_FACTOR:2.4},CITRIX:{TIMEOUT:1e4,MIN_DELAY:3e4,MAX_DELAY:3e5,MIN_FACTOR:2,MAX_FACTOR:2.4}},DEFAULT_TTFB:0,DEFAULT_BANDWIDTH:1e5,DEFAULT_ERROR_RATE:0,DEFAULT_BUSINESS_SCORE:1,ERROR_RATE_EWMA_WEIGHT:.01,ERROR_HANDICAP_BASE:10,ERROR_HANDICAP_POWER_CAP:100,ERROR_PERCENTAGE_BASE:2,ERROR_HANDICAP_DECREASE_RATE:.005,ENABLE_INITIAL_ERROR_HANDICAP:!1,TTFB_EWMA_COEFF:.25,BANDWIDTH_EWMA_COEFF:.25,BANDWIDTH_EWMA_HARMONIC:!1,BANDWIDTH_MIN_BYTES_THRESHOLD:4e4,BANDWIDTH_SCALING_RATIO_THRESHOLD:0,CAUTIOUSNESS:3,RISKY_PICK_SCORE_RATIO_THRESHOLD:.5,CDN_REPORT_MAX_LOG_LENGTH:50,CITRIX_ERROR_RATE_SCALING_RATIO:1,QOS_TESTER:!1,QOS_TESTER_MODE:"off",QOS_TESTER_CDN_ID:"",SCORES_SAMPLING_RATE:5e3};(q=V||(V={})).CITRIX="citrix",q.NPAW="npaw",q.STREAMROOT="streamroot";var Et=Math.ceil,_t=Math.floor,bt=function(t){return isNaN(t=+t)?0:(t>0?_t:Et)(t)},Tt=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},St=i(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),wt=i(function(t){var e=t.exports={version:"2.6.12"};"number"==typeof __e&&(__e=e)}),At=(wt.version,function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}),Rt=function(t,e,r){if(At(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}},Dt=function(t){return"object"==(void 0===t?"undefined":(0,I.default)(t))?null!==t:"function"==typeof t},Ot=function(t){if(!Dt(t))throw TypeError(t+" is not an object!");return t},Lt=function(t){try{return!!t()}catch(t){return!0}},Ct=!Lt(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),It=St.document,Pt=Dt(It)&&Dt(It.createElement),Mt=function(t){return Pt?It.createElement(t):{}},Nt=!Ct&&!Lt(function(){return 7!=Object.defineProperty(Mt("div"),"a",{get:function(){return 7}}).a}),kt=function(t,e){if(!Dt(t))return t;var r,n;if(e&&"function"==typeof(r=t.toString)&&!Dt(n=r.call(t)))return n;if("function"==typeof(r=t.valueOf)&&!Dt(n=r.call(t)))return n;if(!e&&"function"==typeof(r=t.toString)&&!Dt(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")},xt=O.default,Ft={f:Ct?O.default:function(t,e,r){if(Ot(t),e=kt(e,!0),Ot(r),Nt)try{return xt(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},Ut=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},Bt=Ct?function(t,e,r){return Ft.f(t,e,Ut(1,r))}:function(t,e,r){return t[e]=r,t},jt={}.hasOwnProperty,Gt=function(t,e){return jt.call(t,e)},Ht=function t(e,r,n){var i,o,s,a=e&t.F,u=e&t.G,c=e&t.S,l=e&t.P,f=e&t.B,d=e&t.W,h=u?wt:wt[r]||(wt[r]={}),p=h.prototype,v=u?St:c?St[r]:(St[r]||{}).prototype;for(i in u&&(n=r),n)(o=!a&&v&&void 0!==v[i])&&Gt(h,i)||(s=o?v[i]:n[i],h[i]=u&&"function"!=typeof v[i]?n[i]:f&&o?Rt(s,St):d&&v[i]==s?function(t){var e=function(e,r,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,r)}return new t(e,r,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(s):l&&"function"==typeof s?Rt(Function.call,s):s,l&&((h.virtual||(h.virtual={}))[i]=s,e&t.R&&p&&!p[i]&&Bt(p,i,s)))};Ht.F=1,Ht.G=2,Ht.S=4,Ht.P=8,Ht.B=16,Ht.W=32,Ht.U=64,Ht.R=128;var Vt=Ht,qt=Bt,Wt={},Yt={}.toString,Kt=function(t){return Yt.call(t).slice(8,-1)},zt=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==Kt(t)?t.split(""):Object(t)},Xt=function(t){return zt(Tt(t))},Qt=Math.min,$t=function(t){return t>0?Qt(bt(t),9007199254740991):0},Zt=Math.max,Jt=Math.min,te=function(t,e){return(t=bt(t))<0?Zt(t+e,0):Jt(t,e)},ee=i(function(t){var e=St["__core-js_shared__"]||(St["__core-js_shared__"]={});(t.exports=function(t,r){return e[t]||(e[t]=void 0!==r?r:{})})("versions",[]).push({version:wt.version,mode:"pure",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})}),re=0,ne=Math.random(),ie=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++re+ne).toString(36))},oe=ee("keys"),se=function(t){return oe[t]||(oe[t]=ie(t))},ae=function(t){return function(e,r,n){var i,o=Xt(e),s=$t(o.length),a=te(n,s);if(t&&r!=r){for(;s>a;)if((i=o[a++])!=i)return!0}else for(;s>a;a++)if((t||a in o)&&o[a]===r)return t||a||0;return!t&&-1}}(!1),ue=se("IE_PROTO"),ce=function(t,e){var r,n=Xt(t),i=0,o=[];for(r in n)r!=ue&&Gt(n,r)&&o.push(r);for(;e.length>i;)Gt(n,r=e[i++])&&(~ae(o,r)||o.push(r));return o},le="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),fe=D.default||function(t){return ce(t,le)},de=Ct?R.default:function(t,e){Ot(t);for(var r,n=fe(e),i=n.length,o=0;i>o;)Ft.f(t,r=n[o++],e[r]);return t},he=St.document,pe=he&&he.documentElement,ve=se("IE_PROTO"),ge=function(){},ye=function(){var t,e=Mt("iframe"),r=le.length;for(e.style.display="none",pe.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),ye=t.F;r--;)delete ye.prototype[le[r]];return ye()},me=A.default||function(t,e){var r;return null!==t?(ge.prototype=Ot(t),r=new ge,ge.prototype=null,r[ve]=t):r=ye(),void 0===e?r:de(r,e)},Ee=i(function(t){var e=ee("wks"),r=St.Symbol,n="function"==typeof r;(t.exports=function(t){return e[t]||(e[t]=n&&r[t]||(n?r:ie)("Symbol."+t))}).store=e}),_e=Ft.f,be=Ee("toStringTag"),Te=function(t,e,r){t&&!Gt(t=r?t:t.prototype,be)&&_e(t,be,{configurable:!0,value:e})},Se={};Bt(Se,Ee("iterator"),function(){return this});var we=function(t,e,r){t.prototype=me(Se,{next:Ut(1,r)}),Te(t,e+" Iterator")},Ae=function(t){return Object(Tt(t))},Re=se("IE_PROTO"),De=Object.prototype,Oe=w.default||function(t){return t=Ae(t),Gt(t,Re)?t[Re]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?De:null},Le=Ee("iterator"),Ce=!([].keys&&"next"in[].keys()),Ie="values",Pe=function(){return this},Me=function(t,e,r,n,i,o,s){we(r,e,n);var a,u,c,l=function(t){if(!Ce&&t in p)return p[t];switch(t){case"keys":case Ie:return function(){return new r(this,t)}}return function(){return new r(this,t)}},f=e+" Iterator",d=i==Ie,h=!1,p=t.prototype,v=p[Le]||p["@@iterator"]||i&&p[i],g=v||l(i),y=i?d?l("entries"):g:void 0,m="Array"==e&&p.entries||v;if(m&&(c=Oe(m.call(new t)))!==Object.prototype&&c.next&&Te(c,f,!0),d&&v&&v.name!==Ie&&(h=!0,g=function(){return v.call(this)}),s&&(Ce||h||!p[Le])&&Bt(p,Le,g),Wt[e]=g,Wt[f]=Pe,i)if(a={values:d?g:l(Ie),keys:o?g:l("keys"),entries:y},s)for(u in a)u in p||qt(p,u,a[u]);else Vt(Vt.P+Vt.F*(Ce||h),e,a);return a},Ne=function(t){return function(e,r){var n,i,o=String(Tt(e)),s=bt(r),a=o.length;return s<0||s>=a?t?"":void 0:(n=o.charCodeAt(s))<55296||n>56319||s+1===a||(i=o.charCodeAt(s+1))<56320||i>57343?t?o.charAt(s):n:t?o.slice(s,s+2):i-56320+(n-55296<<10)+65536}}(!0);Me(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=Ne(e,r),this._i+=t.length,{value:t,done:!1})});var ke=function(t,e){return{value:e,done:!!t}};Me(Array,"Array",function(t,e){this._t=Xt(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,ke(1)):ke(0,"keys"==e?r:"values"==e?t[r]:[r,t[r]])},"values"),Wt.Arguments=Wt.Array;for(var xe=Ee("toStringTag"),Fe="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),Ue=0;Ue<Fe.length;Ue++){var Be=Fe[Ue],je=St[Be],Ge=je&&je.prototype;Ge&&!Ge[xe]&&Bt(Ge,xe,Be),Wt[Be]=Wt.Array}var He,Ve,qe,We=Ee("toStringTag"),Ye="Arguments"==Kt(function(){return arguments}()),Ke=function(t,e){try{return t[e]}catch(t){}},ze=function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=Ke(e=Object(t),We))?r:Ye?Kt(e):"Object"==(n=Kt(e))&&"function"==typeof e.callee?"Arguments":n},Xe=function(t,e,r,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(r+": incorrect invocation!");return t},Qe=function(t,e,r,n){try{return n?e(Ot(r)[0],r[1]):e(r)}catch(e){var i=t.return;throw void 0!==i&&Ot(i.call(t)),e}},$e=Ee("iterator"),Ze=Array.prototype,Je=function(t){return void 0!==t&&(Wt.Array===t||Ze[$e]===t)},tr=Ee("iterator"),er=wt.getIteratorMethod=function(t){if(null!=t)return t[tr]||t["@@iterator"]||Wt[ze(t)]},rr=i(function(t){var e={},r={},n=t.exports=function(t,n,i,o,s){var a,u,c,l,f=s?function(){return t}:er(t),d=Rt(i,o,n?2:1),h=0;if("function"!=typeof f)throw TypeError(t+" is not iterable!");if(Je(f)){for(a=$t(t.length);a>h;h++)if((l=n?d(Ot(u=t[h])[0],u[1]):d(t[h]))===e||l===r)return l}else for(c=f.call(t);!(u=c.next()).done;)if((l=Qe(c,d,u.value,n))===e||l===r)return l};n.BREAK=e,n.RETURN=r}),nr=Ee("species"),ir=function(t,e){var r,n=Ot(t).constructor;return void 0===n||null==(r=Ot(n)[nr])?e:At(r)},or=function(t,e,r){var n=void 0===r;switch(e.length){case 0:return n?t():t.call(r);case 1:return n?t(e[0]):t.call(r,e[0]);case 2:return n?t(e[0],e[1]):t.call(r,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(r,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(r,e[0],e[1],e[2],e[3])}return t.apply(r,e)},sr=St.process,ar=St.setImmediate,ur=St.clearImmediate,cr=St.MessageChannel,lr=St.Dispatch,fr=0,dr={},hr=function(){var t=+this;if(dr.hasOwnProperty(t)){var e=dr[t];delete dr[t],e()}},pr=function(t){hr.call(t.data)};ar&&ur||(ar=function(t){for(var e=[],r=1;arguments.length>r;)e.push(arguments[r++]);return dr[++fr]=function(){or("function"==typeof t?t:Function(t),e)},He(fr),fr},ur=function(t){delete dr[t]},"process"==Kt(sr)?He=function(t){sr.nextTick(Rt(hr,t,1))}:lr&&lr.now?He=function(t){lr.now(Rt(hr,t,1))}:cr?(qe=(Ve=new cr).port2,Ve.port1.onmessage=pr,He=Rt(qe.postMessage,qe,1)):St.addEventListener&&"function"==typeof postMessage&&!St.importScripts?(He=function(t){St.postMessage(t+"","*")},St.addEventListener("message",pr,!1)):He="onreadystatechange"in Mt("script")?function(t){pe.appendChild(Mt("script")).onreadystatechange=function(){pe.removeChild(this),hr.call(t)}}:function(t){setTimeout(Rt(hr,t,1),0)});var vr={set:ar,clear:ur},gr=vr.set,yr=St.MutationObserver||St.WebKitMutationObserver,mr=St.process,Er=St.Promise,_r="process"==Kt(mr),br={f:function(t){return new y(t)}},Tr=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}},Sr=St.navigator,wr=Sr&&Sr.userAgent||"",Ar=function(t,e){if(Ot(t),Dt(e)&&e.constructor===t)return e;var r=br.f(t);return(0,r.resolve)(e),r.promise},Rr=Ee("species"),Dr=Ee("iterator"),Or=!1;try{var Lr=[7][Dr]();Lr.return=function(){Or=!0},(0,L.default)(Lr,function(){throw 2})}catch(q){}var Cr,Ir,Pr,Mr,Nr=vr.set,kr=function(){var t,e,r,n=function(){var n,i;for(_r&&(n=mr.domain)&&n.exit();t;){i=t.fn,t=t.next;try{i()}catch(n){throw t?r():e=void 0,n}}e=void 0,n&&n.enter()};if(_r)r=function(){mr.nextTick(n)};else if(!yr||St.navigator&&St.navigator.standalone)if(Er&&Er.resolve){var i=Er.resolve(void 0);r=function(){i.then(n)}}else r=function(){gr.call(St,n)};else{var o=!0,s=document.createTextNode("");new yr(n).observe(s,{characterData:!0}),r=function(){s.data=o=!o}}return function(n){var i={fn:n,next:void 0};e&&(e.next=i),t||(t=i,r()),e=i}}(),xr="Promise",Fr=St.TypeError,Ur=St.process,Br=Ur&&Ur.versions,jr=Br&&Br.v8||"",Gr=St.Promise,Hr="process"==ze(Ur),Vr=function(){},qr=Ir=br.f,Wr=!!function(){try{var t=Gr.resolve(1),e=(t.constructor={})[Ee("species")]=function(t){t(Vr,Vr)};return(Hr||"function"==typeof PromiseRejectionEvent)&&t.then(Vr)instanceof e&&0!==jr.indexOf("6.6")&&-1===wr.indexOf("Chrome/66")}catch(t){}}(),Yr=function(t){var e;return!(!Dt(t)||"function"!=typeof(e=t.then))&&e},Kr=function(t,e){if(!t._n){t._n=!0;var r=t._c;kr(function(){for(var n=t._v,i=1==t._s,o=0;r.length>o;)!function(e){var r,o,s,a=i?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{a?(i||(2==t._h&&Qr(t),t._h=1),!0===a?r=n:(l&&l.enter(),r=a(n),l&&(l.exit(),s=!0)),r===e.promise?c(Fr("Promise-chain cycle")):(o=Yr(r))?o.call(r,u,c):u(r)):c(n)}catch(t){l&&!s&&l.exit(),c(t)}}(r[o++]);t._c=[],t._n=!1,e&&!t._h&&zr(t)})}},zr=function(t){Nr.call(St,function(){var e,r,n,i=t._v,o=Xr(t);if(o&&(e=Tr(function(){Hr?Ur.emit("unhandledRejection",i,t):(r=St.onunhandledrejection)?r({promise:t,reason:i}):(n=St.console)&&n.error&&n.error("Unhandled promise rejection",i)}),t._h=Hr||Xr(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},Xr=function(t){return 1!==t._h&&0===(t._a||t._c).length},Qr=function(t){Nr.call(St,function(){var e;Hr?Ur.emit("rejectionHandled",t):(e=St.onrejectionhandled)&&e({promise:t,reason:t._v})})},$r=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),Kr(e,!0))},Zr=function t(e){var r,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw Fr("Promise can't be resolved itself");(r=Yr(e))?kr(function(){var i={_w:n,_d:!1};try{r.call(e,Rt(t,i,1),Rt($r,i,1))}catch(t){$r.call(i,t)}}):(n._v=e,n._s=1,Kr(n,!1))}catch(e){$r.call({_w:n,_d:!1},e)}}};Wr||(Gr=function(t){Xe(this,Gr,xr,"_h"),At(t),Cr.call(this);try{t(Rt(Zr,this,1),Rt($r,this,1))}catch(t){$r.call(this,t)}},(Cr=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(t,e,r){for(var n in e)r&&t[n]?t[n]=e[n]:Bt(t,n,e[n]);return t}(Gr.prototype,{then:function(t,e){var r=qr(ir(this,Gr));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=Hr?Ur.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&Kr(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),Pr=function(){var t=new Cr;this.promise=t,this.resolve=Rt(Zr,t,1),this.reject=Rt($r,t,1)},br.f=qr=function(t){return t===Gr||t===Mr?new Pr(t):Ir(t)}),Vt(Vt.G+Vt.W+Vt.F*!Wr,{Promise:Gr}),Te(Gr,xr),function(t){var e="function"==typeof wt[t]?wt[t]:St[t];Ct&&e&&!e[Rr]&&Ft.f(e,Rr,{configurable:!0,get:function(){return this}})}(xr),Mr=wt.Promise,Vt(Vt.S+Vt.F*!Wr,xr,{reject:function(t){var e=qr(this);return(0,e.reject)(t),e.promise}}),Vt(Vt.S+!0*Vt.F,xr,{resolve:function(t){return Ar(this===Mr?Gr:this,t)}}),Vt(Vt.S+Vt.F*!(Wr&&function(t,e){if(!e&&!Or)return!1;var r=!1;try{var n=[7],i=n[Dr]();i.next=function(){return{done:r=!0}},n[Dr]=function(){return i},t(n)}catch(t){}return r}(function(t){Gr.all(t).catch(Vr)})),xr,{all:function(t){var e=this,r=qr(e),n=r.resolve,i=r.reject,o=Tr(function(){var r=[],o=0,s=1;rr(t,!1,function(t){var a=o++,u=!1;r.push(void 0),s++,e.resolve(t).then(function(t){u||(u=!0,r[a]=t,--s||n(r))},i)}),--s||n(r)});return o.e&&i(o.v),r.promise},race:function(t){var e=this,r=qr(e),n=r.reject,i=Tr(function(){rr(t,!1,function(t){e.resolve(t).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}});var Jr=wt.Promise,tn=function(){function t(t,e,r){var n=t.id,i=t.host,o=t.name,s=t.businessScore,a=t.bandwidth,u=t.errorRate;this.interfaces=r,this.id=n,this.host=this.validateHost(i),this.name=o,this.businessScore=this.sanitizeInitValue(s,0,1,e.DEFAULT_BUSINESS_SCORE,"business score"),this.bandwidth=this.sanitizeInitValue(a,0,1/0,e.DEFAULT_BANDWIDTH,"bandwidth"),this.errorRate=this.sanitizeInitValue(u,0,1,e.DEFAULT_ERROR_RATE,"errorRate")}return t.prototype.validateHost=function(t){var e=t;-1===e.indexOf("//")&&(e="//"+e);var r=new W(e);return r.pathname&&"/"!==r.pathname?(this.interfaces.errorFunnel.notifyError(new Error("COMPASS: CDN url '"+t+"' is unsupported. Contains path")),null):r.host||null},t.prototype.sanitizeInitValue=function(t,e,r,n,i){return t<e||t>r?(this.interfaces.errorFunnel.notifyError(new Error("COMPASS: Unexpected value for initial "+i+": "+t)),n):t},t}(),en=function(){function t(t,e,r){this.providerConfig=t,this.interfaces=e,this.conf=r,this.request=null}return t.prototype.getEffectiveCompassAPIUrl=function(){return null!=this.providerConfig.providerHost?T(_(this.providerConfig.providerHost),"/compass/cdns","https"):this.conf.COMPASS_API_URL},t.prototype.fetch=function(){var t=this;return new Jr(function(e,r){var n=t.getEffectiveCompassAPIUrl()+"?customerId="+encodeURIComponent(t.providerConfig.streamrootKey)+"&cdnListName="+encodeURIComponent(t.providerConfig.cdnListName);t.conf.COMPASS_API_DIMENSIONS&&(n+="&"+t.conf.COMPASS_API_DIMENSIONS.map(function(t){return"dimensions="+encodeURIComponent(t)}).join("&"));var i={timeout:t.conf.REQUEST_RETRY.COMPASS.TIMEOUT},o=t.conf.REQUEST_RETRY.COMPASS,s=t.interfaces.httpRequestFactory;t.request=s.getRequest("GET",n,i,o),t.request.isStreamroot=!0,t.request.send().then(function(r){for(var n=[],i=0,o=r.cdns;i<o.length;i++){var s=o[i],a=s.id,u=s.url,c=s.name,l=s.businessScore,f=s.throughput,d=s.errorRatio;n.push(new tn({id:a,host:u,name:c,businessScore:l,bandwidth:null!=f&&f>=0?1.024*f:t.conf.DEFAULT_BANDWIDTH,errorRate:null!=d&&d>=0?d:t.conf.DEFAULT_ERROR_RATE},t.conf,t.interfaces))}e(n)}).catch(function(t){r(new Error("Request to Compass service failed. Status: "+t.status+" "+t.message))})})},t.prototype.dispose=function(){this.request&&(this.request.abort(),this.request=null)},t}(),rn=function(){function t(t,e,r){this.providerConfig=t,this.interfaces=e,this.conf=r,this.request=null}return t.prototype.getEndpointUrl=function(){var t=this.providerConfig.credentials;return this.conf.CITRIX_API_URL+"/"+t.citrixCustomerID+"/apps/"+t.citrixAppID+"/decision"},t.prototype.unwrap=function(t,e,r){return void 0!==t&&void 0!==t[e]?t[e]:(this.interfaces.errorFunnel.notifyError(new Error("Missing property "+e+" from Citrix API response")),r)},t.prototype.fetch=function(){var t=this;return new Jr(function(e,r){var n=t.getEndpointUrl(),i={timeout:t.conf.REQUEST_RETRY.CITRIX.TIMEOUT},o=t.conf.REQUEST_RETRY.CITRIX,s=t.interfaces.httpRequestFactory;t.request=s.getRequest("GET",n,i,o),t.request.isStreamroot=!0,t.request.send().then(function(r){for(var n=[],i=0,o=r.providers;i<o.length;i++){var s=o[i],a=s.host,u=s.custom,c=s.provider,l=c,f=c,d=t.unwrap(u,"bandwidth",t.conf.DEFAULT_BANDWIDTH),h=parseFloat(t.unwrap(u,"bizScore",t.conf.DEFAULT_BUSINESS_SCORE)),p=t.unwrap(u,"avail",100*(1-t.conf.DEFAULT_ERROR_RATE));n.push(new tn({id:l,host:a,name:f,businessScore:h,bandwidth:d,errorRate:(100-p)*t.conf.CITRIX_ERROR_RATE_SCALING_RATIO/100},t.conf,t.interfaces))}e(n)}).catch(function(t){r(new Error("Request to Citrix service failed. Status: "+t.status+" "+t.message))})})},t.prototype.dispose=function(){this.request&&(this.request.abort(),this.request=null)},t}(),nn=function(){function t(){}return Object.defineProperty(t,"version",{get:function(){return"1.3.1"},enumerable:!1,configurable:!0}),t.prototype.streamrootKey=function(t){return this.mStreamrootKey=t,this},t.prototype.interfaces=function(t){return this.mInterfaces=M({},t),this},t.prototype.config=function(t){return this.mConf=M({},mt),t.CONF_LABEL?this.recursiveConfInjection(this.mConf,t,"",this.mInterfaces.errorFunnel):this.mInterfaces&&this.mInterfaces.errorFunnel.notify("Missing CONF_LABEL for Compass","Injected conf has no CONF_LABEL parameter."),this},t.prototype.scoreProvider=function(t,e){switch(t){case V.CITRIX:this.mScoreProvider=new rn(e,this.mInterfaces,this.mConf);break;case V.STREAMROOT:this.mScoreProvider=new en(M(M({},e),{streamrootKey:this.mStreamrootKey}),this.mInterfaces,this.mConf);break;default:throw new Error("Score provider not implemented")}return this.mConf.SCORE_PROVIDER=t,this},t.prototype.build=function(){return this.mScoreProvider?new yt(this.mScoreProvider,this.mInterfaces,this.mConf):null},t.prototype.recursiveConfInjection=function(t,e,r,n){var i=this;(0,D.default)(e).forEach(function(o){var s=""===r?o:r+"."+o;void 0!==t[o]?"object"!=(0,I.default)(e[o])||Array.isArray(e[o])?t[o]=e[o]:i.recursiveConfInjection(t[o],e[o],s,n):n&&n.notify("Unknown parameter "+s+" for Compass","Injected parameter "+s+" does not exist in default conf.")})},t.newBuilder=function(){return new t},t}();t.exports=nn}).call(this,r(67))},function(t,e,r){var n=r(18),i=r(20),o=r(62)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),n(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,r){t.exports={default:r(140),__esModule:!0}},function(t,e,r){var n=r(10),i=r(12),o=r(26);t.exports=r(8)?Object.defineProperties:function(t,e){i(t);for(var r,s=o(e),a=s.length,u=0;a>u;)n.f(t,r=s[u++],e[r]);return t}},function(t,e,r){var n=r(5).document;t.exports=n&&n.documentElement},function(t,e,r){t.exports={default:r(147),__esModule:!0}},function(t,e,r){t.exports=r(14)},function(t,e,r){var n=r(12);t.exports=function(t,e,r,i){try{return i?e(n(r)[0],r[1]):e(r)}catch(e){var o=t.return;throw void 0!==o&&n(o.call(t)),e}}},function(t,e,r){var n=r(28),i=r(6)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||o[i]===t)}},function(t,e,r){var n=r(6)("iterator"),i=!1;try{var o=[7][n]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var r=!1;try{var o=[7],s=o[n]();s.next=function(){return{done:r=!0}},o[n]=function(){return s},t(o)}catch(t){}return r}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,r){"use strict";var n=r(5),i=r(1),o=r(10),s=r(8),a=r(6)("species");t.exports=function(t){var e="function"==typeof i[t]?i[t]:n[t];s&&e&&!e[a]&&o.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e,r){var n=r(9);t.exports=function(t,e){if(!n(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,r){var n=r(32);t.exports=Array.isArray||function(t){return"Array"==n(t)}},function(t,e,r){var n=r(83),i=r(64).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,i)}},function(t,e,r){var n=r(34),i=r(31),o=r(19),s=r(59),a=r(18),u=r(82),c=Object.getOwnPropertyDescriptor;e.f=r(8)?c:function(t,e){if(t=o(t),e=s(e,!0),u)try{return c(t,e)}catch(t){}if(a(t,e))return i(!n.f.call(t,e),t[e])}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(11));e.default=(0,n.default)({ARRAY_BUFFER:"arraybuffer",TEXT:"text"}),t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(25)),o=n(r(0)),s=r(103),a=n(r(2)),u=n(r(76)),c=n(r(23)),l=(n(r(38)),n(r(104)),n(r(105))),f=function(){function t(e,r){(0,o.default)(this,t),this.j=e,this.L=r,this.V={responseType:r.responseType,withCredentials:r.withCredentials||!1,headers:r.headers||{},timeout:r.timeout||0,events:{onprogress:this.H.bind(this)}},this.A=0,this.q=null,this.Y=0}return t.prototype.fetch=function(t){var e=this;this.K=t,this.A=Date.now();var r=this.j.httpRequestFactory.getRequest(c.default.Methods.GET,this.L.url,this.V);return r.send().then(function(n){e.X();var o=n instanceof l.default?n.data.buffer:n,c=o instanceof ArrayBuffer?o.byteLength:o.length,f={timeElapsed:Date.now()-e.A,latency:e.Y,lengthComputable:!0,loaded:c,total:c};e.L.contentType===u.default.MEDIA_SEGMENT&&e.j.eventBus.emit(a.default.MEDIA_SEGMENT_FETCHED,e.L,o),t.onSuccess((0,i.default)({},e.L,{responseURL:r.responseURL}),o,f);var d=e.j.segmentBaseAdapter;if(null!=d&&o instanceof ArrayBuffer){var h=(0,s.findSidx)(new Uint8Array(o));null!=h&&d.submitIndexSegment(e.L.url,h)}},function(r){if(t.onError){var n={status:r.status,message:r.message};t.onError(e.L,n)}}),r},t.prototype.H=function(t){if(this.L&&this.K){var e=this.L,r=this.K;this.X();var n={timeElapsed:Date.now()-this.A,latency:this.Y,lengthComputable:t.lengthComputable,loaded:t.loaded,total:t.total};r.onProgress&&r.onProgress(e,n)}},t.prototype.X=function(){null===this.q&&(this.q=Date.now(),this.Y=this.q-this.A)},t}();e.default=f,t.exports=e.default},function(t,e,r){"use strict";function n(t){for(var e=l[3],r=0,n=0;n<t.length;n++)r+=e*t[n],e/=l[1];return r}function i(t){for(var e=l[1],r=0,n=0;n<t.length;n++)r+=e*t[n],e/=l[1];return r}function o(t){var e=n(t.subarray(0,4));return e>1?e:0===e?t.byteLength:null}function s(t){for(var e=t.subarray(4,8),r="",n=0;n<e.length;n++){var i=e[n];if(i<97||i>122)return null;r+=String.fromCharCode(i)}return r}function a(t){for(var e=t;e.length>0;){var r=o(e),n=s(e);if(null===r||null===n)break;if(r>t.byteLength)break;if("styp"===n||"moof"===n||"mdat"===n)break;if("sidx"===n)return e;e=e.subarray(r)}return null}function u(t){var e=o(t),r=s(t);return null!==e&&e<=t.byteLength&&"sidx"===r}function c(t,e){if(void 0===e&&(e=0),u(t)){var r=8,o=t.subarray(r,r+1)[0];if(r+=8,o>0)throw new Error("64-bit offsets not supported.");var s=n(t.subarray(r,r+4));if(r+=4,0===s)throw new Error("Timescale can not be zero");var a=n(t.subarray(r,r+4))/s;r+=4;var c=e+n(t.subarray(r,r+4));r+=6;var l=i(t.subarray(r,r+2));r+=2;for(var f=[];l>0;){if(r>=t.byteLength)throw new Error("Parsed past end-of-data.");var d=n(t.subarray(r,r+4));r+=4,d&1<<31&&(d&=~(1<<31));var h=n(t.subarray(r,r+4))/s;f.push([c,a,h]),c+=d,a+=h,r+=8,l--}return t.byteLength,f}throw new Error("Input data is not a sidx MP4 box.")}Object.defineProperty(e,"__esModule",{value:!0});var l=[1,256,65536,1<<24];e.findSidx=a,e.isSidx=u,e.parse=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),i=function t(e,r,i){(0,n.default)(this,t),this.lengthComputable=e,this.loaded=r,this.total=i};e.default=i,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(4)),s=function(){function t(e){if((0,i.default)(this,t),"number"==typeof e)this.data=new Uint8Array(e);else{if(!(e instanceof ArrayBuffer))throw new Error(t.ERR_WRONG_PARAM_TYPE);this.data=new Uint8Array(e)}}return t.prototype.getBinaryData=function(e,r){return new t(this.data.slice(e,e+r).buffer)},t.prototype.setBinaryData=function(t,e){if(t){if(e+t.byteLength>this.data.byteLength)throw new RangeError("Trying to write past expected byteLength in setBinaryData");0===e&&t.byteLength===this.data.byteLength?this.data=t.data:this.data.set(t.data,e)}},t.prototype.equals=function(t){return!1},t.prototype.destroy=function(){},(0,o.default)(t,[{key:"byteLength",get:function(){return this.data.byteLength}}]),t}();s.ERR_CANNOT_SET_BYTE_LENGTH="Cannot manually set the byteLength",s.ERR_WRONG_PARAM_TYPE="Wrong parameter in BinaryDataInterface Constructor",e.default=s,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.TIMER_TYPE=e.AbstractTimer=void 0;var i=n(r(0)),o=n(r(4)),s=n(r(107)),a={TIMEOUT:0,INTERVAL:1},u=function(){function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.TIMEOUT;(0,i.default)(this,t),this.$="timer-"+s.default.v4(),this.J=this.$,this.Z=e,this.tt=r,this.nt=n,this.it=n===a.INTERVAL}return t.prototype.clear=function(){throw new Error("Cannot call abstract method")},(0,o.default)(t,[{key:"id",get:function(){return this.$}},{key:"name",set:function(t){this.J=t},get:function(){return this.J}}]),t}();e.AbstractTimer=u,e.TIMER_TYPE=a},function(t,e,r){var n=r(184),i=r(185),o=i;o.v1=n,o.v4=i,t.exports=o},function(t,e,r){(function(e){var r,n=e.crypto||e.msCrypto;if(n&&n.getRandomValues){var i=new Uint8Array(16);r=function(){return n.getRandomValues(i),i}}if(!r){var o=new Array(16);r=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),o[e]=t>>>((3&e)<<3)&255;return o}}t.exports=r}).call(this,r(67))},function(t,e){function r(t,e){var r=e||0,i=n;return i[t[r++]]+i[t[r++]]+i[t[r++]]+i[t[r++]]+"-"+i[t[r++]]+i[t[r++]]+"-"+i[t[r++]]+i[t[r++]]+"-"+i[t[r++]]+i[t[r++]]+"-"+i[t[r++]]+i[t[r++]]+i[t[r++]]+i[t[r++]]+i[t[r++]]+i[t[r++]]}for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);t.exports=r},function(t,e,r){t.exports={default:r(202),__esModule:!0}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(4)),s=n(r(53)),a=n(r(112)),u=n(r(115)),c=n(r(210)),l=n(r(213)),f=n(r(55)),d=n(r(225)),h=n(r(226)),p=n(r(227)),v=n(r(228)),g=n(r(120)),y=n(r(230)),m=n(r(232)),E=n(r(233)),_=n(r(234)),b=n(r(246)),T=window.document.currentScript&&window.document.currentScript.src?window.document.currentScript.src:null,S=function(){function t(e,r,n,o){(0,i.default)(this,t),this.peerAgentCounter=0,this.parserAdapter=null,this.streamrootKey=e,this.et=r,this.eventBus=new s.default,this.environment=new u.default,this.dnaConfig=new l.default(n),this.manifestDetector=new b.default(this.eventBus),this.configManager=new a.default(e,r,this.dnaConfig,o||"",T,this.manifestDetector),this.httpRequestFactory=new f.default(this.eventBus,this.configManager.conf),this.qosAnalyticsHandler=new _.default(this,r),this.errorFunnel=new c.default(this),this.errorFunnel.setCustomer(this.configManager.getStreamrootKey()),this.errorFunnel.setScriptOrigin(T),this.rt=new m.default(this),this.moduleManager=window["sr-module-manager"],this.moduleManager.interfaces={httpRequestFactory:new f.default},this.clear()}return t.prototype.dispose=function(){this.networkTypeStats&&this.networkTypeStats.dispose(),this.rt.dispose(),this.st&&this.st.dispose(),this.configManager.clear(),this.qosAnalyticsHandler.dispose()},t.prototype.clear=function(){this.parserAdapter&&(null!=this.parserAdapter.delete&&this.parserAdapter.delete(),delete this.parserAdapter),this.configManager.clear(),this.costStats=new d.default,this.backendStats=new h.default,this.mediaEngineStats&&this.mediaEngineStats.dispose(),this.mediaEngineStats=new p.default(this.eventBus,this.configManager),this.st&&this.st.dispose(),this.st=new E.default(this.et,this.configManager.conf,this.errorFunnel,this.mediaEngineStats),this.networkTypeStats&&this.networkTypeStats.dispose(),this.networkTypeStats=new y.default(this.eventBus,this.rt.currentType),this.bitrateStats&&this.bitrateStats.dispose(),this.bitrateStats=new v.default(this.eventBus,this.configManager),this.transferStats&&this.transferStats.dispose(),this.transferStats=new g.default(this.eventBus),this.segmentBaseAdapter&&(this.segmentBaseAdapter.dispose(),delete this.segmentBaseAdapter),this.manifestDetector.clear()},(0,o.default)(t,[{key:"hasDistributorResponded",get:function(){return this.configManager.hasDistributorResponded()}},{key:"currentNetworkType",get:function(){return this.rt.currentType}}]),t}();e.default=S,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(21)),o=n(r(22)),s=n(r(25)),a=n(r(0)),u=n(r(51)),c=n(r(107)),l=n(r(113)),f=r(205),d=n(r(54)),h=r(114),p=n(r(50)),v=n(r(206)),g=n(r(207)),y=n(r(208)),m=n(r(41)),E=function(){function t(e,r,n,i,o,s){(0,a.default)(this,t),this.ot=null,this.ut={},this.ct="",this.ht="",this.at={},this.ft=c.default.v4(),this.lt=e,this.et=r,this.dt=n,this.vt=this.wt(n),this.pt=this.bt(n);var u=r.getMediaEngineName()+" "+r.getMediaEngineVersion();this.Et=u.substring(0,30),this.yt=i.substring(0,15),this.gt=o,this.Tt=s,this.clear()}return t.prototype.clear=function(){this.Ot="",this.Mt="",this.St=null,this.At=null,this.Rt=!1,this.Nt=!0,this.Ct=!1,this.conf=d.default.deepCopy(l.default)},t.prototype.setStreamType=function(t){switch(t){case p.default.HLS:this.Dt=p.default.HLS;break;case p.default.DASH:this.Dt=p.default.DASH;break;case p.default.SMOOTH:this.Dt=p.default.SMOOTH;break;default:this.Dt=p.default.UNKNOWN}},t.prototype.setContentUrl=function(t){this.It=t,this.Ot=this.jt(t),this.Mt=this.kt(t),this.St=this.Lt(t),this.At=this.Pt(t)},t.prototype.setIntegrationVersion=function(t){this.Ut=t},t.prototype.setPeerAgentVersion=function(t){this.Ft=t},t.prototype.setCompassVersion=function(t){this.Bt=t},t.prototype.setAz=function(t){this.xt=(0,h.removeTrailingSlash)(t)},t.prototype.setDistributorResponse=function(t){this.Vt=t,this.Rt=this.Ht(),this.Ct=this.Gt(),this.qt=t.token,this.ft=t.peerId||this.ft},t.prototype.setSiteId=function(t){if(this.zt=t.siteId,"unknownSiteId"!==this.zt){var e=t.dnaEnabled;this.Nt=null==e||e}else{var r=this.getPropertyParameters().unknownSubnetAllow;this.Nt=null==r||r}},t.prototype.isLive=function(){return this.Tt.isLive},t.prototype.isContentActivated=function(){if(this.Vt&&this.Vt.backendCounts){var t=this.Vt.backendCounts,e=t.contentActivated,r=t.usageQuotaReached;return this.Vt.activateMesh&&!r&&e}return!1},t.prototype.isRampUpActivated=function(){return this.Rt&&this.Nt},t.prototype.isActivated=function(){return this.isContentActivated()&&this.isRampUpActivated()&&!this.conf.QOS_P2P_DISABLED},t.prototype.isCompassPropertyActivated=function(){if(this.Vt&&this.Vt.compass&&this.Vt.compass.backendCounts){var t=this.Vt.compass.backendCounts.usageQuotaReached;return this.Vt.activateOrchestrator&&!t}return!1},t.prototype.isCompassRampUpActivated=function(){return this.Ct},t.prototype.isCompassActivated=function(){return this.isCompassPropertyActivated()&&this.isCompassRampUpActivated()&&!this.conf.QOS_COMPASS_DISABLED},t.prototype.hasDistributorResponded=function(){return void 0!==this.Vt},t.prototype.getActivationStatus=function(){if(void 0===this.Vt)return v.default.UNKNOWN;var t=this.Vt.backendCounts,e=t.contentActivated,r=t.usageQuotaReached;return this.Vt.activateMesh?r?v.default.DEACTIVATED_BY_USAGE_QUOTA:e?this.Rt?this.conf.QOS_P2P_DISABLED?v.default.QOS_TESTER:this.Nt?v.default.ACTIVATED:v.default.EXCLUDED_FROM_MESH:v.default.DEACTIVATED_BY_RAMP_UP:v.default.DEACTIVATED_BY_CONTENT:v.default.DEACTIVATED_BY_BYPASS},t.prototype.getCompassActivationStatus=function(){return void 0===this.Vt?g.default.UNKNOWN:this.Vt.activateOrchestrator?this.Ct?!this.isCompassPropertyActivated()||this.conf.QOS_COMPASS_DISABLED?g.default.MODULE_DISABLED:g.default.ACTIVATED:g.default.DEACTIVATED_BY_RAMP_UP:g.default.DEACTIVATED_BY_BYPASS},t.prototype.getStreamrootKey=function(){return this.lt},t.prototype.getContentId=function(){return this.Ot},t.prototype.getDefaultContentId=function(){return this.Mt},t.prototype.getSiteId=function(){return this.dt.siteId||this.zt||null},t.prototype.getProperty=function(){return this.St||"default"},t.prototype.getCompassProperty=function(){return this.At||"default"},t.prototype.getBackendHost=function(){return this.vt},t.prototype.getBackendUrls=function(){return{trackerUrl:this.getTrackerUrl(),signalingUrl:this.getSignalingUrl()}},t.prototype.getPropertyParameters=function(){var t=this.Vt.propertyParameters,e=this.getProperty();return(0,s.default)({},t,{requested:e})},t.prototype.getCompassPropertyParameters=function(){var t=(this.Vt.compass?this.Vt.compass:{}).propertyParameters,e=this.getCompassProperty();return(0,s.default)({},t,{requested:e})},t.prototype.getVersions=function(){return{wrapperVersion:this.yt,mediaEngineTag:this.Et,streamrooterVersion:"1.23.0",integrationVersion:this.Ut||"",peerAgentVersion:this.Ft||"",compassVersion:this.Bt||"",integrationTag:"w"+this.yt+"-s1.23.0"}},t.prototype.getParserOptions=function(){return{hlsIdentifierFormat:this.conf.HLS_IDENTIFIER_FORMAT,ssaiEnabled:!!this.Vt.propertyParameters.ssaiEnabled,ssaiProvider:this.Vt.propertyParameters.ssaiProvider,ssaiVariant:this.conf.HLS_SSAI_VARIANT,ssaiOptions:this.Vt.propertyParameters.ssaiOptions}},t.prototype.getDnaClientUrl=function(){return this.ct},t.prototype.getHostingOption=function(){return this.at},t.prototype.getBaseRepoUrl=function(){return this.ht},t.prototype.getAsyncLoadingOption=function(){return this.pt},t.prototype.getDeliveryMethod=function(){return this.gt||""},t.prototype.getContentUrl=function(){return this.It},t.prototype.getStreamType=function(){return this.Dt},t.prototype.setStreamInfo=function(t){this.ut=m.default.getStreamInfo(t)},t.prototype.getStreamInfo=function(){return this.ut},t.prototype.getAbrStrategy=function(){return this.et.getPlayerInfo().abrStrategy||"unknown"},t.prototype.getMediaEngineInfo=function(){return{name:this.et.getMediaEngineName(),version:this.et.getMediaEngineVersion()}},t.prototype.getPlayerInfo=function(){var t=this.et.getPlayerInfo().playerInfo;return null!=t&&"object"===(void 0===t?"undefined":(0,o.default)(t))&&"string"==typeof t.name&&"string"==typeof t.version?t:null},t.prototype.getLatency=function(){return this.et.getLatency()||0},t.prototype.getRouterUrl=function(){return this.Wt("/router/az","https")},t.prototype.getSubnetMatcherUrl=function(){return this.Wt("/subnetMatcher/siteId","https")},t.prototype.getDistributorUrl=function(){return this.Yt("distributor","https")},t.prototype.getTrackerUrl=function(){var t=this.Vt.backendPaths.trackerPath;return this.Yt(t,"https")},t.prototype.getSignalingUrl=function(){var t="wss",e=this.getPropertyParameters().customSignalingUrl;if(e&&e.length>0){var r=new u.default((0,h.addTrailingSlash)(e),{});return(r=this.Kt(r,t)).toString()}var n=this.Vt.backendPaths.signalingPath;return/^http:/i.test(this.xt)&&(t="ws"),this.Yt(n,t)},t.prototype.getAnalyticsUrl=function(){var t=this.Vt.backendPaths.klaraPath;return this.Yt(t,"https")},t.prototype.getBackendToken=function(){return this.qt},t.prototype.getPeerId=function(){return this.ft},t.prototype.getDnaConfig=function(){return this.dt},t.prototype.getClientUrlVersion=function(){var t=window["sr-module-manager"].config().remoteRepoPath;if(null!=t){var e=(0,h.extractVersionFromRepoPath)(t);if(null!=e)return e[1]}return"other"},t.prototype.injectConf=function(t,e){t.CONF_LABEL?this.Xt(this.conf,t,"",e):e&&e.notify("Missing CONF_LABEL","Injected conf has no CONF_LABEL parameter");var r=this.conf.QOS_REF_PERCENTAGE;r===parseFloat(r)&&100*Math.random()<r&&(this.conf.QOS_P2P_DISABLED=!0);var n=this.conf.QOS_COMPASS_REF_PERCENTAGE;n===parseFloat(n)&&100*Math.random()<n&&(this.conf.QOS_COMPASS_DISABLED=!0);var i=100*Math.random();this.isRampUpActivated()||this.isCompassRampUpActivated()?(this.conf.ANALYTICS.ENABLE_STATS_SENDER=i<=this.conf.ANALYTICS.STATS_SENDER_PERCENTAGE,this.conf.ANALYTICS.ENABLE_CONTROL_SENDER=i<=this.conf.ANALYTICS.CONTROL_SENDER_PERCENTAGE,this.isActivated()&&(this.conf.ANALYTICS.ENABLE_CONNECTIONS_SENDER=i<=this.conf.ANALYTICS.CONNECTIONS_SENDER_PERCENTAGE)):(this.conf.ANALYTICS.ENABLE_STATS_SENDER=i<=this.conf.ANALYTICS.RAMP_UP_STATS_SENDER_PERCENTAGE,this.conf.ANALYTICS.ENABLE_CONTROL_SENDER=i<=this.conf.ANALYTICS.RAMP_UP_CONTROL_SENDER_PERCENTAGE),this.ct=(0,f.getDnaClientUrl)(this.dt,this.conf),this.at=(0,f.getHostingOption)(this.dt,this.conf),this.ht=(0,f.getBaseRepoUrl)(this.dt,this.conf)},t.prototype.wt=function(t){var e=void 0;return-1!==(e=t.backendHost?t.backendHost:t.backendUrl?t.backendUrl:"backend.dna-delivery.com").indexOf("//")?new u.default(e).host:(0,h.removeTrailingSlash)(e)},t.prototype.bt=function(t){return!0===t.loadAfterPlaybackStarted?y.default.PLAYBACK_TRIGGER:null!==t.fragmentsFetchedBeforeLoad&&0!==t.fragmentsFetchedBeforeLoad?y.default.SEGMENT_TRIGGER:null!==t.secondsPrebufferedBeforeLoad?y.default.BUFFER_TRIGGER:y.default.IMMEDIATE_TRIGGER},t.prototype.Kt=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t.protocol=r?e:t.protocol||e,t.slashes=!0,t},t.prototype.Wt=function(t,e){var r=void 0,n=!1;return"/"===t.charAt(0)?r=new u.default(""+this.vt+t,{}):/^([a-z]*:)?\/\//i.test(this.xt)?(n=/^ws/i.test(e),r=new u.default(this.xt+"/"+t,{})):r=new u.default(""+this.vt+this.xt+"/"+t,{}),(r=this.Kt(r,e,n)).toString()},t.prototype.Yt=function(t,e){return this.Wt((0,h.addTrailingSlash)(t),e)},t.prototype.jt=function(t){if(this.dt.contentIdGenerator){var e=this.dt.contentIdGenerator(t);if("string"!=typeof e||""===e)throw new Error("DnaConfig.contentIdGenerator should return a non-empty string");return e}return this.kt(t)},t.prototype.kt=function(t){var e=new u.default(t);return e.host+e.pathname},t.prototype.Lt=function(t){if(this.dt.property){if("string"==typeof this.dt.property)return this.dt.property;var e=this.dt.property(t);if("string"!=typeof e||""===e)throw new Error("DnaConfig.property should return a non-empty string");return e}return null},t.prototype.Pt=function(t){if(this.dt.compassProperty){if("string"==typeof this.dt.compassProperty)return this.dt.compassProperty;var e=this.dt.compassProperty(t);if("string"!=typeof e||""===e)throw new Error("DnaConfig.property should return a non-empty string");return e}return null},t.prototype.Ht=function(){if(this.isContentActivated()&&this.Vt&&this.Vt.propertyParameters){var t=this.Vt.propertyParameters.activationRatio;return Math.random()<t}return!1},t.prototype.Gt=function(){if(this.isCompassPropertyActivated()&&this.Vt&&this.Vt.compass&&this.Vt.compass.propertyParameters){var t=this.Vt.compass.propertyParameters.activationRatio;return Math.random()<t}return!1},t.prototype.Xt=function(t,e,r,n){var s=this;(0,i.default)(e).forEach(function(i){var a=""===r?i:r+"."+i;void 0!==t[i]?"object"!==(0,o.default)(e[i])||Array.isArray(e[i])?t[i]=e[i]:s.Xt(t[i],e[i],a,n):n&&n.notify("Unknown parameter "+a,"Injected parameter "+a+" does not exist in default conf.")})},t}();e.default=E,t.exports=e.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={CONF_LABEL:"default",ANALYTICS:{TRAFFIC_INTERVAL_ARRAY:(0,r(24).steps)(5e3,12e4,1e4),STATS_INTERVAL:12e4,CONTROL_INTERVAL:6e5,CONNECTIONS_INTERVAL:3e5,STATS_SENDER_PERCENTAGE:100,CONTROL_SENDER_PERCENTAGE:100,CONNECTIONS_SENDER_PERCENTAGE:1,RAMP_UP_STATS_SENDER_PERCENTAGE:10,RAMP_UP_CONTROL_SENDER_PERCENTAGE:10,ENABLE_STATS_SENDER:!1,ENABLE_CONTROL_SENDER:!1,ENABLE_CONNECTIONS_SENDER:!1,REQUESTED_SEGMENTS_COUNT_TO_SEND_CONFIG:2},QOS_ANALYTICS:{ENDED_TRESHOLD:.3,BUFFERING_WITH_BUFFER_THRESHOLD:.3,TICK_INTERVAL:300,BUFFER_HEALTH_AVERAGE_UPDATE_INTERVAL:1e3,ENABLE_EVENT_LOOP_WATCHER:!0,EVENT_LOOP_DELAY_MIN:2500,EVENT_LOOP_DELAY_MAX:5e3,EVENT_LOOP_MEMORY:12e4,ENABLE_EVENT_LOOP_PROACTIVE_STATS:!1},ERRORS:{API_KEY:"8b7816ec573ca40bb9ec856f646f08c5",HANDLER:"xhr",STAGES:["staging","qa","production"]},ENABLE_PLAYBACK_ERROR_LOGGING:!1,ENABLE_MEDIAMAP_NOT_FOUND_LOGGING:!1,QOS_REF_PERCENTAGE:0,QOS_COMPASS_REF_PERCENTAGE:0,QOS_P2P_DISABLED:!1,QOS_COMPASS_DISABLED:!1,ROUTER_POLL_INTERVAL:9e5,REQUEST_RETRY:{ROUTER:{TIMEOUT:1e4,MIN_DELAY:3e4,MAX_DELAY:3e5,MIN_FACTOR:2,MAX_FACTOR:2.4},DISTRIBUTOR:{TIMEOUT:1e4,MIN_DELAY:5e3,MAX_DELAY:18e4,MIN_FACTOR:2,MAX_FACTOR:2.4},COMPASS:{TIMEOUT:1e4,MIN_DELAY:5e3,MAX_DELAY:18e4,MIN_FACTOR:2,MAX_FACTOR:2.4},SUBNET_MATCHER:{TIMEOUT:1e4,MIN_DELAY:5e3,MAX_DELAY:18e4,MIN_FACTOR:2,MAX_FACTOR:2.4},ANALYTICS:{TIMEOUT:3e3,RETRY:3,RETRY_DELAY:1e4}},CDN_ABORT_ERROR_TIME_THRESHOLD:1e3,COMPASS_ENABLE_MANIFEST_URL:!0,COMPASS_ENABLE_OTHER_URL:!1,HLS_IDENTIFIER_FORMAT:1,HLS_SSAI_VARIANT:null,DNA_CLIENT_URL:null,DNA_CLIENT_VERSION:null,ENABLE_GET_USER_MEDIA_REQUEST:!1,REQUIRED_DNA_INTERFACE_VERSION:1,ENABLE_SKIP_ZERO_DELAY:!1,ENABLE_SKIP_EVENT_LOOP_DELAY:!1};e.default=n,t.exports=e.default},function(t,e,r){"use strict";function n(t,e){return t.substring(t.length-e.length,t.length)===e}function i(t){return n(t,"/")?t:t+"/"}function o(t){return n(t,"/")?t.slice(0,-1):t}function s(t){return a.exec(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.endsWith=n,e.addTrailingSlash=i,e.removeTrailingSlash=o,e.extractVersionFromRepoPath=s;var a=/\/(([0-9]+(?:\.[0-9]+){0,2})(?:-[a-z0-9]+(?:\.[a-z0-9]+)?)?)$/i},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(209)),s=n(r(78)),a=function(){function t(){(0,i.default)(this,t);var e=window&&window.navigator?window.navigator.userAgent:"";this.Qt=(new o.default).setUA(e).getResult(),this.$t=this.Qt.browser}return t.prototype.getPlatform=function(){var t=this.Qt,e=t.ua,r=t.device,n=t.os;return e?-1!==e.indexOf("CrKey")?s.default.CHROMECAST:/electron\//i.test(e)?s.default.DESKTOP_ELECTRON:/web0s; linux\/smarttv/i.test(e)?s.default.LG_WEB:/smart-tv; linux; tizen/i.test(e)?s.default.TIZEN_WEB:"mobile"===r.type||"tablet"===r.type||"console"===r.type||"Android"===n.name||"iOS"===n.name?this.Jt()?s.default.ANDROID_WEBVIEW:s.default.WEB_MOBILE:s.default.WEB_DESKTOP:s.default.UNKNOWN},t.prototype.getJavaScriptEngine=function(){return this.$t},t.prototype.getOperatingSystem=function(){return this.Qt.os},t.prototype.getBrowserName=function(){return null!=this.$t?"Edge"===this.$t.name&&this.$t.major>=78?"ChromeEdge":this.$t.name:"Unknown"},t.prototype.getBrowserVersion=function(){return null!=this.$t?this.$t.version:"Unknown"},t.prototype.getOperatingSystemName=function(){return this.Qt.os.name},t.prototype.getOperatingSystemVersion=function(){return this.Qt.os.version||"Unknown"},t.prototype.Jt=function(){var t=this.Qt.ua;if(/Android.* Chrome\/[0-9.]+ /.test(t)){if(-1!==t.indexOf("wv"))return!0;if(/ Version\/[0-9]+\.[0.9]+ /.test(t))return!0}return!1},t}();e.default=a,t.exports=e.default},function(t,e,r){var n=r(12),i=r(30),o=r(6)("species");t.exports=function(t,e){var r,s=n(t).constructor;return void 0===s||null==(r=n(s)[o])?e:i(r)}},function(t,e,r){var n,i,o,s=r(13),a=r(218),u=r(89),c=r(58),l=r(5),f=l.process,d=l.setImmediate,h=l.clearImmediate,p=l.MessageChannel,v=l.Dispatch,g=0,y={},m=function(){var t=+this;if(y.hasOwnProperty(t)){var e=y[t];delete y[t],e()}},E=function(t){m.call(t.data)};d&&h||(d=function(t){for(var e=[],r=1;arguments.length>r;)e.push(arguments[r++]);return y[++g]=function(){a("function"==typeof t?t:Function(t),e)},n(g),g},h=function(t){delete y[t]},"process"==r(32)(f)?n=function(t){f.nextTick(s(m,t,1))}:v&&v.now?n=function(t){v.now(s(m,t,1))}:p?(o=(i=new p).port2,i.port1.onmessage=E,n=s(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(n=function(t){l.postMessage(t+"","*")},l.addEventListener("message",E,!1)):n="onreadystatechange"in c("script")?function(t){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),m.call(t)}}:function(t){setTimeout(s(m,t,1),0)}),t.exports={set:d,clear:h}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,r){var n=r(12),i=r(9),o=r(79);t.exports=function(t,e){if(n(t),i(e)&&e.constructor===t)return e;var r=o.f(t);return(0,r.resolve)(e),r.promise}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(4)),s=n(r(2)),a=(n(r(80)),function(){function t(e){var r=this;(0,i.default)(this,t),this.Zt=0,this.tn=0,this.nn=function(t){var e=t.requestStats;r.Zt+=e.bytesReceived,r.tn+=Math.max(e.endTimestamp-e.startTimestamp,0)},this.g=e,this.g.on(s.default.CDN_TIMING_EVENT,this.nn)}return t.prototype.dispose=function(){this.g.removeListener(s.default.CDN_TIMING_EVENT,this.nn)},(0,o.default)(t,[{key:"cdnDownloaded",get:function(){return this.Zt}},{key:"cdnDownloadedTime",get:function(){return this.tn}}]),t}());e.default=a,t.exports=e.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(11));e.default=(0,n.default)({WIFI_AND_ETHERNET:"wifiEthernet",CELLULAR_AND_OTHERS:"cellularOther",UNKNOWN:"unknown",NONE:"none"}),t.exports=e.default},function(t,e,r){"use strict";function n(t){if(!t)return 0;for(var e=t.buffered,r=t.currentTime,n=r,o=0;o<e.length;o++)e.start(o)<n+i&&e.end(o)>n&&(n=e.end(o));return n-r}Object.defineProperty(e,"__esModule",{value:!0});var i=.3;e.getBufferedAmount=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(11));e.default=(0,n.default)({STREAMROOTER:"web-sdk",PEERAGENT:"peer-agent",COMPASS:"compass"}),t.exports=e.default},function(t,e){t.exports="\t\n\v\f\r Â áá ââââââââââââ¯âã\u2028\u2029\ufeff"},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var i=!0,a=!1,c=void 0;try{for(var l,f=(0,u.default)(r);!(i=(l=f.next()).done);i=!0){var d=l.value;if(s(d))for(var h in d)"__proto__"!==h&&o(t,d[h],h)}}catch(t){a=!0,c=t}finally{try{!i&&f.return&&f.return()}finally{if(a)throw c}}return t}function o(t,e,r){var n=t[r];s(e)&&s(n)?i(n,e):t[r]=e}function s(t){return"function"==typeof t||"object"===(void 0===t?"undefined":(0,a.default)(t))&&null!==t&&!Array.isArray(t)}var a=n(r(22)),u=n(r(29));t.exports=i},function(t,e,r){"use strict";function n(t,e){Object.defineProperty(e,"dnaDownloadEnabled",{get:function(){return t.dnaDownloadAllowed},set:function(e){t.dnaDownloadAllowed=e}}),Object.defineProperty(e,"dnaUploadEnabled",{get:function(){return t.dnaUploadAllowed},set:function(e){t.dnaUploadAllowed=e}}),Object.defineProperty(e,"dnaDownloadAllowed",{get:function(){return t.dnaDownloadAllowed},set:function(e){t.dnaDownloadAllowed=e}}),Object.defineProperty(e,"dnaUploadAllowed",{get:function(){return t.dnaUploadAllowed},set:function(e){t.dnaUploadAllowed=e}}),Object.defineProperty(e,"dnaUploadOnWifiEthernetAllowed",{get:function(){return t.dnaUploadOnWifiEthernetAllowed},set:function(e){t.dnaUploadOnWifiEthernetAllowed=e}}),Object.defineProperty(e,"dnaDownloadOnWifiEthernetAllowed",{get:function(){return t.dnaDownloadOnWifiEthernetAllowed},set:function(e){t.dnaDownloadOnWifiEthernetAllowed=e}}),Object.defineProperty(e,"dnaUploadOnCellularAllowed",{get:function(){return t.dnaUploadOnCellularAllowed},set:function(e){t.dnaUploadOnCellularAllowed=e}}),Object.defineProperty(e,"dnaDownloadOnCellularAllowed",{get:function(){return t.dnaDownloadOnCellularAllowed},set:function(e){t.dnaDownloadOnCellularAllowed=e}}),Object.defineProperty(e,"transferStatus",{get:function(){return t.transferStatus}}),Object.defineProperty(e,"id",{get:function(){return t.id}}),Object.defineProperty(e,"stats",{get:function(){return t.stats}}),Object.defineProperty(e,"status",{get:function(){return t.status}}),Object.defineProperty(e,"versions",{get:function(){return t.versions}}),Object.defineProperty(e,"loaded",{get:function(){return t.loaded}})}function i(t,e){n(t,e),e.attachMediaElement=t.attachMediaElement.bind(t),e.detachMediaElement=t.detachMediaElement.bind(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.mapPublicAPI=n,e.mapIntegrationInterface=i},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){function r(){t.apply(this,e)}return r.prototype=t.prototype,new r}Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(0)),s=n(r(128)),a=r(126);r(282);var u=function t(){(0,o.default)(this,t);var e=i(s.default,arguments);this.load=e.load.bind(e),this.fetch=e.fetch.bind(e),this.stop=e.stop.bind(e),this.destroy=e.destroy.bind(e),this.attachMediaElement=e.attachMediaElement.bind(e),this.detachMediaElement=e.detachMediaElement.bind(e),this.mapIntegrationInterface=a.mapIntegrationInterface.bind(this,e),Object.defineProperty(this,"abr",{get:function(){return e.abr}}),(0,a.mapPublicAPI)(e,this)};u.StreamTypes=s.default.StreamTypes,u.ContentTypes=s.default.ContentTypes,u.ResponseTypes=s.default.ResponseTypes,u.Events=s.default.Events,u.Errors=s.default.Errors,e.default=u,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(25)),o=n(r(84)),s=n(r(16)),a=n(r(0)),u=n(r(4)),c=n(r(85)),l=n(r(2)),f=n(r(50)),d=n(r(76)),h=n(r(101)),p=n(r(77)),v=n(r(179)),g=n(r(180)),y=n(r(200)),m=r(201),E=n(r(111)),_=n(r(102)),b=n(r(247)),T=n(r(254)),S=n(r(260)),w=n(r(261)),A=n(r(262)),R=r(272),D=r(277),O=r(279),L=n(r(280)),C=n(r(123)),I=n(r(54)),P=n(r(41));(0,O.setupNamespace)();var M=function(){function t(e,r,n,i){var o=this;if((0,a.default)(this,t),this.in=null,this.en=null,this.rn=null,this.sn=null,this.un=null,this.cn=null,this.ot=null,this.hn=null,this.an=!1,this.ln=!1,this.dn=0,this.vn=!0,this.wn=!0,this.pn=null,this.bn=null,this.mn=null,this.En=null,this.yn=null,this.gn=function(t){o.an||o.load(t.contentUrl,t.streamType)},this.Tn=function(){o.cn&&o.cn.setBackendUrlsAndConnect(o.j.configManager.getBackendUrls())},this.On=function(){var t=!1;o.j.configManager.isActivated()?(o.un?o.Mn():o.rn&&o.rn.arm(),t=!0):(o.ln=!0,o.Sn.clear()),o.j.configManager.isCompassActivated()&&(o.j.configManager.setCompassVersion(c.default.version),o.j.eventBus.emit(l.default.COMPASS_LOADED),t=!0),t||o.An()},this.Rn=function(){o.Nn(),o.un||o.sn?o.j.errorFunnel.notifyError(new Error("Trying to load dna-client while either dnaClient or asyncLoader are already present")):(o.sn=new T.default(o.j),o.sn.load())},this.Cn=function(t){o.un=t,o.j.configManager.setPeerAgentVersion(o.un.peerAgentVersion),o.Mn()},this.Dn=function(t){if(!o.ln){if(o.ot){if(P.default.getManifestUrl(o.ot)!==P.default.getManifestUrl(t))return o.j.errorFunnel.notify("Unexpected Media Map change","New Media Map created while Streamrooter was still running with a previous one, possibly new content downloaded without calling load first."),void o.stop();o.j.errorFunnel.notify("Possible media engine error recovery","Media Map with same manifest URL created while Streamrooter was still running with a previous one"),o.In(),o.ot=null}o.ot=t,o.j.configManager.setStreamInfo(t),o.j.eventBus.emit(l.default.MEDIA_MAP_PROCESSED)}},this.jn=function(t){if(t[C.default.PEERAGENT]){var e=t[C.default.PEERAGENT];o.kn(e.config,e.isClustered)}t[C.default.COMPASS]&&o.Ln(t[C.default.COMPASS].config)},this.Pn=function(t){if(t){var e=o.j,r=e.configManager,n=e.errorFunnel,i=e.mediaEngineStats;if("string"==typeof t){if(o.ot){var a=o.ot.getTrackByIdentifier(t);a?(i.tracksFound++,o.et.emit(p.default.TRACK_CHANGE_EVENT,a)):(i.tracksNotFound++,r.conf.ENABLE_MEDIAMAP_NOT_FOUND_LOGGING&&n.notify("TrackView not found in Media Map","Unable to find TrackView with identifier="+(0,s.default)(t)))}}else n.notify("Non-string trackIdentifier detected.","trackIdentifier="+(0,s.default)(t))}},this.Un=function(){o.cn&&(o.cn.networkType=o.j.currentNetworkType)},this.Fn=function(){o.cn&&(o.cn.dnaDownloadAllowed=o.vn,o.cn.dnaUploadAllowed=o.wn,null!==o.pn&&(o.cn.dnaDownloadOnWifiEthernetAllowed=o.pn),null!==o.bn&&(o.cn.dnaUploadOnWifiEthernetAllowed=o.bn),null!==o.mn&&(o.cn.dnaDownloadOnCellularAllowed=o.mn),null!==o.En&&(o.cn.dnaUploadOnCellularAllowed=o.En))},this.lt=e,this.et=r,i&&"string"!=typeof i)throw new TypeError("wrapperVersion should be a string");this.j=new E.default(e,r,n,i),this.Sn=new g.default(this.j),this.Bn=new S.default,this.j.eventBus.on(l.default.DISTRIBUTOR_ANSWER_HANDLED,this.On),this.j.eventBus.on(l.default.MODULE_CONF_INJECTED,this.jn),this.j.eventBus.on(l.default.DNA_CLIENT_LOAD_CONDITION_REACHED,this.Rn),this.j.eventBus.on(l.default.DNA_CLIENT_LOADED,this.Cn),this.j.eventBus.on(l.default.MEDIA_MAP_CREATED,this.Dn),this.j.eventBus.on(l.default.BACKEND_URLS_CHANGED,this.Tn),this.j.eventBus.on(l.default.NETWORK_TYPE_CHANGED,this.Un),this.j.eventBus.on(l.default.STREAM_IDENTIFIED,this.gn),this.et.on(p.default.TRACK_SWITCH,this.Pn),this.xn=(0,D.abrInterfaceGenerator)(this),this.rn=(0,R.createTrigger)(this.j.eventBus,this.j.dnaConfig),(0,O.addToStreamrootInstances)(this)}return t.prototype.load=function(t,e){if(!this.an){this.an=!0,this.ln=!1,this.It=t,this.Dt=e,this.dn=0,this.j.configManager.setContentUrl(t),this.j.configManager.setStreamType(e);var r=this.j.configManager.getContentId();this.j.errorFunnel.setMetadata({stream:r}),this.en=new b.default(this.j),this.en.call()}},t.prototype.fetch=function(t,e){(0,m.assertContentAndResponseType)(t);var r=this.j.configManager,n=I.default.deepCopy(t);if(n.originalURL=t.url,this.an){var i=null;switch(n.contentType){case d.default.MEDIA_SEGMENT:if(this.j.eventBus.emit(l.default.MEDIA_SEGMENT_REQUESTED),this.ot){var o=this.ot,s=void 0;n.headers&&(s=n.headers.Range||n.headers.range||void 0),(i=o.getSegmentByUrl(n.originalURL,s)).track&&i.segment&&this.j.eventBus.emit(l.default.MEDIA_SEGMENT_CONSUMED,i)}this.yn&&(n=this.yn.getUpdatedRequest(n));break;case d.default.INIT_SEGMENT:this.yn&&(n=this.yn.getUpdatedRequest(n));break;case d.default.MANIFEST:this.yn&&r.conf.COMPASS_ENABLE_MANIFEST_URL&&(n=this.yn.getUpdatedRequest(n));break;default:this.yn&&r.conf.COMPASS_ENABLE_OTHER_URL&&(n=this.yn.getUpdatedRequest(n))}if(!this.ln){if(n.contentType===d.default.MANIFEST)return this.Sn.fetchManifest(n,e);if(n.contentType===d.default.MEDIA_SEGMENT){var a=this.cn;if(a){if(i&&i.track&&i.segment){var u=new y.default(n,e,this.j);return this.j.mediaEngineStats.segmentsFound++,a.getSegment(n,u,i)}this.j.mediaEngineStats.segmentsNotFound++,r.conf.ENABLE_MEDIAMAP_NOT_FOUND_LOGGING&&this.j.errorFunnel.notify("Falling back to CDN download","Segment view not found in Media Map")}}}return new _.default(this.j,n).fetch(e)}return n.contentType===d.default.MANIFEST?this.Sn.fetchManifest(n,e):(this.j.errorFunnel.notify("Unexpected call to fetch","fetch() was called before load()"),new _.default(this.j,t).fetch(e))},t.prototype.attachMediaElement=function(t){t!==this.hn&&(this.hn=t,this.cn&&(this.cn.mediaElement=t),this.j.eventBus.emit(l.default.MEDIA_ELEMENT_ATTACHED,t))},t.prototype.detachMediaElement=function(){null!==this.hn&&(this.hn=null,this.cn&&(this.cn.mediaElement=null),this.j.eventBus.emit(l.default.MEDIA_ELEMENT_DETACHED))},t.prototype.Nn=function(){this.rn&&(this.rn.dispose(),this.rn=null)},t.prototype.Vn=function(){this.sn&&(this.sn.dispose(),this.sn=null),this.un=null},t.prototype.In=function(){var t=this.cn;t?(this.Bn.incrementHistorical(t.stats),this.in&&this.in.detachProvider(t),t.dispose(),null!=t.delete&&t.delete(),this.cn=null):this.Bn.incrementHistorical(new w.default(this.j.transferStats))},t.prototype.Hn=function(){this.yn&&(this.in&&this.in.detachProvider(this.yn),this.yn.dispose(),this.yn=null)},t.prototype.stop=function(){this.an=!1,this.ot=null,this.Sn.clear(),this.j.clear(),this.In(),this.Hn(),this.en&&(this.en.dispose(),this.en=null),this.in&&(this.in.dispose(),this.in=null),this.j.eventBus.emit(l.default.STOPPED)},t.prototype.destroy=function(){(0,O.removeFromStreamrootInstances)(this),this.an&&this.stop(),this.Nn(),this.Vn(),this.j.eventBus.removeListener(l.default.DISTRIBUTOR_ANSWER_HANDLED,this.On),this.j.eventBus.removeListener(l.default.MODULE_CONF_INJECTED,this.jn),this.j.eventBus.removeListener(l.default.DNA_CLIENT_LOAD_CONDITION_REACHED,this.Rn),this.j.eventBus.removeListener(l.default.DNA_CLIENT_LOADED,this.Cn),this.j.eventBus.removeListener(l.default.MEDIA_MAP_CREATED,this.Dn),this.j.eventBus.removeListener(l.default.BACKEND_URLS_CHANGED,this.Tn),this.j.eventBus.removeListener(l.default.NETWORK_TYPE_CHANGED,this.Un),this.et.removeListener(p.default.TRACK_SWITCH,this.Pn),this.j.dispose()},t.prototype.An=function(){this.in||(this.in=new A.default(this.j),this.in.sendSupportPayload()),this.en&&(this.en.dispose(),this.en=null)},t.prototype.Mn=function(){var t,e=this,r=(t={},(0,o.default)(t,f.default.HLS,"hls"),(0,o.default)(t,f.default.DASH,"dash"),(0,o.default)(t,f.default.SMOOTH,"smooth"),t)[this.Dt];null!=r&&this.j.moduleManager.require(r+"-parser-adapter").then(function(t){var r=new t(e.j.configManager.getParserOptions());e.j.parserAdapter=r,e.Sn.setParserAdapter(r,e.Dt),e.j.configManager.setIntegrationVersion(r.integrationVersion)}).catch(function(t){e.j.errorFunnel.notifyError(t)})},t.prototype.kn=function(t,e){var r=this.ot,n=this.un,i=this.j.parserAdapter;if(r)if(n)if(i){var o={streamrootKey:this.lt,streamType:this.Dt,contentId:this.j.configManager.getContentId(),siteId:this.j.configManager.getSiteId(),analyticsToken:this.j.configManager.getPeerId(),peerId:this.j.configManager.getPeerId(),backendToken:this.j.configManager.getBackendToken(),backendUrls:this.j.configManager.getBackendUrls(),propertyParameters:this.j.configManager.getPropertyParameters(),versions:this.j.configManager.getVersions(),injectedConf:{isClustered:e,config:t},interfaces:{playerInterface:this.et,mediaMap:r,environment:this.j.environment,errorFunnel:this.j.errorFunnel,qosAnalytics:this.j.qosAnalyticsHandler,externalEventBus:this.j.eventBus,httpRequestFactory:this.j.httpRequestFactory},networkType:this.j.currentNetworkType};this.cn&&this.In(),this.cn=n.createPeerAgent(o),this.hn&&(this.cn.mediaElement=this.hn),this.Gn(this.cn),this.Fn(),this.j.peerAgentCounter++}else this.j.errorFunnel.notifyError(new Error("ParserAdapter must be created before PeerAgent"));else this.j.errorFunnel.notifyError(new Error("DNA Client must be loaded before PeerAgent is created"));else this.j.errorFunnel.notifyError(new Error("MediaMap must be created before PeerAgent"))},t.prototype.Ln=function(t){this.yn&&this.Hn(),this.yn=new L.default(this.j,t),this.Gn(this.yn)},t.prototype.Gn=function(t){this.in||(this.in=new A.default(this.j)),this.in.attachProvider(t)},(0,u.default)(t,[{key:"peerAgent",get:function(){return this.cn}},{key:"abr",get:function(){return new this.xn}},{key:"dnaDownloadAllowed",get:function(){return this.vn},set:function(t){this.vn=t,this.Fn()}},{key:"dnaUploadAllowed",get:function(){return this.wn},set:function(t){this.wn=t,this.Fn()}},{key:"dnaDownloadOnWifiEthernetAllowed",get:function(){return null!==this.pn?this.pn:this.j.hasDistributorResponded?!!this.j.configManager.getPropertyParameters().wifiEthernetDownload:null},set:function(t){this.pn=t,this.Fn()}},{key:"dnaUploadOnWifiEthernetAllowed",get:function(){return null!==this.bn?this.bn:this.j.hasDistributorResponded?!!this.j.configManager.getPropertyParameters().wifiEthernetUpload:null},set:function(t){this.bn=t,this.Fn()}},{key:"dnaDownloadOnCellularAllowed",get:function(){return null!==this.mn?this.mn:this.j.hasDistributorResponded?!!this.j.configManager.getPropertyParameters().cellularOtherDownload:null},set:function(t){this.mn=t,this.Fn()}},{key:"dnaUploadOnCellularAllowed",get:function(){return null!==this.En?this.En:this.j.hasDistributorResponded?!!this.j.configManager.getPropertyParameters().cellularOtherUpload:null},set:function(t){this.En=t,this.Fn()}},{key:"transferStatus",get:function(){return this.cn?this.cn.transferStatus:{effectiveDownloadAllowed:!1,effectiveUploadAllowed:!1}}},{key:"id",get:function(){return this.j.configManager.getPeerId()}},{key:"stats",get:function(){var t=this.cn?this.cn.stats:new w.default(this.j.transferStats),e=this.Bn.get(t),r=this.yn?{compass:this.yn.stats}:{};return(0,i.default)({},e,r)}},{key:"status",get:function(){return{confLabel:(this.cn?this.cn.stats:new w.default(this.j.transferStats)).confLabel}}},{key:"versions",get:function(){return{streamrooter:"1.23.0",peerAgent:this.cn?this.cn.version:null,wrapper:this.j.configManager.getVersions().wrapperVersion}}},{key:"loaded",get:function(){return this.an}}]),t}();M.StreamTypes=f.default,M.ContentTypes=d.default,M.ResponseTypes=h.default,M.Events=p.default,M.Errors=v.default,e.default=M,t.exports=e.default},function(t,e,r){r(130),t.exports=r(1).Object.assign},function(t,e,r){var n=r(3);n(n.S+n.F,"Object",{assign:r(131)})},function(t,e,r){"use strict";var n=r(8),i=r(26),o=r(65),s=r(34),a=r(20),u=r(60),c=Object.assign;t.exports=!c||r(15)(function(){var t={},e={},r=Symbol(),n="abcdefghijklmnopqrst";return t[r]=7,n.split("").forEach(function(t){e[t]=t}),7!=c({},t)[r]||Object.keys(c({},e)).join("")!=n})?function(t,e){for(var r=a(t),c=arguments.length,l=1,f=o.f,d=s.f;c>l;)for(var h,p=u(arguments[l++]),v=f?i(p).concat(f(p)):i(p),g=v.length,y=0;g>y;)h=v[y++],n&&!d.call(p,h)||(r[h]=p[h]);return r}:c},function(t,e,r){var n=r(19),i=r(44),o=r(133);t.exports=function(t){return function(e,r,s){var a,u=n(e),c=i(u.length),l=o(s,c);if(t&&r!=r){for(;c>l;)if((a=u[l++])!=a)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===r)return t||l||0;return!t&&-1}}},function(t,e,r){var n=r(61),i=Math.max,o=Math.min;t.exports=function(t,e){return(t=n(t))<0?i(t+e,0):o(t,e)}},function(t,e,r){r(135);var n=r(1).Object;t.exports=function(t,e,r){return n.defineProperty(t,e,r)}},function(t,e,r){var n=r(3);n(n.S+n.F*!r(8),"Object",{defineProperty:r(10).f})},function(t,e,r){var n=r(1),i=n.JSON||(n.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}},function(t,e,r){t.exports={default:r(138),__esModule:!0}},function(t,e,r){r(139),t.exports=r(1).Object.getPrototypeOf},function(t,e,r){var n=r(20),i=r(86);r(68)("getPrototypeOf",function(){return function(t){return i(n(t))}})},function(t,e,r){r(141);var n=r(1).Object;t.exports=function(t,e){return n.create(t,e)}},function(t,e,r){var n=r(3);n(n.S,"Object",{create:r(46)})},function(t,e,r){t.exports={default:r(143),__esModule:!0}},function(t,e,r){r(144);var n=r(1).Object;t.exports=function(t,e){return n.defineProperties(t,e)}},function(t,e,r){var n=r(3);n(n.S+n.F*!r(8),"Object",{defineProperties:r(88)})},function(t,e,r){r(146),t.exports=r(1).Object.keys},function(t,e,r){var n=r(20),i=r(26);r(68)("keys",function(){return function(t){return i(n(t))}})},function(t,e,r){r(27),r(150),t.exports=r(1).Array.from},function(t,e,r){var n=r(61),i=r(43);t.exports=function(t){return function(e,r){var o,s,a=String(i(e)),u=n(r),c=a.length;return u<0||u>=c?t?"":void 0:(o=a.charCodeAt(u))<55296||o>56319||u+1===c||(s=a.charCodeAt(u+1))<56320||s>57343?t?a.charAt(u):o:t?a.slice(u,u+2):s-56320+(o-55296<<10)+65536}}},function(t,e,r){"use strict";var n=r(46),i=r(31),o=r(35),s={};r(14)(s,r(6)("iterator"),function(){return this}),t.exports=function(t,e,r){t.prototype=n(s,{next:i(1,r)}),o(t,e+" Iterator")}},function(t,e,r){"use strict";var n=r(13),i=r(3),o=r(20),s=r(92),a=r(93),u=r(44),c=r(151),l=r(70);i(i.S+i.F*!r(94)(function(t){Array.from(t)}),"Array",{from:function(t){var e,r,i,f,d=o(t),h="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,g=void 0!==v,y=0,m=l(d);if(g&&(v=n(v,p>2?arguments[2]:void 0,2)),null==m||h==Array&&a(m))for(r=new h(e=u(d.length));e>y;y++)c(r,y,g?v(d[y],y):d[y]);else for(f=m.call(d),r=new h;!(i=f.next()).done;y++)c(r,y,g?s(f,v,[i.value,y],!0):i.value);return r.length=y,r}})},function(t,e,r){"use strict";var n=r(10),i=r(31);t.exports=function(t,e,r){e in t?n.f(t,e,i(0,r)):t[e]=r}},function(t,e,r){r(71),r(27),r(36),r(155),r(161),r(164),r(166),t.exports=r(1).Map},function(t,e,r){"use strict";var n=r(154),i=r(95),o=r(28),s=r(19);t.exports=r(69)(Array,"Array",function(t,e){this._t=s(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?r:"values"==e?t[r]:[r,t[r]])},"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},function(t,e){t.exports=function(){}},function(t,e,r){"use strict";var n=r(156),i=r(97),o="Map";t.exports=r(157)(o,function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=n.getEntry(i(this,o),t);return e&&e.v},set:function(t,e){return n.def(i(this,o),0===t?0:t,e)}},n,!0)},function(t,e,r){"use strict";var n=r(10).f,i=r(46),o=r(72),s=r(13),a=r(73),u=r(37),c=r(69),l=r(95),f=r(96),d=r(8),h=r(49).fastKey,p=r(97),v=d?"_s":"size",g=function(t,e){var r,n=h(e);if("F"!==n)return t._i[n];for(r=t._f;r;r=r.n)if(r.k==e)return r};t.exports={getConstructor:function(t,e,r,c){var l=t(function(t,n){a(t,l,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[v]=0,null!=n&&u(n,r,t[c],t)});return o(l.prototype,{clear:function(){for(var t=p(this,e),r=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var r=p(this,e),n=g(r,t);if(n){var i=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==n&&(r._f=i),r._l==n&&(r._l=o),r[v]--}return!!n},forEach:function(t){p(this,e);for(var r,n=s(t,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(t){return!!g(p(this,e),t)}}),d&&n(l.prototype,"size",{get:function(){return p(this,e)[v]}}),l},def:function(t,e,r){var n,i,o=g(t,e);return o?o.v=r:(t._l=o={i:i=h(e,!0),k:e,v:r,p:n=t._l,n:void 0,r:!1},t._f||(t._f=o),n&&(n.n=o),t[v]++,"F"!==i&&(t._i[i]=o)),t},getEntry:g,setStrong:function(t,e,r){c(t,e,function(t,r){this._t=p(t,e),this._k=r,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?l(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,l(1))},r?"entries":"values",!r,!0),f(e)}}},function(t,e,r){"use strict";var n=r(5),i=r(3),o=r(49),s=r(15),a=r(14),u=r(72),c=r(37),l=r(73),f=r(9),d=r(35),h=r(10).f,p=r(158)(0),v=r(8);t.exports=function(t,e,r,g,y,m){var E=n[t],_=E,b=y?"set":"add",T=_&&_.prototype,S={};return v&&"function"==typeof _&&(m||T.forEach&&!s(function(){(new _).entries().next()}))?(_=e(function(e,r){l(e,_,t,"_c"),e._c=new E,null!=r&&c(r,y,e[b],e)}),p("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(t){var e="add"==t||"set"==t;t in T&&(!m||"clear"!=t)&&a(_.prototype,t,function(r,n){if(l(this,_,t),!e&&m&&!f(r))return"get"==t&&void 0;var i=this._c[t](0===r?0:r,n);return e?this:i})}),m||h(_.prototype,"size",{get:function(){return this._c.size}})):(_=g.getConstructor(e,t,y,b),u(_.prototype,r),o.NEED=!0),d(_,t),S[t]=_,i(i.G+i.W+i.F,S),m||g.setStrong(_,t,y),_}},function(t,e,r){var n=r(13),i=r(60),o=r(20),s=r(44),a=r(159);t.exports=function(t,e){var r=1==t,u=2==t,c=3==t,l=4==t,f=6==t,d=5==t||f,h=e||a;return function(e,a,p){for(var v,g,y=o(e),m=i(y),E=n(a,p,3),_=s(m.length),b=0,T=r?h(e,_):u?h(e,0):void 0;_>b;b++)if((d||b in m)&&(g=E(v=m[b],b,y),t))if(r)T[b]=g;else if(g)switch(t){case 3:return!0;case 5:return v;case 6:return b;case 2:T.push(v)}else if(l)return!1;return f?-1:c||l?l:T}}},function(t,e,r){var n=r(160);t.exports=function(t,e){return new(n(t))(e)}},function(t,e,r){var n=r(9),i=r(98),o=r(6)("species");t.exports=function(t){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)||(e=void 0),n(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},function(t,e,r){var n=r(3);n(n.P+n.R,"Map",{toJSON:r(162)("Map")})},function(t,e,r){var n=r(47),i=r(163);t.exports=function(t){return function(){if(n(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,e,r){var n=r(37);t.exports=function(t,e){var r=[];return n(t,!1,r.push,r,e),r}},function(t,e,r){r(165)("Map")},function(t,e,r){"use strict";var n=r(3);t.exports=function(t){n(n.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},function(t,e,r){r(167)("Map")},function(t,e,r){"use strict";var n=r(3),i=r(30),o=r(13),s=r(37);t.exports=function(t){n(n.S,t,{from:function(t){var e,r,n,a,u=arguments[1];return i(this),(e=void 0!==u)&&i(u),null==t?new this:(r=[],e?(n=0,a=o(u,arguments[2],2),s(t,!1,function(t){r.push(a(t,n++))})):s(t,!1,r.push,r),new this(r))}})}},function(t,e,r){t.exports={default:r(169),__esModule:!0}},function(t,e,r){r(27),r(36),t.exports=r(74).f("iterator")},function(t,e,r){t.exports={default:r(171),__esModule:!0}},function(t,e,r){r(172),r(71),r(175),r(176),t.exports=r(1).Symbol},function(t,e,r){"use strict";var n=r(5),i=r(18),o=r(8),s=r(3),a=r(91),u=r(49).KEY,c=r(15),l=r(63),f=r(35),d=r(45),h=r(6),p=r(74),v=r(75),g=r(173),y=r(98),m=r(12),E=r(9),_=r(20),b=r(19),T=r(59),S=r(31),w=r(46),A=r(174),R=r(100),D=r(65),O=r(10),L=r(26),C=R.f,I=O.f,P=A.f,M=n.Symbol,N=n.JSON,k=N&&N.stringify,x=h("_hidden"),F=h("toPrimitive"),U={}.propertyIsEnumerable,B=l("symbol-registry"),j=l("symbols"),G=l("op-symbols"),H=Object.prototype,V="function"==typeof M&&!!D.f,q=n.QObject,W=!q||!q.prototype||!q.prototype.findChild,Y=o&&c(function(){return 7!=w(I({},"a",{get:function(){return I(this,"a",{value:7}).a}})).a})?function(t,e,r){var n=C(H,e);n&&delete H[e],I(t,e,r),n&&t!==H&&I(H,e,n)}:I,K=function(t){var e=j[t]=w(M.prototype);return e._k=t,e},z=V&&"symbol"==typeof M.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof M},X=function(t,e,r){return t===H&&X(G,e,r),m(t),e=T(e,!0),m(r),i(j,e)?(r.enumerable?(i(t,x)&&t[x][e]&&(t[x][e]=!1),r=w(r,{enumerable:S(0,!1)})):(i(t,x)||I(t,x,S(1,{})),t[x][e]=!0),Y(t,e,r)):I(t,e,r)},Q=function(t,e){m(t);for(var r,n=g(e=b(e)),i=0,o=n.length;o>i;)X(t,r=n[i++],e[r]);return t},$=function(t,e){return void 0===e?w(t):Q(w(t),e)},Z=function(t){var e=U.call(this,t=T(t,!0));return!(this===H&&i(j,t)&&!i(G,t))&&(!(e||!i(this,t)||!i(j,t)||i(this,x)&&this[x][t])||e)},J=function(t,e){if(t=b(t),e=T(e,!0),t!==H||!i(j,e)||i(G,e)){var r=C(t,e);return!r||!i(j,e)||i(t,x)&&t[x][e]||(r.enumerable=!0),r}},tt=function(t){for(var e,r=P(b(t)),n=[],o=0;r.length>o;)i(j,e=r[o++])||e==x||e==u||n.push(e);return n},et=function(t){for(var e,r=t===H,n=P(r?G:b(t)),o=[],s=0;n.length>s;)!i(j,e=n[s++])||r&&!i(H,e)||o.push(j[e]);return o};V||(a((M=function(){if(this instanceof M)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(r){this===H&&e.call(G,r),i(this,x)&&i(this[x],t)&&(this[x][t]=!1),Y(this,t,S(1,r))};return o&&W&&Y(H,t,{configurable:!0,set:e}),K(t)}).prototype,"toString",function(){return this._k}),R.f=J,O.f=X,r(99).f=A.f=tt,r(34).f=Z,D.f=et,o&&!r(33)&&a(H,"propertyIsEnumerable",Z,!0),p.f=function(t){return K(h(t))}),s(s.G+s.W+s.F*!V,{Symbol:M});for(var rt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;rt.length>nt;)h(rt[nt++]);for(var it=L(h.store),ot=0;it.length>ot;)v(it[ot++]);s(s.S+s.F*!V,"Symbol",{for:function(t){return i(B,t+="")?B[t]:B[t]=M(t)},keyFor:function(t){if(!z(t))throw TypeError(t+" is not a symbol!");for(var e in B)if(B[e]===t)return e},useSetter:function(){W=!0},useSimple:function(){W=!1}}),s(s.S+s.F*!V,"Object",{create:$,defineProperty:X,defineProperties:Q,getOwnPropertyDescriptor:J,getOwnPropertyNames:tt,getOwnPropertySymbols:et});var st=c(function(){D.f(1)});s(s.S+s.F*st,"Object",{getOwnPropertySymbols:function(t){return D.f(_(t))}}),N&&s(s.S+s.F*(!V||c(function(){var t=M();return"[null]"!=k([t])||"{}"!=k({a:t})||"{}"!=k(Object(t))})),"JSON",{stringify:function(t){for(var e,r,n=[t],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=e=n[1],(E(e)||void 0!==t)&&!z(t))return y(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!z(e))return e}),n[1]=e,k.apply(N,n)}}),M.prototype[F]||r(14)(M.prototype,F,M.prototype.valueOf),f(M,"Symbol"),f(Math,"Math",!0),f(n.JSON,"JSON",!0)},function(t,e,r){var n=r(26),i=r(65),o=r(34);t.exports=function(t){var e=n(t),r=i.f;if(r)for(var s,a=r(t),u=o.f,c=0;a.length>c;)u.call(t,s=a[c++])&&e.push(s);return e}},function(t,e,r){var n=r(19),i=r(99).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(t){try{return i(t)}catch(t){return s.slice()}};t.exports.f=function(t){return s&&"[object Window]"==o.call(t)?a(t):i(n(t))}},function(t,e,r){r(75)("asyncIterator")},function(t,e,r){r(75)("observable")},function(t,e,r){r(178),t.exports=r(1).Object.freeze},function(t,e,r){var n=r(9),i=r(49).onFreeze;r(68)("freeze",function(t){return function(e){return t&&n(e)?t(i(e)):e}})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(11));e.default=(0,n.default)({ERR_INVALID_STREAM:"errorInvalidStream",ERR_INVALID_STREAMROOT_KEY:"errorInvalidStreamrootKey",ERR_NOT_SUPPORTED_STREAM:"errorNotSupportedStream"}),t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(51)),s=n(r(2)),a=n(r(50)),u=n(r(102)),c=(r(183),r(7)),l=n(r(192)),f=n(r(41)),d=function(){function t(e){(0,i.default)(this,t),this.qn=!1,this.j=e,this.zn=null,this.Wn=null,this.Yn=[],this.ot=null}return t.prototype.setParserAdapter=function(t,e){if(this.zn)throw Error("Attempted to set the parser adapter twice");t.onMediaMapCreated=this.Dn.bind(this),this.zn=t,this.Dt=e,this.Kn()},t.prototype.clear=function(){this.Wn&&(this.Wn.clear(),this.Wn=null),this.zn=null,this.Yn=[],this.ot=null},t.prototype.fetchManifest=function(t,e){var r=this,n={onSuccess:function(t,n,i){var s=t.responseURL;s!==t.originalURL&&s===t.url&&(s=t.originalURL);var u=new o.default(s,window.location.href).href;r.j.manifestDetector.processManifest(n,u);var f=r.zn;f&&0===r.Yn.length?((0,c.createTimeout)(function(){e.onSuccess(t,n,i)},0),f.updateManifest(n,u)):(r.Xn({manifest:n,url:u}),e.onSuccess(t,n,i));var d=r.j.configManager.getStreamType()===a.default.DASH,h=!r.qn&&!r.j.segmentBaseAdapter;d&&h&&(/<SegmentBase/.test(n)&&(r.j.segmentBaseAdapter=new l.default(r.j)),r.qn=!0)},onError:e.onError||void 0,onProgress:e.onProgress||void 0};return new u.default(this.j,t).fetch(n)},t.prototype.Xn=function(t){this.Dt===a.default.DASH?this.Yn=[t]:this.Dt===a.default.HLS&&this.Yn.length>0?this.Yn.splice(1,0,t):this.Yn.push(t)},t.prototype.Kn=function(){var t=this;this.Yn.length>0&&(this.Wn=(0,c.createTimeout)(function(){if(t.Wn=null,t.Dt===a.default.HLS&&f.default.getIsLive(t.ot))t.Yn=[];else{var e=t.zn;if(e&&t.Yn.length>0){var r=t.Yn.shift(),n=r.manifest,i=r.url;e.updateManifest(n,i),t.Kn()}}},0))},t.prototype.Dn=function(t){this.ot=t,this.j.eventBus.emit(s.default.MEDIA_MAP_CREATED,t)},t}();e.default=d,t.exports=e.default},function(t,e,r){"use strict";t.exports=function(t,e){if(e=e.split(":")[0],!(t=+t))return!1;switch(e){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t}},function(t,e,r){"use strict";function n(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}function i(t){try{return encodeURIComponent(t)}catch(t){return null}}function o(t){for(var e,r=/([^=?#&]+)=?([^&]*)/g,i={};e=r.exec(t);){var o=n(e[1]),s=n(e[2]);null===o||null===s||o in i||(i[o]=s)}return i}function s(t,e){e=e||"";var r,n,o=[];for(n in"string"!=typeof e&&(e="?"),t)if(u.call(t,n)){if((r=t[n])||null!==r&&r!==a&&!isNaN(r)||(r=""),n=i(n),r=i(r),null===n||null===r)continue;o.push(n+"="+r)}return o.length?e+o.join("&"):""}var a,u=Object.prototype.hasOwnProperty;e.stringify=s,e.parse=o},function(t,e,r){},function(t,e,r){function n(t,e,r){var n=e&&r||0,i=e||[],s=void 0!==(t=t||{}).clockseq?t.clockseq:u,f=void 0!==t.msecs?t.msecs:(new Date).getTime(),d=void 0!==t.nsecs?t.nsecs:l+1,h=f-c+(d-l)/1e4;if(h<0&&void 0===t.clockseq&&(s=s+1&16383),(h<0||f>c)&&void 0===t.nsecs&&(d=0),d>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=f,l=d,u=s;var p=(1e4*(268435455&(f+=122192928e5))+d)%4294967296;i[n++]=p>>>24&255,i[n++]=p>>>16&255,i[n++]=p>>>8&255,i[n++]=255&p;var v=f/4294967296*1e4&268435455;i[n++]=v>>>8&255,i[n++]=255&v,i[n++]=v>>>24&15|16,i[n++]=v>>>16&255,i[n++]=s>>>8|128,i[n++]=255&s;for(var g=t.node||a,y=0;y<6;++y)i[n+y]=g[y];return e||o(i)}var i=r(108),o=r(109),s=i(),a=[1|s[0],s[1],s[2],s[3],s[4],s[5]],u=16383&(s[6]<<8|s[7]),c=0,l=0;t.exports=n},function(t,e,r){function n(t,e,r){var n=e&&r||0;"string"==typeof t&&(e="binary"==t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.rng||i)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var a=0;a<16;++a)e[n+a]=s[a];return e||o(s)}var i=r(108),o=r(109);t.exports=n},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var i=n(r(0)),o=n(r(39)),s=n(r(40)),a=n(r(191)),u=r(106),c=r(52),l=null,f={},d={},h=function(t){function e(r,n,s){(0,i.default)(this,e);var a=(0,o.default)(this,t.call(this,r,n,s));return a.Qn(),a}return(0,s.default)(e,t),e.prototype.Qn=function(){var t=this;if(l){var e=this.it?"setInterval":"setTimeout";l.postMessage({command:e,id:this.$,time:this.tt}),f[this.$]=this.Z}else if(this.it){var r=function e(){d[t.$]=setTimeout(e,t.tt),t.Z()};d[this.$]=setTimeout(r,this.tt)}else{var n=function(){t.Z(),t.Z=c.noop};d[this.$]=setTimeout(n,this.tt)}},e.prototype.clear=function(){l?(delete f[this.$],l.postMessage({command:"clear",id:this.$})):(clearTimeout(d[this.$]),delete d[this.$]),this.Z=c.noop},e}(u.AbstractTimer);try{window.Worker&&((l=new window.Worker(URL.createObjectURL(new Blob(["("+a.default.toString()+")()"],{type:"text/javascript"})))).onmessage=function(t){var e=t.data,r=e.id,n=e.command;f[r]&&(f[r](),"triggerTimeout"===n&&delete f[r])},l.onerror=function(){})}catch(t){}t.exports=h},function(t,e,r){t.exports={default:r(188),__esModule:!0}},function(t,e,r){r(189),t.exports=r(1).Object.setPrototypeOf},function(t,e,r){var n=r(3);n(n.S,"Object",{setPrototypeOf:r(190).set})},function(t,e,r){var n=r(9),i=r(12),o=function(t,e){if(i(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{(n=r(13)(Function.call,r(100).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,r){return o(t,r),e?t.__proto__=r:n(t,r),t}}({},!1):void 0),check:o}},function(t,e,r){"use strict";function n(){function t(t){return function(){self.postMessage({id:t,command:"triggerTimeout"}),delete r[t]}}function e(t,n){return function(){self.postMessage({id:t,command:"triggerInterval"}),r[t]=setTimeout(e(t,n),n)}}var r={};self.onmessage=function(n){var i=n.data,o=i.command,s=i.id,a=i.time;switch(o){case"setTimeout":r[s]=setTimeout(t(s),a);break;case"setInterval":r[s]=setTimeout(e(s,a),a);break;case"clear":clearTimeout(r[s]),delete r[s]}}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(193)),o=n(r(29)),s=n(r(48)),a=n(r(0)),u=n(r(51)),c=r(103),l=n(r(2)),f=function(){function t(e){var r=this;(0,a.default)(this,t),this.$n=new s.default,this.Jn=function(){var t=!0,e=!1,n=void 0;try{for(var s,a=(0,o.default)(r.$n.entries());!(t=(s=a.next()).done);t=!0){var u=(0,i.default)(s.value,2),c=u[0],l=u[1];if(!r.j.parserAdapter)return void r.j.errorFunnel.notifyError(new Error("Parser adapter not available after MEDIA_MAP_CREATED is raised."));r.j.parserAdapter.setSegmentOffsetListForTrack(c,l)}}catch(t){e=!0,n=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw n}}r.$n.clear()},this.j=e,this.j.eventBus.once(l.default.MEDIA_MAP_CREATED,this.Jn)}return t.prototype.submitIndexSegment=function(t,e){try{var r=new u.default(t),n=r.host+r.pathname,i=(0,c.parse)(new Uint8Array(e));this.j.parserAdapter?this.j.parserAdapter.setSegmentOffsetListForTrack(n,i):this.$n.set(n,i)}catch(t){this.j.errorFunnel.notifyError(t)}},t.prototype.dispose=function(){this.j.eventBus.off(l.default.MEDIA_MAP_CREATED,this.Jn),this.$n.clear()},t}();e.default=f,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=n(r(194)),o=n(r(29));e.default=function(){function t(t,e){var r=[],n=!0,i=!1,s=void 0;try{for(var a,u=(0,o.default)(t);!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,s=t}finally{try{!n&&u.return&&u.return()}finally{if(i)throw s}}return r}return function(e,r){if(Array.isArray(e))return e;if((0,i.default)(Object(e)))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(t,e,r){t.exports={default:r(195),__esModule:!0}},function(t,e,r){r(36),r(27),t.exports=r(196)},function(t,e,r){var n=r(47),i=r(6)("iterator"),o=r(28);t.exports=r(1).isIterable=function(t){var e=Object(t);return void 0!==e[i]||"@@iterator"in e||o.hasOwnProperty(n(e))}},function(t,e,r){r(36),r(27),t.exports=r(198)},function(t,e,r){var n=r(12),i=r(70);t.exports=r(1).getIterator=function(t){var e=i(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return n(e.call(t))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={VERSION:1,URL:2,TYPE:3,ISLIVE:16,TRACKS_COUNT:17,SEGMENTS_COUNT:18,TIMESTAMP:32,DURATION:33,BITRATE:34};e.default=n,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){null!=t.nativeRequestHandle&&"function"==typeof t.nativeRequestHandle.delete&&t.nativeRequestHandle.delete()}Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(0)),s=(n(r(38)),r(7)),a=function t(e,r,n){var a=this;(0,o.default)(this,t),this.j=n,this.onSuccess=function(t,n,o,u){var c=t.data.slice(0).buffer,l=n.delay,f=n.p2pDuration||0,d=null!=l&&l>=0;d||(f=(d=null!=(l=u)&&l>=0)?l:n.p2pDuration||0);var h={timeElapsed:n.cdnDuration+f,latency:n.latency||0,lengthComputable:!0,loaded:c.byteLength,total:c.byteLength};if(!d)return r.onSuccess(e,c,h),void i(o);if(l&&a.j.configManager.conf.ENABLE_SKIP_EVENT_LOOP_DELAY){var p=a.j.qosAnalyticsHandler.qosAnalytics,v=p?p.getEventLoopStats():null;l=Math.max(l-(v?v.eventLoopDelay[1]:0),0)}0===l&&a.j.configManager.conf.ENABLE_SKIP_ZERO_DELAY?(r.onSuccess(e,c,h),i(o)):(0,s.createTimeout)(function(){r.onSuccess(e,c,h),i(o)},l)},this.onError=function(t,n){var o={status:t.status,message:t.message};r.onError&&r.onError(e,o),i(n)},this.onProgress=function(t,n){var i={timeElapsed:t.cdnDuration+t.p2pDuration,latency:t.latency||0,lengthComputable:t.lengthComputable||!1,loaded:t.cdnDownloaded+t.p2pDownloaded,total:t.total||0};r.onProgress&&r.onProgress(e,i)}};e.default=a,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.assertContentAndResponseType=void 0;var i=n(r(110)),o=n(r(76)),s=n(r(101)),a=function(t){var e=t.contentType,r=t.responseType;if(-1===(0,i.default)(o.default).indexOf(e))throw new TypeError("Invalid FetchConfig: '"+e+"' is not a valid ContentType");if(-1===(0,i.default)(s.default).indexOf(r))throw new TypeError("Invalid FetchConfig: '"+r+"' is not a valid ResponseType");switch(e){case o.default.MEDIA_SEGMENT:case o.default.INIT_SEGMENT:if(r!==s.default.ARRAY_BUFFER)throw new TypeError("Invalid FetchConfig: ContentTypes MEDIA_SEGMENT and INIT_SEGMENT are only compatible with ResponseType ARRAY_BUFFER");break;case o.default.MANIFEST:if(r!==s.default.TEXT)throw new TypeError("Invalid FetchConfig: ContentType MANIFEST is only compatible with ResponseType TEXT")}};e.assertContentAndResponseType=a},function(t,e,r){r(203),t.exports=r(1).Object.values},function(t,e,r){var n=r(3),i=r(204)(!1);n(n.S,"Object",{values:function(t){return i(t)}})},function(t,e,r){var n=r(8),i=r(26),o=r(19),s=r(34).f;t.exports=function(t){return function(e){for(var r,a=o(e),u=i(a),c=u.length,l=0,f=[];c>l;)r=u[l++],n&&!s.call(a,r)||f.push(t?[r,a[r]]:a[r]);return f}}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){var r="https://cdn.streamroot.io/dna-client/latest/dna-client.js";if(t.libPath)return t.libPath+"/dna-client.js";if(e.DNA_CLIENT_URL)return e.DNA_CLIENT_URL;if(e.DNA_CLIENT_VERSION){var n=new a.default(r),i=u.exec(n.pathname),o=i?i[1]:"",s=c.test(o)&&e.DNA_CLIENT_VERSION?n.pathname.replace("/"+o+"/","/"+e.DNA_CLIENT_VERSION+"/"):n.pathname;return n.set("pathname",s),t.libHost&&n.set("host",t.libHost),n.href}if(t.libHost){var l=new a.default(r);return l.set("host",t.libHost),l.href}return r}function o(t,e){return i(t,e).replace("/dna-client.js","")}function s(t,e){return t.libPath?{libPath:t.libPath}:t.libHost?{libHost:t.libHost}:e.DNA_CLIENT_URL||e.DNA_CLIENT_VERSION?{injectedDnaClientUrl:i(t,e)}:{defaultDnaClientUrl:"https://cdn.streamroot.io/dna-client/latest/dna-client.js"}}Object.defineProperty(e,"__esModule",{value:!0}),e.getDnaClientUrl=i,e.getBaseRepoUrl=o,e.getHostingOption=s;var a=n(r(51)),u=(n(r(113)),/\/([0-9a-z\.\-]+)\/[0-9a-z\-]+\.js$/),c=/^(?:[0-9]+\.[0-9]+\.[0-9]+(?:-[a-zA-Z0-9\.]+)?|latest)$/},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(11));e.default=(0,n.default)({UNKNOWN:"unknown",DEACTIVATED_BY_BYPASS:"deactivatedByBypass",DEACTIVATED_BY_USAGE_QUOTA:"deactivatedByUsageQuota",DEACTIVATED_BY_CONTENT:"deactivatedByContent",DEACTIVATED_BY_RAMP_UP:"deactivatedByRampUp",EXCLUDED_FROM_MESH:"excludedFromMesh",QOS_TESTER:"qosTester",ACTIVATED:"activated"}),t.exports=e.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(11));e.default=(0,n.default)({UNKNOWN:"unknown",DEACTIVATED_BY_BYPASS:"deactivatedByBypass",DEACTIVATED_BY_RAMP_UP:"deactivatedByRampUp",MODULE_DISABLED:"moduleDisabled",ACTIVATED:"activated"}),t.exports=e.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(11));e.default=(0,n.default)({PLAYBACK_TRIGGER:"playbackTrigger",SEGMENT_TRIGGER:"segmentTrigger",BUFFER_TRIGGER:"bufferTrigger",IMMEDIATE_TRIGGER:"immediateTrigger"}),t.exports=e.default},function(t,e,r){var n;!function(i,o){"use strict";var s="function",a="undefined",u="model",c="name",l="type",f="vendor",d="version",h="architecture",p="console",v="mobile",g="tablet",y="smarttv",m="wearable",E={extend:function(t,e){var r={};for(var n in t)e[n]&&e[n].length%2==0?r[n]=e[n].concat(t[n]):r[n]=t[n];return r},has:function(t,e){return"string"==typeof t&&-1!==e.toLowerCase().indexOf(t.toLowerCase())},lowerize:function(t){return t.toLowerCase()},major:function(t){return"string"==typeof t?t.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},_={rgx:function(t,e){for(var r,n,i,o,a,u,c=0;c<e.length&&!a;){var l=e[c],f=e[c+1];for(r=n=0;r<l.length&&!a;)if(a=l[r++].exec(t))for(i=0;i<f.length;i++)u=a[++n],"object"==typeof(o=f[i])&&o.length>0?2==o.length?typeof o[1]==s?this[o[0]]=o[1].call(this,u):this[o[0]]=o[1]:3==o.length?typeof o[1]!==s||o[1].exec&&o[1].test?this[o[0]]=u?u.replace(o[1],o[2]):void 0:this[o[0]]=u?o[1].call(this,u,o[2]):void 0:4==o.length&&(this[o[0]]=u?o[3].call(this,u.replace(o[1],o[2])):void 0):this[o]=u||void 0;c+=2}},str:function(t,e){for(var r in e)if("object"==typeof e[r]&&e[r].length>0){for(var n=0;n<e[r].length;n++)if(E.has(e[r][n],t))return"?"===r?void 0:r}else if(E.has(e[r],t))return"?"===r?void 0:r;return t}},b={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},T={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[c,d],[/(opios)[\/\s]+([\w\.]+)/i],[[c,"Opera Mini"],d],[/\s(opr)\/([\w\.]+)/i],[[c,"Opera"],d],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[c,d],[/(konqueror)\/([\w\.]+)/i],[[c,"Konqueror"],d],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[c,"IE"],d],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[c,"Edge"],d],[/(yabrowser)\/([\w\.]+)/i],[[c,"Yandex"],d],[/(puffin)\/([\w\.]+)/i],[[c,"Puffin"],d],[/(focus)\/([\w\.]+)/i],[[c,"Firefox Focus"],d],[/(opt)\/([\w\.]+)/i],[[c,"Opera Touch"],d],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[c,"UCBrowser"],d],[/(comodo_dragon)\/([\w\.]+)/i],[[c,/_/g," "],d],[/(windowswechat qbcore)\/([\w\.]+)/i],[[c,"WeChat(Win) Desktop"],d],[/(micromessenger)\/([\w\.]+)/i],[[c,"WeChat"],d],[/(brave)\/([\w\.]+)/i],[[c,"Brave"],d],[/(qqbrowserlite)\/([\w\.]+)/i],[c,d],[/(QQ)\/([\d\.]+)/i],[c,d],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[c,d],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[c,d],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[c,d],[/(MetaSr)[\/\s]?([\w\.]+)/i],[c],[/(LBBROWSER)/i],[c],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[d,[c,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[d,[c,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[c,d],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[d,[c,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[c,/(.+)/,"$1 WebView"],d],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[c,/(.+(?:g|us))(.+)/,"$1 $2"],d],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[d,[c,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[c,"Sailfish Browser"],d],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[c,d],[/(dolfin)\/([\w\.]+)/i],[[c,"Dolphin"],d],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[c,"Chrome"],d],[/(coast)\/([\w\.]+)/i],[[c,"Opera Coast"],d],[/fxios\/([\w\.-]+)/i],[d,[c,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[d,[c,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[d,c],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[c,"GSA"],d],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[c,[d,_.str,b.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[c,d],[/(navigator|netscape)\/([\w\.-]+)/i],[[c,"Netscape"],d],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[c,d]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[h,"amd64"]],[/(ia32(?=;))/i],[[h,E.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[h,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[h,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[h,/ower/,"",E.lowerize]],[/(sun4\w)[;\)]/i],[[h,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[h,E.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[u,f,[l,g]],[/applecoremedia\/[\w\.]+ \((ipad)/],[u,[f,"Apple"],[l,g]],[/(apple\s{0,1}tv)/i],[[u,"Apple TV"],[f,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[f,u,[l,g]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[u,[f,"Amazon"],[l,g]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[u,_.str,b.device.amazon.model],[f,"Amazon"],[l,v]],[/android.+aft([bms])\sbuild/i],[u,[f,"Amazon"],[l,y]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[u,f,[l,v]],[/\((ip[honed|\s\w*]+);/i],[u,[f,"Apple"],[l,v]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[f,u,[l,v]],[/\(bb10;\s(\w+)/i],[u,[f,"BlackBerry"],[l,v]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[u,[f,"Asus"],[l,g]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[f,"Sony"],[u,"Xperia Tablet"],[l,g]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[u,[f,"Sony"],[l,v]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[f,u,[l,p]],[/android.+;\s(shield)\sbuild/i],[u,[f,"Nvidia"],[l,p]],[/(playstation\s[34portablevi]+)/i],[u,[f,"Sony"],[l,p]],[/(sprint\s(\w+))/i],[[f,_.str,b.device.sprint.vendor],[u,_.str,b.device.sprint.model],[l,v]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[f,[u,/_/g," "],[l,v]],[/(nexus\s9)/i],[u,[f,"HTC"],[l,g]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[u,[f,"Huawei"],[l,v]],[/(microsoft);\s(lumia[\s\w]+)/i],[f,u,[l,v]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[u,[f,"Microsoft"],[l,p]],[/(kin\.[onetw]{3})/i],[[u,/\./g," "],[f,"Microsoft"],[l,v]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[u,[f,"Motorola"],[l,v]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[u,[f,"Motorola"],[l,g]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[f,E.trim],[u,E.trim],[l,y]],[/hbbtv.+maple;(\d+)/i],[[u,/^/,"SmartTV"],[f,"Samsung"],[l,y]],[/\(dtv[\);].+(aquos)/i],[u,[f,"Sharp"],[l,y]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[f,"Samsung"],u,[l,g]],[/smart-tv.+(samsung)/i],[f,[l,y],u],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[f,"Samsung"],u,[l,v]],[/sie-(\w*)/i],[u,[f,"Siemens"],[l,v]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[f,"Nokia"],u,[l,v]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[u,[f,"Acer"],[l,g]],[/android.+([vl]k\-?\d{3})\s+build/i],[u,[f,"LG"],[l,g]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[f,"LG"],u,[l,g]],[/(lg) netcast\.tv/i],[f,u,[l,y]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[u,[f,"LG"],[l,v]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[f,u,[l,g]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[u,[f,"Lenovo"],[l,g]],[/(lenovo)[_\s-]?([\w-]+)/i],[f,u,[l,v]],[/linux;.+((jolla));/i],[f,u,[l,v]],[/((pebble))app\/[\d\.]+\s/i],[f,u,[l,m]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[f,u,[l,v]],[/crkey/i],[[u,"Chromecast"],[f,"Google"]],[/android.+;\s(glass)\s\d/i],[u,[f,"Google"],[l,m]],[/android.+;\s(pixel c)[\s)]/i],[u,[f,"Google"],[l,g]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[u,[f,"Google"],[l,v]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[u,/_/g," "],[f,"Xiaomi"],[l,v]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[u,/_/g," "],[f,"Xiaomi"],[l,g]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[u,[f,"Meizu"],[l,v]],[/(mz)-([\w-]{2,})/i],[[f,"Meizu"],u,[l,v]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[u,[f,"OnePlus"],[l,v]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[u,[f,"RCA"],[l,g]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[u,[f,"Dell"],[l,g]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[u,[f,"Verizon"],[l,g]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[f,"Barnes & Noble"],u,[l,g]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[u,[f,"NuVision"],[l,g]],[/android.+;\s(k88)\sbuild/i],[u,[f,"ZTE"],[l,g]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[u,[f,"Swiss"],[l,v]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[u,[f,"Swiss"],[l,g]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[u,[f,"Zeki"],[l,g]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[f,"Dragon Touch"],u,[l,g]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[u,[f,"Insignia"],[l,g]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[u,[f,"NextBook"],[l,g]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[f,"Voice"],u,[l,v]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[f,"LvTel"],u,[l,v]],[/android.+;\s(PH-1)\s/i],[u,[f,"Essential"],[l,v]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[u,[f,"Envizen"],[l,g]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[f,u,[l,g]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[u,[f,"MachSpeed"],[l,g]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[f,u,[l,g]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[u,[f,"Rotor"],[l,g]],[/android.+(KS(.+))\s+build/i],[u,[f,"Amazon"],[l,g]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[f,u,[l,g]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[l,E.lowerize],f,u],[/[\s\/\(](smart-?tv)[;\)]/i],[[l,y]],[/(android[\w\.\s\-]{0,9});.+build/i],[u,[f,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[d,[c,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)/i],[[c,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[c,d],[/rv\:([\w\.]{1,9}).+(gecko)/i],[d,c]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[c,d],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[c,[d,_.str,b.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[c,"Windows"],[d,_.str,b.os.windows.version]],[/\((bb)(10);/i],[[c,"BlackBerry"],d],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[c,d],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[c,"Symbian"],d],[/\((series40);/i],[c],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[c,"Firefox OS"],d],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[c,d],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[c,"Chromium OS"],d],[/(sunos)\s?([\w\.\d]*)/i],[[c,"Solaris"],d],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[c,d],[/(haiku)\s(\w+)/i],[c,d],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[d,/_/g,"."],[c,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[c,"Mac OS"],[d,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[c,d]]},S=function(t,e){if("object"==typeof t&&(e=t,t=void 0),!(this instanceof S))return new S(t,e).getResult();var r=t||(i&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:""),n=e?E.extend(T,e):T;return this.getBrowser=function(){var t={name:void 0,version:void 0};return _.rgx.call(t,r,n.browser),t.major=E.major(t.version),t},this.getCPU=function(){var t={architecture:void 0};return _.rgx.call(t,r,n.cpu),t},this.getDevice=function(){var t={vendor:void 0,model:void 0,type:void 0};return _.rgx.call(t,r,n.device),t},this.getEngine=function(){var t={name:void 0,version:void 0};return _.rgx.call(t,r,n.engine),t},this.getOS=function(){var t={name:void 0,version:void 0};return _.rgx.call(t,r,n.os),t},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(t){return r=t,this},this};S.VERSION="0.7.20",S.BROWSER={NAME:c,MAJOR:"major",VERSION:d},S.CPU={ARCHITECTURE:h},S.DEVICE={MODEL:u,VENDOR:f,TYPE:l,CONSOLE:p,MOBILE:v,SMARTTV:y,TABLET:g,WEARABLE:m,EMBEDDED:"embedded"},S.ENGINE={NAME:c,VERSION:d},S.OS={NAME:c,VERSION:d},typeof e!==a?(typeof t!==a&&t.exports&&(e=t.exports=S),e.UAParser=S):void 0===(n=function(){return S}.call(e,r,e,t))||(t.exports=n);var w=i&&(i.jQuery||i.Zepto);if(typeof w!==a&&!w.ua){var A=new S;w.ua=A.getResult(),w.ua.get=function(){return A.getUA()},w.ua.set=function(t){A.setUA(t);var e=A.getResult();for(var r in e)w.ua[r]=e[r]}}}("object"==typeof window?window:this)},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(17)),o=n(r(0)),s=n(r(211)),a=n(r(212)),u=n(r(2)),c=function(){function t(e){var r=this,n=e.eventBus,i=e.configManager;(0,o.default)(this,t),this.gt=null,this.Zn={},this.ti=function(){r.T.ERRORS&&(s.default.apiKey=r.T.ERRORS.API_KEY,s.default.notifyHandler=r.T.ERRORS.HANDLER,s.default.notifyReleaseStages=r.T.ERRORS.STAGES,s.default.disableLog=!0,s.default.releaseStage="production",s.default.autoNotify=!1,s.default.appVersion="1.23.0".split("-")[0])},this.ni=function(t){t.filename&&t.filename===r.gt&&r.notifyError(new a.default(t))},this.g=n,this.T=i.conf,this.g.on(u.default.LOCAL_CONF_UPDATED,this.ti),window.addEventListener("error",this.ni),this.ti()}return t.prototype.dispose=function(){this.g.removeListener(u.default.LOCAL_CONF_UPDATED,this.ti),window.removeEventListener("error",this.ni)},t.prototype.notify=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"warning";r.match(/^(warning|info|error)$/)||(r="warning"),s.default.notify(t,e,this.Zn,r)},t.prototype.notifyError=function(t,e){s.default.notifyException(t,{groupingHash:e||t.message})},t.prototype.setMetadata=function(t){(0,i.default)(this.Zn,t),s.default.metaData=this.Zn},t.prototype.setScriptOrigin=function(t){this.gt=t},t.prototype.setCustomer=function(t){s.default.userId=t},t}();e.default=c,t.exports=e.default},function(t,e,r){"use strict";var n,i,o=function(t){return t&&t.__esModule?t:{default:t}}(r(22));!function(r){function s(){D=!1}function a(){var t=document.currentScript||T;if(!t&&D){var e=document.scripts||document.getElementsByTagName("script");t=e[e.length-1]}return t}function u(t){var e=a();e&&(t.script={src:e.src,content:p("inlineScript",!0)?e.innerHTML:""})}function c(t){var e=p("disableLog"),r=window.console;void 0===r||void 0===r.log||e||r.log("[Bugsnag] "+t)}function l(t,e,r){if(r>=p("maxDepth",R))return encodeURIComponent(e)+"=[RECURSIVE]";r=r+1||1;try{if(window.Node&&t instanceof window.Node)return encodeURIComponent(e)+"="+encodeURIComponent(_(t));var n=[];for(var i in t)if(t.hasOwnProperty(i)&&null!=i&&null!=t[i]){var s=e?e+"["+i+"]":i,a=t[i];n.push("object"===(void 0===a?"undefined":(0,o.default)(a))?l(a,s,r):encodeURIComponent(s)+"="+encodeURIComponent(a))}return n.join("&")}catch(t){return encodeURIComponent(e)+"="+encodeURIComponent(""+t)}}function f(t,e,r){if(null==e)return t;if(r>=p("maxDepth",R))return"[RECURSIVE]";for(var n in t=t||{},e)if(e.hasOwnProperty(n))try{e[n].constructor===Object?t[n]=f(t[n],e[n],r+1||1):t[n]=e[n]}catch(r){t[n]=e[n]}return t}function d(t,e){if(t+="?"+l(e)+"&ct=img&cb="+(new Date).getTime(),"undefined"!=typeof BUGSNAG_TESTING&&w.testRequest)w.testRequest(t,e);else if("xhr"===p("notifyHandler")){var r=new XMLHttpRequest;r.open("GET",t,!0),r.send()}else(new Image).src=t}function h(t){var e={},r=/^data\-([\w\-]+)$/;if(t)for(var n=t.attributes,i=0;i<n.length;i++){var o=n[i];r.test(o.nodeName)&&(e[o.nodeName.match(r)[1]]=o.value||o.nodeValue)}return e}function p(t,e){O=O||h(N);var r=void 0!==w[t]?w[t]:O[t.toLowerCase()];return"false"===r&&(r=!1),void 0!==r?r:e}function v(t){return!(!t||!t.match(L))||(c("Invalid API key '"+t+"'"),!1)}function g(t,e){var r=p("apiKey");if(v(r)&&A){A-=1;var n=p("releaseStage","production"),i=p("notifyReleaseStages");if(i){for(var o=!1,s=0;s<i.length;s++)if(n===i[s]){o=!0;break}if(!o)return}var a=[t.name,t.message,t.stacktrace].join("|");if(a!==S){S=a,b&&((e=e||{})["Last Event"]=E(b));var u={notifierVersion:P,apiKey:r,projectRoot:p("projectRoot")||window.location.protocol+"//"+window.location.host,context:p("context")||window.location.pathname,userId:p("userId"),user:p("user"),metaData:f(f({},p("metaData")),e),releaseStage:n,appVersion:p("appVersion"),url:window.location.href,userAgent:navigator.userAgent,language:navigator.language||navigator.userLanguage,severity:t.severity,name:t.name,message:t.message,stacktrace:t.stacktrace,file:t.file,lineNumber:t.lineNumber,columnNumber:t.columnNumber,payloadVersion:"2"},l=w.beforeNotify;if("function"==typeof l&&!1===l(u,u.metaData))return;if(0===u.lineNumber&&/Script error\.?/.test(u.message))return c("Ignoring cross-domain script error. See https://bugsnag.com/docs/notifiers/js/cors");d(p("endpoint")||I,u)}}}function y(){var t,e;try{throw new Error("")}catch(r){t="<generated>\n",e=m(r)}if(!e){t="<generated-ie>\n";var r=[];try{for(var n=arguments.callee.caller.caller;n&&r.length<10;){var i=C.test(n.toString())&&RegExp.$1||"[anonymous]";r.push(i),n=n.caller}}catch(t){c(t)}e=r.join("\n")}return t+e}function m(t){return t.stack||t.backtrace||t.stacktrace}function E(t){return{millisecondsAgo:new Date-t.timeStamp,type:t.type,which:t.which,target:_(t.target)}}function _(t){if(t){var e=t.attributes;if(e){for(var r="<"+t.nodeName.toLowerCase(),n=0;n<e.length;n++)e[n].value&&"null"!==e[n].value.toString()&&(r+=" "+e[n].name+'="'+e[n].value+'"');return r+">"}return t.nodeName}}var b,T,S,w={},A=10,R=5;w.noConflict=function(){return window.Bugsnag=r,void 0===r&&delete window.Bugsnag,w},w.refresh=function(){A=10},w.notifyException=function(t,e,r,n){t&&(e&&"string"!=typeof e&&(r=e,e=void 0),r||(r={}),u(r),g({name:e||t.name,message:t.message||t.description,stacktrace:m(t)||y(),file:t.fileName||t.sourceURL,lineNumber:t.lineNumber||t.line,columnNumber:t.columnNumber?t.columnNumber+1:void 0,severity:n||"warning"},r))},w.notify=function(t,e,r,n){g({name:t,message:e,stacktrace:y(),file:window.location.toString(),lineNumber:1,severity:n||"warning"},r)};var D="complete"!==document.readyState;document.addEventListener?(document.addEventListener("DOMContentLoaded",s,!0),window.addEventListener("load",s,!0)):window.attachEvent("onload",s);var O,L=/^[0-9a-f]{32}$/i,C=/function\s*([\w\-$]+)?\s*\(/i,I="https://notify.bugsnag.com/js",P="2.5.0",M=document.getElementsByTagName("script"),N=M[M.length-1];if(window.atob&&window.ErrorEvent)try{new window.ErrorEvent("test").colno}catch(t){}window.Bugsnag=w,void 0===(i=function(){return w}.apply(e,n=[]))||(t.exports=i)}(window.Bugsnag)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),i=function t(e){(0,n.default)(this,t),this.message=e.error.message,this.stacktrace=e.error.stack,this.fileName=e.filename,this.lineNumber=e.lineno,this.columnNumber=e.colno?e.colno:void 0};e.default=i,t.exports=e.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),i=function t(e){if((0,n.default)(this,t),(e=e||{}).contentIdGenerator&&"function"!=typeof e.contentIdGenerator)throw new TypeError("DnaConfig.contentIdGenerator should be a function");if(""===e.property||e.property&&"string"!=typeof e.property&&"function"!=typeof e.property)throw new TypeError("DnaConfig.property should be a string or a function");if(""===e.compassProperty||e.compassProperty&&"string"!=typeof e.compassProperty&&"function"!=typeof e.compassProperty)throw new TypeError("DnaConfig.compassProperty should be a string or a function");if(e.libPath&&"string"!=typeof e.libPath)throw new TypeError("DnaConfig.libPath should be a string");if(e.libHost&&"string"!=typeof e.libHost)throw new TypeError("DnaConfig.libHost should be a string");if(e.libPath&&e.libHost)throw new TypeError("libPath and libHost are mutually exclusive: only one can be defined in dnaConfig");if(e.backendUrl&&"string"!=typeof e.backendUrl)throw new TypeError("DnaConfig.backendUrl should be a string");if(e.backendHost&&"string"!=typeof e.backendHost)throw new TypeError("DnaConfig.backendHost should be a string");if(e.compassScoreProviderHost&&"string"!=typeof e.compassScoreProviderHost)throw new TypeError("DnaConfig.compassScoreProviderHost should be a string");if(e.siteId&&"string"!=typeof e.siteId)throw new TypeError("DnaConfig.siteId should be a string");if(e.fragmentsFetchedBeforeLoad&&"number"!=typeof e.fragmentsFetchedBeforeLoad)throw new TypeError("DnaConfig.fragmentsFetchedBeforeLoad should be a number");if(e.secondsPrebufferedBeforeLoad&&"number"!=typeof e.secondsPrebufferedBeforeLoad)throw new TypeError("DnaConfig.secondsPrebufferedBeforeLoad should be a number");if("number"==typeof e.fragmentsFetchedBeforeLoad&&"number"==typeof e.secondsPrebufferedBeforeLoad)throw new Error("fragmentsFetchedBeforeLoad and secondsPrebufferedBeforeLoad cannot be set at the same time");if(e.reconfigureRequest&&"function"!=typeof e.reconfigureRequest)throw new Error("reconfigureRequest should be a function");if(e.privateIPAddress&&"string"!=typeof e.privateIPAddress)throw new TypeError("DnaConfig.privateIPAddress should be a string");if(e.customerLabel&&"string"!=typeof e.customerLabel)throw new TypeError("DnaConfig.customerLabel should be a string");this.contentIdGenerator=e.contentIdGenerator||null,this.property=e.property||null,this.compassProperty=e.compassProperty||null,this.libPath=e.libPath||null,this.libHost=e.libHost||null,this.siteId=e.siteId||null,this.backendUrl=e.backendUrl||null,this.backendHost=e.backendHost||null,this.compassScoreProviderHost=e.compassScoreProviderHost||e.backendHost||null,this.fragmentsFetchedBeforeLoad="number"==typeof e.fragmentsFetchedBeforeLoad?e.fragmentsFetchedBeforeLoad:null,this.secondsPrebufferedBeforeLoad="number"==typeof e.secondsPrebufferedBeforeLoad?e.secondsPrebufferedBeforeLoad:null,this.loadAfterPlaybackStarted=!!e.loadAfterPlaybackStarted,this.reconfigureRequest=e.reconfigureRequest||null,this.privateIPAddress=e.privateIPAddress||null,this.customerLabel=e.customerLabel||""};e.default=i,t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(r(90));e.default=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return(0,n.default)(t)}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(21)),o=n(r(56)),s=n(r(0)),a=n(r(4)),u=n(r(23)),c=n(r(38)),l=n(r(80)),f=n(r(104)),d=n(r(105)),h=r(7),p=n(r(2)),v=function(){function t(e,r,n,i,o){(0,s.default)(this,t),this.ii=!1,this.ei=0,this.ri=0,this.si=0,this.oi=0,this.ui={},this.ci=e,this.I=r,this.V=n,this.g=i,this.hi=o,this.ai()}return t.prototype.send=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments[1];return new o.default(function(n,i){t.fi(e).then(function(t){n(t)}).catch(function(t){r&&r(t),i(t)})})},t.prototype.abort=function(){this.ii=!0,this.li.abort()},t.prototype.reset=function(){this.ai()},t.prototype.ai=function(){this.li=new XMLHttpRequest,this.li.open(this.ci,this.I,!0),this.li.responseType=this.V.responseType,this.li.withCredentials=this.V.withCredentials;for(var t=(0,i.default)(this.V.headers),e=0,r=t.length;e<r;e++){var n=t[e];this.li.setRequestHeader(n,this.V.headers[n])}this.ii=!1},t.prototype.di=function(){null!=this.vi&&(this.vi.clear(),this.vi=null)},t.prototype.fi=function(t){var e=this;return new o.default(function(r,n){var i=!1,o=function(t){e.di(),e.wi||i||(e.g&&e.g.emit(p.default.CDN_DOWNLOAD_ERROR,{url:e.I,error:t}),i=!0),n(t)},s=function(){e.di();var t=new c.default(u.default.Errors.REQUEST_ABORTED,e.li.status,e.li.readyState);0===e.oi&&e.hi&&Date.now()-e.ei>=e.hi?o(t):n(t)};e.ii?s():e.V.timeout&&(e.vi=(0,h.createTimeout)(function(){e.abort(),o(new c.default(u.default.Errors.REQUEST_TIMEOUT,e.li.status,e.li.readyState))},e.V.timeout)),e.li.onreadystatechange=function(){if(2===e.li.readyState){var t=e.li.getAllResponseHeaders();null!=t&&t.trim().split(/[\r\n]+/).forEach(function(t){var r=t.split(": "),n=r.shift(),i=r.join(": ");e.ui[n]=i})}},e.li.onloadend=function(){if(e.ii)s();else if(e.li.readyState===u.default.ReadyStates.DONE)if(e.V.validStatusCodes.indexOf(e.li.status)>-1){if(e.si=Date.now(),e.ri||(e.ri=Date.now()),!e.wi){var t=e.li.response,n=t&&(t.byteLength||t.length)||0;e.g&&e.g.emit(p.default.CDN_TIMING_EVENT,new l.default(e.ei,e.ri,e.si,n,e.I))}if(e.li.response instanceof ArrayBuffer)e.di(),r(new d.default(e.li.response));else{var i=e.li.response;"json"===e.V.responseType&&"string"==typeof i&&i.length>0&&(i=JSON.parse(i)),e.di(),r(i)}}else o(new c.default(u.default.Errors.INVALID_STATUS,e.li.status,e.li.readyState));else o(new c.default(u.default.Errors.REQUEST_ERROR,e.li.status,e.li.readyState))},e.li.onprogress=function(t){e.ri||(e.ri=Date.now()),e.oi+=t.loaded;var r=new f.default(t.lengthComputable,t.loaded,t.total);e.V.events.onprogress(r)},e.li.onerror=function(){o(new c.default(u.default.Errors.REQUEST_ERROR,e.li.status,e.li.readyState))},e.ei=Date.now(),e.li.send(t)})},(0,a.default)(t,[{key:"isStreamroot",set:function(t){this.wi=t}},{key:"responseURL",get:function(){return this.li&&this.li.readyState===u.default.ReadyStates.DONE&&this.li.responseURL?this.li.responseURL:null}},{key:"responseHeaders",get:function(){return this.ui}}]),t}();e.default=v,t.exports=e.default},function(t,e,r){r(71),r(27),r(36),r(217),r(221),r(222),t.exports=r(1).Promise},function(t,e,r){"use strict";var n,i,o,s,a=r(33),u=r(5),c=r(13),l=r(47),f=r(3),d=r(9),h=r(30),p=r(73),v=r(37),g=r(116),y=r(117).set,m=r(219)(),E=r(79),_=r(118),b=r(220),T=r(119),S="Promise",w=u.TypeError,A=u.process,R=A&&A.versions,D=R&&R.v8||"",O=u.Promise,L="process"==l(A),C=function(){},I=i=E.f,P=!!function(){try{var t=O.resolve(1),e=(t.constructor={})[r(6)("species")]=function(t){t(C,C)};return(L||"function"==typeof PromiseRejectionEvent)&&t.then(C)instanceof e&&0!==D.indexOf("6.6")&&-1===b.indexOf("Chrome/66")}catch(t){}}(),M=function(t){var e;return!(!d(t)||"function"!=typeof(e=t.then))&&e},N=function(t,e){if(!t._n){t._n=!0;var r=t._c;m(function(){for(var n=t._v,i=1==t._s,o=0;r.length>o;)!function(e){var r,o,s,a=i?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{a?(i||(2==t._h&&F(t),t._h=1),!0===a?r=n:(l&&l.enter(),r=a(n),l&&(l.exit(),s=!0)),r===e.promise?c(w("Promise-chain cycle")):(o=M(r))?o.call(r,u,c):u(r)):c(n)}catch(t){l&&!s&&l.exit(),c(t)}}(r[o++]);t._c=[],t._n=!1,e&&!t._h&&k(t)})}},k=function(t){y.call(u,function(){var e,r,n,i=t._v,o=x(t);if(o&&(e=_(function(){L?A.emit("unhandledRejection",i,t):(r=u.onunhandledrejection)?r({promise:t,reason:i}):(n=u.console)&&n.error&&n.error("Unhandled promise rejection",i)}),t._h=L||x(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},x=function(t){return 1!==t._h&&0===(t._a||t._c).length},F=function(t){y.call(u,function(){var e;L?A.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})})},U=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),N(e,!0))},B=function(t){var e,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw w("Promise can't be resolved itself");(e=M(t))?m(function(){var n={_w:r,_d:!1};try{e.call(t,c(B,n,1),c(U,n,1))}catch(t){U.call(n,t)}}):(r._v=t,r._s=1,N(r,!1))}catch(t){U.call({_w:r,_d:!1},t)}}};P||(O=function(t){p(this,O,S,"_h"),h(t),n.call(this);try{t(c(B,this,1),c(U,this,1))}catch(t){U.call(this,t)}},(n=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(72)(O.prototype,{then:function(t,e){var r=I(g(this,O));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=L?A.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&N(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new n;this.promise=t,this.resolve=c(B,t,1),this.reject=c(U,t,1)},E.f=I=function(t){return t===O||t===s?new o(t):i(t)}),f(f.G+f.W+f.F*!P,{Promise:O}),r(35)(O,S),r(96)(S),s=r(1).Promise,f(f.S+f.F*!P,S,{reject:function(t){var e=I(this);return(0,e.reject)(t),e.promise}}),f(f.S+f.F*(a||!P),S,{resolve:function(t){return T(a&&this===s?O:this,t)}}),f(f.S+f.F*!(P&&r(94)(function(t){O.all(t).catch(C)})),S,{all:function(t){var e=this,r=I(e),n=r.resolve,i=r.reject,o=_(function(){var r=[],o=0,s=1;v(t,!1,function(t){var a=o++,u=!1;r.push(void 0),s++,e.resolve(t).then(function(t){u||(u=!0,r[a]=t,--s||n(r))},i)}),--s||n(r)});return o.e&&i(o.v),r.promise},race:function(t){var e=this,r=I(e),n=r.reject,i=_(function(){v(t,!1,function(t){e.resolve(t).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}})},function(t,e){t.exports=function(t,e,r){var n=void 0===r;switch(e.length){case 0:return n?t():t.call(r);case 1:return n?t(e[0]):t.call(r,e[0]);case 2:return n?t(e[0],e[1]):t.call(r,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(r,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(r,e[0],e[1],e[2],e[3])}return t.apply(r,e)}},function(t,e,r){var n=r(5),i=r(117).set,o=n.MutationObserver||n.WebKitMutationObserver,s=n.process,a=n.Promise,u="process"==r(32)(s);t.exports=function(){var t,e,r,c=function(){var n,i;for(u&&(n=s.domain)&&n.exit();t;){i=t.fn,t=t.next;try{i()}catch(n){throw t?r():e=void 0,n}}e=void 0,n&&n.enter()};if(u)r=function(){s.nextTick(c)};else if(!o||n.navigator&&n.navigator.standalone)if(a&&a.resolve){var l=a.resolve(void 0);r=function(){l.then(c)}}else r=function(){i.call(n,c)};else{var f=!0,d=document.createTextNode("");new o(c).observe(d,{characterData:!0}),r=function(){d.data=f=!f}}return function(n){var i={fn:n,next:void 0};e&&(e.next=i),t||(t=i,r()),e=i}}},function(t,e,r){var n=r(5).navigator;t.exports=n&&n.userAgent||""},function(t,e,r){"use strict";var n=r(3),i=r(1),o=r(5),s=r(116),a=r(119);n(n.P+n.R,"Promise",{finally:function(t){var e=s(this,i.Promise||o.Promise),r="function"==typeof t;return this.then(r?function(r){return a(e,t()).then(function(){return r})}:t,r?function(r){return a(e,t()).then(function(){throw r})}:t)}})},function(t,e,r){"use strict";var n=r(3),i=r(79),o=r(118);n(n.S,"Promise",{try:function(t){var e=i.f(this),r=o(t);return(r.e?e.reject:e.resolve)(r.v),e.promise}})},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(16)),o=n(r(56)),s=n(r(0)),a=n(r(4)),u=r(24),c=r(7),l=r(52),f=(n(r(38)),function(){function t(e,r){(0,s.default)(this,t),this.pi=0,this.bi=e,this.mi=r}return t.prototype.send=function(t,e){var r=this;return new o.default(function(n,o){function s(){var r=this,s="function"==typeof t?t():t;"string"!=typeof s&&(s=(0,i.default)(s)),this.bi.send(s).then(function(t){n(t)}).catch(function(t){if(e&&e(t),!r.ii)if(t.status>=400&&t.status<500)o(t);else{0===r.pi&&(r.pi=r.mi.MIN_DELAY/r.mi.MIN_FACTOR);var n=(0,u.randomInRange)(r.mi.MIN_FACTOR,r.mi.MAX_FACTOR);r.pi=(0,u.clamp)(r.pi*n,r.mi.MIN_DELAY,r.mi.MAX_DELAY),r.Ei=(0,c.createTimeout)(function(){r.bi.reset(),r.yi()},r.pi)}})}r.yi=s.bind(r),r.yi()})},t.prototype.abort=function(){this.ii=!0,this.Ei&&(this.Ei.clear(),this.Ei=null,this.yi=l.noop),this.bi.abort()},t.prototype.reset=function(){this.ii=!1,this.Ei&&(this.Ei.clear(),this.Ei=null,this.yi=l.noop),this.pi=0,this.bi.reset()},(0,a.default)(t,[{key:"isStreamroot",set:function(t){this.bi.isStreamroot=t}}]),t}());e.default=f,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(56)),o=n(r(0)),s=n(r(4)),a=r(7),u=r(52),c=(n(r(38)),function(){function t(e,r){(0,o.default)(this,t),this.gi=0,this.bi=e,this.mi=r}return t.prototype.send=function(t,e){var r=this;return new i.default(function(n,i){function o(){var r=this;this.bi.send(t).then(function(t){n(t)}).catch(function(t){e&&e(t),r.ii||(r.gi===r.mi.RETRY||t.status>=400&&t.status<500?i(t):(r.gi++,r.Ei=(0,a.createTimeout)(function(){r.bi.reset(),r.yi()},r.mi.RETRY_DELAY)))})}r.yi=o.bind(r),r.yi()})},t.prototype.abort=function(){this.ii=!0,this.Ei&&(this.Ei.clear(),this.Ei=null,this.yi=u.noop),this.bi.abort()},t.prototype.reset=function(){this.ii=!1,this.Ei&&(this.Ei.clear(),this.Ei=null,this.yi=u.noop),this.gi=0,this.bi.reset()},(0,s.default)(t,[{key:"isStreamroot",set:function(t){this.bi.isStreamroot=t}}]),t}());e.default=c,t.exports=e.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),i=function t(){(0,n.default)(this,t),this.routerRequestsCount=0,this.routerRequestsVolume=0,this.routerResponsesVolume=0,this.distributorRequestsCount=0,this.distributorRequestsVolume=0,this.distributorResponsesVolume=0,this.subnetMatcherRequestsCount=0,this.subnetMatcherRequestsVolume=0,this.subnetMatcherResponsesVolume=0,this.usagePayloadsCount=0,this.usagePayloadsVolume=0,this.researchPayloadsVolume=0};e.default=i,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(4)),s=function(){function t(){(0,i.default)(this,t),this.http=0,this.network=0}return t.prototype.increment=function(t){t.status>0?this.http++:this.network++},(0,o.default)(t,[{key:"all",get:function(){return this.http+this.network}}]),t}(),a=function t(){(0,i.default)(this,t),this.azChanges=0,this.routerErrors=new s,this.distributorErrors=new s,this.subnetMatcherErrors=new s,this.analyticsErrors=new s};e.default=a,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(4)),s=n(r(2)),a=(n(r(112)),n(r(41))),u=function(){function t(e,r){var n=this;(0,i.default)(this,t),this.Ti=0,this.Oi=0,this.playbackErrorCount=0,this.segmentsNotFound=0,this.segmentsFound=0,this.tracksNotFound=0,this.tracksFound=0,this.Dn=function(t){n.ot=t},this.Mi=function(t){var e=a.default.getSegmentDuration(n.ot,t)/1e3;if(e>0)n.Ti+=e,n.Oi=e;else if(n.Oi>0)n.Ti+=n.Oi;else{var r=n.Si.getStreamInfo().segmentDuration;r&&(n.Ti+=r,n.Oi=r)}},this.g=e,this.Si=r,this.g.on(s.default.MEDIA_MAP_CREATED,this.Dn),this.g.on(s.default.MEDIA_SEGMENT_CONSUMED,this.Mi)}return t.prototype.dispose=function(){this.g.removeListener(s.default.MEDIA_SEGMENT_CONSUMED,this.Mi),this.g.removeListener(s.default.MEDIA_MAP_CREATED,this.Dn)},(0,o.default)(t,[{key:"durationConsumed",get:function(){return this.Ti}}]),t}();e.default=u,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(2)),s=n(r(229)),a=n(r(41)),u=function(){function t(e,r){var n=this,u=r.conf;(0,i.default)(this,t),this.Ai=0,this.Dn=function(t){n.ot=t},this.Ri=function(t){if(t&&"video"===a.default.getTrackType(n.ot,t)){var e=a.default.getTrackBitrate(n.ot,t);e&&n.Ai!==e&&(n.Ni.updateMetric(e),n.Ai=e)}},this.g=e,this.g.on(o.default.MEDIA_MAP_CREATED,this.Dn),this.g.on(o.default.MEDIA_SEGMENT_CONSUMED,this.Ri);var c=Math.max(u.ANALYTICS.TRAFFIC_INTERVAL_ARRAY[u.ANALYTICS.TRAFFIC_INTERVAL_ARRAY.length-1],u.ANALYTICS.STATS_INTERVAL);this.Ni=new s.default(2*c)}return t.prototype.dispose=function(){this.g.removeListener(o.default.MEDIA_SEGMENT_CONSUMED,this.Ri),this.g.removeListener(o.default.MEDIA_MAP_CREATED,this.Dn)},t.prototype.getAverageBitrate=function(t){return Math.round(this.Ni.getAverage(t))},t}();e.default=u,t.exports=e.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),i=function(){function t(e){(0,n.default)(this,t),this.Ci=[{value:0,timeStamp:Date.now()}],this.Di=e}return t.prototype.updateMetric=function(t){this.Ci.push({value:t,timeStamp:Date.now()})},t.prototype.getAverage=function(t){if(this.Ci.length<1)return 0;var e=Date.now(),r=Math.max(e-Math.min(t,this.Di),this.Ci[0].timeStamp),n=0,i=e,o=void 0,s=void 0,a=void 0,u=void 0;for(s=this.Ci.length-1;s>=0&&((o=this.Ci[s]).timeStamp<=r?(u=i-r,a=!0):u=i-o.timeStamp,n+=o.value*u,i=o.timeStamp,!a);s--);var c=e-this.Di;o&&o.timeStamp<c&&(o.timeStamp=c,s>0&&this.Ci.splice(0,s));var l=e-r;return l>0?n/l:0},t}();e.default=i,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(4)),s=(n(r(53)),n(r(2))),a=n(r(231)),u=n(r(121)),c=function(){function t(e,r){var n=this;(0,i.default)(this,t),this.Un=function(t){n.Ii.setState(t)},this.g=e,this.g.on(s.default.NETWORK_TYPE_CHANGED,this.Un),this.Ii=new a.default(u.default),this.Ii.setState(r)}return t.prototype.dispose=function(){this.g.removeListener(s.default.NETWORK_TYPE_CHANGED,this.Un),this.Ii.dispose()},t.prototype.ji=function(t){return this.Ii.getStats()[t].timeSpent},(0,o.default)(t,[{key:"timeSpentOnWifi",get:function(){return this.ji(u.default.WIFI_AND_ETHERNET)}},{key:"timeSpentOnCellular",get:function(){return this.ji(u.default.CELLULAR_AND_OTHERS)}},{key:"timeSpentWithoutNetwork",get:function(){return this.ji(u.default.NONE)}}]),t}();e.default=c,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(21)),o=n(r(110)),s=n(r(0)),a=function(){function t(e){(0,s.default)(this,t),this.ki={},this.Li=(0,o.default)(e);for(var r=(0,i.default)(e),n=0;n<r.length;n++)this.ki[e[r[n]]]={count:0,timeSpent:0}}return t.prototype.getStats=function(){return this.Pi(this.O),this.ki},t.prototype.setState=function(t){t!==this.O&&(this.Li.indexOf(t)<0||(this.Ui(this.O),this.O=t,this.Fi(this.O)))},t.prototype.pause=function(){this.Ui(this.O)},t.prototype.resume=function(){this.Fi(this.O)},t.prototype.dispose=function(){this.pause()},t.prototype.Ui=function(t){t&&(this.Pi(t),this.ki[t].startTimeStamp=null)},t.prototype.Pi=function(t){if(t){var e=this.ki[t],r=Date.now();e.timeSpent+=(r-e.startTimeStamp)/1e3,e.startTimeStamp=r}},t.prototype.Fi=function(t){if(t){var e=this.ki[t];e.count++,e.startTimeStamp=Date.now()}},t}();e.default=a,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(4)),s=n(r(121)),a=n(r(78)),u=n(r(2)),c={ethernet:s.default.WIFI_AND_ETHERNET,cellular:s.default.CELLULAR_AND_OTHERS,bluetooth:s.default.CELLULAR_AND_OTHERS,mixed:s.default.CELLULAR_AND_OTHERS,none:s.default.NONE,wifi:s.default.WIFI_AND_ETHERNET,wimax:s.default.CELLULAR_AND_OTHERS},l=function(){function t(e){var r=this,n=e.eventBus,o=e.environment;(0,i.default)(this,t),this.Bi="",this.xi=function(){var t=void 0;window.navigator.connection&&"string"==typeof window.navigator.connection.type&&(t=c[window.navigator.connection.type]),t=t||r.Vi(),r.Bi!==t&&(r.Bi=t,r.g.emit(u.default.NETWORK_TYPE_CHANGED,t))},this.g=n,this.Hi=o,this.xi(),window.navigator.connection&&window.navigator.connection.addEventListener("change",this.xi)}return t.prototype.dispose=function(){window.navigator.connection&&window.navigator.connection.removeEventListener("change",this.xi)},t.prototype.Vi=function(){var t=this.Hi.getPlatform();return t===a.default.WEB_MOBILE||t===a.default.ANDROID_WEBVIEW?s.default.CELLULAR_AND_OTHERS:s.default.WIFI_AND_ETHERNET},(0,o.default)(t,[{key:"currentType",get:function(){return this.Bi}}]),t}();e.default=l,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(77)),s=function(){function t(e,r,n,s){var a=this;(0,i.default)(this,t),this.Gi=function(t){if(a.qi.playbackErrorCount++,a.T.ENABLE_PLAYBACK_ERROR_LOGGING&&"string"==typeof t&&""!==t){var e=t.substring(0,125);a.zi.notifyError(new Error("Playback error: "+e))}},this.et=e,this.T=r,this.zi=n,this.qi=s,this.et.on(o.default.PLAYBACK_ERROR,this.Gi)}return t.prototype.dispose=function(){this.et.removeListener(o.default.PLAYBACK_ERROR,this.Gi)},t}();e.default=s,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(4)),s=n(r(235)),a=n(r(245)),u=n(r(77)),c=n(r(2)),l=function(){function t(e,r){var n=this,o=e.eventBus,s=e.environment,l=e.configManager;(0,i.default)(this,t),this.hn=null,this.qosAnalytics=null,this.Wi=!1,this.Yi=-1,this.Ki=0,this.Xi=0,this.Qi=function(t){n.qosAnalytics&&t===n.hn?n.qosAnalytics.attach():(n.hn=t,n.Wi&&n.$i())},this.Ji=function(){n.qosAnalytics&&n.qosAnalytics.detach()},this.Zi=function(){n.Wi=!0,n.$i()},this.Pn=function(){n.Yi++},this.te=function(){n.Ki++},this.ne=function(){n.Xi++},this.g=o,this.et=r,this.Si=l,this.Hi=s,this.ie=new a.default,this.et.on(u.default.TRACK_SWITCH,this.Pn),this.et.on(u.default.EMERGENCY_TRACK_SWITCH,this.te),this.et.on(u.default.DROPPED_FRAMES_ABR_CAPPING,this.ne),this.g.on(c.default.MEDIA_ELEMENT_ATTACHED,this.Qi),this.g.on(c.default.MEDIA_ELEMENT_DETACHED,this.Ji),this.g.on(c.default.LOCAL_CONF_UPDATED,this.Zi)}return t.prototype.$i=function(){this.hn&&(this.qosAnalytics&&this.qosAnalytics.dispose(),this.qosAnalytics=new s.default(this.hn,this.Si,this.Hi),this.ie.reset())},t.prototype.getQoSAnalytics=function(){return this.qosAnalytics?this.qosAnalytics.getQoSAnalytics():null},t.prototype.getResourceStats=function(){return this.qosAnalytics?this.qosAnalytics.getResourceStats():null},t.prototype.getBufferedAmount=function(){return this.qosAnalytics?this.qosAnalytics.getBufferedAmount():0},t.prototype.getFormattedQoSAnalytics=function(){if(!this.qosAnalytics)return{};var t=this.qosAnalytics.getQoSAnalytics();return this.ie.format(t,this.Yi,this.Ki,this.Xi)},t.prototype.getPlaybackPosition=function(){return this.hn?this.hn.currentTime:-1},t.prototype.dispose=function(){this.et.removeListener(u.default.EMERGENCY_TRACK_SWITCH,this.te),this.et.removeListener(u.default.DROPPED_FRAMES_ABR_CAPPING,this.ne),this.et.removeListener(u.default.TRACK_SWITCH,this.Pn),this.g.removeListener(c.default.MEDIA_ELEMENT_ATTACHED,this.Qi),this.g.removeListener(c.default.MEDIA_ELEMENT_DETACHED,this.Ji),this.g.removeListener(c.default.LOCAL_CONF_UPDATED,this.Zi),this.hn=null,this.qosAnalytics&&(this.qosAnalytics.dispose(),this.qosAnalytics=null)},(0,o.default)(t,[{key:"mediaElement",get:function(){return this.hn}}]),t}();e.default=l,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(17)),o=n(r(0)),s=n(r(236)),a=n(r(237)),u=n(r(238)),c=n(r(239)),l=n(r(243)),f={ATTACHED:0,DETACHED:1,DISPOSED:2},d=function(){function t(e,r,n){var i=r.conf;(0,o.default)(this,t),this.O=f.ATTACHED,this.L=i.QOS_ANALYTICS,this.ee=new s.default,this.re=new a.default(e,this.ee,this.L),this.Ii=new u.default(this.ee),this.se=this.L.ENABLE_EVENT_LOOP_WATCHER?new c.default(this.L):null,this.oe=new l.default(e,this.Ii,this.L,n)}return t.prototype.getQoSAnalytics=function(){return(0,i.default)({},this.oe.getAnalytics(),this.L.ENABLE_EVENT_LOOP_WATCHER?this.se.getStats():{})},t.prototype.getResourceStats=function(){return(0,i.default)({},this.oe.getResourceStats(),this.L.ENABLE_EVENT_LOOP_WATCHER?this.se.getStats():{})},t.prototype.getEventLoopStats=function(){return this.L.ENABLE_EVENT_LOOP_WATCHER?this.se.getStats():null},t.prototype.getBufferedAmount=function(){return this.oe.getBufferedAmount()},t.prototype.attach=function(){this.O===f.DETACHED&&(this.O=f.ATTACHED,this.re.resume(),this.Ii.resume(),this.oe.resume())},t.prototype.detach=function(){this.O===f.ATTACHED&&(this.O=f.DETACHED,this.re.pause(),this.Ii.pause(),this.oe.pause())},t.prototype.dispose=function(){this.O=f.DISPOSED,this.re.dispose(),this.Ii.dispose(),this.oe.dispose()},t}();e.default=d,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(81)),s=function(){function t(){(0,i.default)(this,t),this.ue=[],this.gotoIdle()}return t.prototype.ce=function(t){var e=this;this.O!==t&&(this.he=this.O,this.O=t,this.ue.forEach(function(t){t(e.O,e.he)}))},t.prototype.gotoIdle=function(){this.ce(o.default.IDLE)},t.prototype.gotoPlaying=function(){this.ce(o.default.PLAYING)},t.prototype.gotoSeeking=function(){this.ce(o.default.SEEKING)},t.prototype.gotoBuffering=function(){this.ce(o.default.BUFFERING)},t.prototype.gotoBufferingWithBuffer=function(){this.ce(o.default.BUFFERING_WITH_BUFFER)},t.prototype.gotoPaused=function(){this.ce(o.default.PAUSED)},t.prototype.gotoEnded=function(){this.ce(o.default.ENDED)},t.prototype.getState=function(){return this.O},t.prototype.addObserver=function(t){this.ue.indexOf(t)<0&&this.ue.push(t)},t.prototype.removeObserver=function(t){var e=this.ue.indexOf(t);e>-1&&this.ue.splice(e,1)},t.prototype.isIdle=function(){return this.O===o.default.IDLE},t.prototype.isPlaying=function(){return this.O===o.default.PLAYING},t.prototype.isSeeking=function(){return this.O===o.default.SEEKING},t.prototype.isBuffering=function(){return this.O===o.default.BUFFERING},t.prototype.isBufferingWithBuffer=function(){return this.O===o.default.BUFFERING_WITH_BUFFER},t.prototype.isPaused=function(){return this.O===o.default.PAUSED},t.prototype.isEnded=function(){return this.O===o.default.ENDED},t}();e.default=s,t.exports=e.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),i=r(7),o=function(){function t(e,r,i){var o=this;(0,n.default)(this,t),this.ae=0,this.fe=!1,this.le=function(){var t=o.de.duration-o.de.currentTime,e=Math.abs(o.de.currentTime-o.ae);isNaN(e)?o.ee.gotoIdle():o.de.seeking?o.ee.gotoSeeking():o.de.paused?o.ee.isIdle()||(!isNaN(t)&&t<o.L.ENDED_TRESHOLD?o.ee.gotoEnded():o.ee.gotoPaused()):e>0?o.ee.gotoPlaying():o.ee.isIdle()||o.ee.isSeeking()||(o.ve()<o.L.BUFFERING_WITH_BUFFER_THRESHOLD?o.ee.gotoBuffering():o.ee.gotoBufferingWithBuffer()),o.ae=o.de.currentTime},this.de=e,this.ee=r,this.L=i,this.resume()}return t.prototype.dispose=function(){this.pause()},t.prototype.pause=function(){this.we.clear()},t.prototype.resume=function(){this.we=(0,i.createInterval)(this.le,this.L.TICK_INTERVAL)},t.prototype.ve=function(){for(var t=this.de.currentTime,e=this.de.buffered,r=0;r<e.length;r++)if(e.start(r)<=t&&t<=e.end(r))return e.end(r)-t;return 0},t}();e.default=o,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(21)),o=n(r(0)),s=n(r(81)),a=function(){function t(e){(0,o.default)(this,t),this.ee=e,this.ki={};for(var r=(0,i.default)(s.default),n=0;n<r.length;n++)this.ki[s.default[r[n]]]={count:0,timeSpent:0};this.resume(),this.pe=this.be.bind(this),this.ee.addObserver(this.pe)}return t.prototype.getStats=function(){return this.me&&this.Pi(this.ee.getState()),this.ki},t.prototype.pause=function(){this.me=!1,this.Ui(this.ee.getState())},t.prototype.resume=function(){this.me=!0,this.Fi(this.ee.getState())},t.prototype.dispose=function(){this.pause(),this.ee.removeObserver(this.pe)},t.prototype.be=function(t,e){this.Ui(e),this.Fi(t)},t.prototype.Ui=function(t){this.Pi(t),this.ki[t].startTimeStamp=null},t.prototype.Pi=function(t){var e=this.ki[t],r=Date.now();e.timeSpent+=(r-e.startTimeStamp)/1e3,e.startTimeStamp=r},t.prototype.Fi=function(t){var e=this.ki[t];e.count++,e.startTimeStamp=Date.now()},t}();e.default=a,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(240)),s=r(24),a=r(7),u=(r(242),function(){function t(e){(0,i.default)(this,t),this.L=e,this.Ee=new o.default(this.L.EVENT_LOOP_MEMORY),this._e=new o.default(this.L.EVENT_LOOP_MEMORY),this.ye=new o.default(this.L.EVENT_LOOP_MEMORY),this.fe=!1,this.ge=null,this.Te=null,this.resume()}return t.prototype.dispose=function(){this.pause()},t.prototype.pause=function(){this.fe&&(this.ge&&(this.ge.clear(),this.ge=null),this.Te&&(window.cancelAnimationFrame(this.Te),this.Te=null),this.fe=!1)},t.prototype.resume=function(){this.fe||(this.Oe(),this.fe=!0)},t.prototype.Oe=function(){var t=Math.floor(this.L.EVENT_LOOP_DELAY_MIN+Math.random()*(this.L.EVENT_LOOP_DELAY_MAX-this.L.EVENT_LOOP_DELAY_MIN)),e=performance.now()+t;this.Me(t,e),this.Se(),this.Ae(),this.L.ENABLE_EVENT_LOOP_PROACTIVE_STATS&&this.getStats()},t.prototype.Me=function(t,e){var r=this;this.ge&&this.ge.clear(),this.ge=(0,a.createTimeout)(function(){r.Ee.addPoint(Math.max(performance.now()-e,0)),r.ge=null,r.Oe()},t)},t.prototype.Se=function(){var t=this;window.requestAnimationFrame&&window.cancelAnimationFrame&&(this.Te&&window.cancelAnimationFrame(this.Te),this.Te=window.requestAnimationFrame(function(){var e=performance.now();t.Te=window.requestAnimationFrame(function(){t._e.addPoint(performance.now()-e),t.Te=null})}))},t.prototype.Ae=function(){this.ye.addPoint(Number(document.hidden))},t.prototype.getStats=function(){return{eventLoopDelay:this.Ee.computeP10P50P90Max().map(function(t){return Math.round(t)}),animationFrameInterval:this._e.computeP10P50P90Max().map(function(t){return Math.round(t)}),hiddenRatio:(0,s.toDecimal)(this.ye.computeAverage(),3)}},t}());e.default=u,t.exports=e.default},function(t,e,r){"use strict";function n(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return r;return-1}Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(r(241)),o=r(24),s=function(t){var e=this,r=[],s=[],a=t,u=function(){var t=Date.now(),e=n(r,function(e){return e.timestamp()>=t-a});-1===e?(r.length=0,s.length=0):e>0&&(r.splice(0,e),s.length=0)},c=function(t,e){return u(),isNaN(s[e])?(s[e]=t(),s[e]):s[e]},l=function(t){u();var e=new i.default(t);r.push(e),s.length=0},f=function(){var t=d();return r.length?t/r.length:0},d=function(){for(var t=0,e=0;e<r.length;e++)t+=r[e].value();return t},h=function(){return r.length?r.map(function(t){return t.value()}).reduce(function(t,e){return Math.max(t,e)},Number.MIN_VALUE):0},p=function(){return r.length?r.map(function(t){return t.value()}).reduce(function(t,e){return Math.min(t,e)},Number.MAX_VALUE):0},v=function(t){var e=r.sort(function(t,e){return t.value()-e.value()}),n=e.length;return n?t.map(function(t){return(0,o.clamp)(Math.round(t/100*(n-1)),0,n-1)}).map(function(t){return e[t].value()}):t.map(function(){return 0})};this.addPoint=l,this.computeAverage=function(){return c(f,0)},this.computeSum=function(){return c(d,1)},this.computeMax=function(){return c(h,2)},this.computeMin=function(){return c(p,3)},this.computeMed=function(){return c(function(){return v([50])[0]},4)},this.computeP10P50P90Max=function(){var t=c(function(){return v([10,50,90])});return t.push(e.computeMax()),t}};e.default=s,t.exports=e.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){var e=t,r=Date.now();this.timestamp=function(){return r},this.value=function(){return e}};e.default=n,t.exports=e.default},function(t,e,r){},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(81)),s=n(r(244)),a=r(7),u=r(122),c=function(){function t(e,r,n,o){var a=this;(0,i.default)(this,t),this.Re=0,this.Ne=0,this.Ce=function(){a.Ne=(0,u.getBufferedAmount)(a.de),a.De.updateMetric(a.Ne)},this.de=e,this.Ii=r,this.L=n;var c=o.getJavaScriptEngine();this.Ie="Safari"===c.name||"Mobile Safari"===c.name,this.De=new s.default,this.resume()}return t.prototype.resume=function(){this.pause(),this.je=(0,a.createInterval)(this.Ce,this.L.BUFFER_HEALTH_AVERAGE_UPDATE_INTERVAL)},t.prototype.ke=function(){if(this.Ie)return 0;var t=0;return(t=this.de.getVideoPlaybackQuality?this.de.getVideoPlaybackQuality().droppedVideoFrames||0:this.de.webkitDroppedFrameCount||this.de.droppedFrameCount||0)>0&&(this.Re=t),this.Re},t.prototype.getResourceStats=function(){var t=this.Ii.getStats();return{droppedFrameCount:this.ke(),timeSpentRebufferingWithBuffer:t[o.default.BUFFERING_WITH_BUFFER].timeSpent}},t.prototype.getAnalytics=function(){var t=this.Ii.getStats(),e=this.ke(),r=this.De.getAverage();return{bufferHealth:this.Ne,averageBufferHealth:r,droppedFrameCount:e,timeSpentIdle:t[o.default.IDLE].timeSpent,timeSpentPlaying:t[o.default.PLAYING].timeSpent,timeSpentPaused:t[o.default.PAUSED].timeSpent,timeSpentSeeking:t[o.default.SEEKING].timeSpent,timeSpentEnded:t[o.default.ENDED].timeSpent,rebufferingCount:t[o.default.BUFFERING].count,timeSpentRebuffering:t[o.default.BUFFERING].timeSpent,rebufferingCountWithBuffer:t[o.default.BUFFERING_WITH_BUFFER].count,timeSpentRebufferingWithBuffer:t[o.default.BUFFERING_WITH_BUFFER].timeSpent}},t.prototype.getBufferedAmount=function(){return this.Ne=(0,u.getBufferedAmount)(this.de),this.Ne},t.prototype.pause=function(){this.je&&this.je.clear()},t.prototype.dispose=function(){this.pause()},t}();e.default=c,t.exports=e.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),i=r(42),o=function(){function t(){(0,n.default)(this,t);var e=Date.now();this.Le=0,this.Pe=0,this.Ue=new i.Delta(e),this.Fe=new i.Delta(e)}return t.prototype.getAverage=function(){var t=this.getIntegral();return t.intervalLength?t.value/t.intervalLength:t.value},t.prototype.getIntegral=function(){var t=Date.now(),e=this.Ue.calcDelta(t),r=this.Fe.calcDelta(t);this.Le+=this.Pe*e;var n=this.Le;return this.Le=0,{value:n,intervalLength:r}},t.prototype.updateMetric=function(t){var e=Date.now(),r=this.Ue.calcDelta(e);this.Le+=this.Pe*r,this.Pe=t},t}();e.default=o,t.exports=e.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),i=r(42),o=r(24),s=function(){function t(){(0,n.default)(this,t),this.reset()}return t.prototype.reset=function(){this.Be=new i.Delta,this.xe=new i.Delta,this.Ve=new i.Delta,this.He=new i.Delta,this.Ge=new i.Delta,this.qe=new i.Delta,this.ze=new i.Delta,this.We=new i.Delta,this.Ye=new i.Delta,this.Ke=new i.Delta(Date.now()),this.Xe=new i.Delta,this.Qe=new i.Delta,this.$e=new i.Delta,this.Je=new i.Delta},t.prototype.Ze=function(t,e,r,n,i,s){var a=this.Ke.calcDelta(Date.now()),u=this.We.calcDelta(t)/(a/6e4),c=this.Ye.calcDelta(e)/(a/6e4),l=this.Xe.calcDelta(r)/(a/6e4),f=this.Qe.calcDelta(n)/(a/6e4),d=this.$e.calcDelta(i)/(a/6e4),h=this.Je.calcDelta(s)/(a/6e4);return{rebufferingCPM:(0,o.toDecimal)(u,2),rebufferingWithBufferCPM:(0,o.toDecimal)(c,2),droppedFrameCPM:(0,o.toDecimal)(l,2),trackSwitchCPM:(0,o.toDecimal)(f,2),emergencyTrackSwitchCPM:(0,o.toDecimal)(d,2),droppedFramesAbrCappingCPM:(0,o.toDecimal)(h,2)}},t.prototype.format=function(t,e,r,n){t.droppedFrameCount<this.Xe.lastValue&&this.Xe.override(t.droppedFrameCount);var i=this.Ze(t.rebufferingCount,t.rebufferingCountWithBuffer,t.droppedFrameCount,e,r,n);return{rebufferingCPM:i.rebufferingCPM,rebufferingWithBufferCPM:i.rebufferingWithBufferCPM,droppedFrameCPM:i.droppedFrameCPM,trackSwitchCPM:i.trackSwitchCPM,emergencyTrackSwitchCPM:i.emergencyTrackSwitchCPM,droppedFramesAbrCappingCPM:i.droppedFramesAbrCappingCPM,timeSpentIdle:(0,o.toDecimal)(this.Be.calcDelta(t.timeSpentIdle),2),timeSpentPlaying:(0,o.toDecimal)(this.xe.calcDelta(t.timeSpentPlaying),2),timeSpentPaused:(0,o.toDecimal)(this.Ve.calcDelta(t.timeSpentPaused),2),timeSpentEnded:(0,o.toDecimal)(this.ze.calcDelta(t.timeSpentEnded),2),timeSpentRebuffering:(0,o.toDecimal)(this.He.calcDelta(t.timeSpentRebuffering),2),timeSpentRebufferingWithBuffer:(0,o.toDecimal)(this.Ge.calcDelta(t.timeSpentRebufferingWithBuffer),2),timeSpentSeeking:(0,o.toDecimal)(this.qe.calcDelta(t.timeSpentSeeking),2),startupTime:t.startupTime,endedOnce:t.endedOnce,sampledBufferHealth:(0,o.toDecimal)(t.bufferHealth,1),averageBufferHealth:(0,o.toDecimal)(t.averageBufferHealth,1),eventLoopDelay:t.eventLoopDelay,animationFrameInterval:t.animationFrameInterval,hiddenRatio:t.hiddenRatio}},t}();e.default=s,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(50)),s=n(r(2)),a=/<MPD/,u=/type="dynamic"/,c=/#EXTM3U[\s\S]+?#EXT-X-STREAM-INF/,l=/#EXTM3U[\s\S]+?#EXTINF/,f=/#EXT-X-ENDLIST/,d=/<SmoothStreamingMedia/,h=/IsLive="TRUE"/,p=function(){function t(e){(0,i.default)(this,t),this.tr=!1,this.contentUrl=null,this.streamType=null,this.isLive=null,this.g=e,this.clear()}return t.prototype.processManifest=function(t,e){null==this.streamType&&(a.test(t)?(this.streamType=o.default.DASH,this.contentUrl=e,this.isLive=u.test(t)):d.test(t)?(this.streamType=o.default.SMOOTH,this.contentUrl=e,this.isLive=h.test(t)):c.test(t)?(this.streamType=o.default.HLS,this.contentUrl=e):l.test(t)&&(this.streamType=o.default.HLS,this.contentUrl=e,this.isLive=!f.test(t))),this.streamType===o.default.HLS&&null==this.isLive&&l.test(t)&&(this.isLive=!f.test(t)),this.tr||null==this.contentUrl||null==this.streamType||(this.g.emit(s.default.STREAM_IDENTIFIED,{contentUrl:this.contentUrl,streamType:this.streamType}),this.tr=!0)},t.prototype.clear=function(){this.contentUrl=null,this.streamType=null,this.isLive=null,this.tr=!1},t}();e.default=p,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=(n(r(111)),n(r(248))),s=n(r(249)),a=n(r(250)),u=n(r(2)),c=n(r(123)),l=r(253),f=function(){function t(e){var r=this;(0,i.default)(this,t),this.nr=null,this.ir=null,this.er=function(t){r.j.configManager.setAz(t),r.nr?r.j.eventBus.emit(u.default.BACKEND_URLS_CHANGED):(r.nr=new s.default(r.j),r.nr.call())},this.rr=function(t){t.activateMesh=null!=t.activateMesh?t.activateMesh:!t.bypassed,t.activateMesh=(0,l.isP2PEnabled)(r.j.environment)&&t.activateMesh,r.j.configManager.setDistributorResponse(t),r.j.configManager.isContentActivated()||r.j.configManager.isCompassPropertyActivated()?r.nr&&r.nr.fetchInjectedConf(c.default.STREAMROOTER,"1.23.0"):r.j.eventBus.emit(u.default.DISTRIBUTOR_ANSWER_HANDLED)},this.jn=function(t){t[c.default.STREAMROOTER]&&(r.j.configManager.injectConf(t[c.default.STREAMROOTER].config,r.j.errorFunnel),r.j.eventBus.emit(u.default.LOCAL_CONF_UPDATED))},this.Zi=function(){var t=r.j.configManager.getPropertyParameters(),e=t.subnetMatching,n=t.subnetMatchingMap,i=t.subnetMatchingMask,o=r.j.configManager.getDnaConfig().siteId;null!=o&&""!==o?r.j.eventBus.emit(u.default.SUBNET_MATCHER_ANSWERED,{siteId:o,dnaEnabled:!0}):!0===e||!0===n||!0===i?(r.ir||(r.ir=new a.default(r.j)),r.ir.call()):r.j.eventBus.emit(u.default.DISTRIBUTOR_ANSWER_HANDLED)},this.sr=function(t){r.j.configManager.setSiteId(t),r.j.eventBus.emit(u.default.DISTRIBUTOR_ANSWER_HANDLED)},this.or=function(){var t=r.j.configManager.getVersions().peerAgentVersion;r.nr&&r.nr.fetchInjectedConf(c.default.PEERAGENT,t)},this.ur=function(){var t=r.j.configManager.getVersions().compassVersion;r.nr&&r.nr.fetchInjectedConf(c.default.COMPASS,t)},this.j=e,this.cr=new o.default(e),this.j.eventBus.on(u.default.ROUTER_AZ_CHANGED,this.er),this.j.eventBus.on(u.default.DISTRIBUTOR_ANSWERED,this.rr),this.j.eventBus.on(u.default.MODULE_CONF_INJECTED,this.jn),this.j.eventBus.on(u.default.LOCAL_CONF_UPDATED,this.Zi),this.j.eventBus.on(u.default.SUBNET_MATCHER_ANSWERED,this.sr),this.j.eventBus.on(u.default.MEDIA_MAP_PROCESSED,this.or),this.j.eventBus.on(u.default.COMPASS_LOADED,this.ur)}return t.prototype.dispose=function(){this.j.eventBus.removeListener(u.default.ROUTER_AZ_CHANGED,this.er),this.j.eventBus.removeListener(u.default.DISTRIBUTOR_ANSWERED,this.rr),this.j.eventBus.removeListener(u.default.MODULE_CONF_INJECTED,this.jn),this.j.eventBus.removeListener(u.default.LOCAL_CONF_UPDATED,this.Zi),this.j.eventBus.removeListener(u.default.SUBNET_MATCHER_ANSWERED,this.sr),this.j.eventBus.removeListener(u.default.MEDIA_MAP_PROCESSED,this.or),this.j.eventBus.removeListener(u.default.COMPASS_LOADED,this.ur),this.nr&&this.nr.dispose(),this.ir&&this.ir.dispose(),this.cr.dispose()},t.prototype.call=function(){this.cr.call()},t}();e.default=f,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(16)),o=n(r(0)),s=n(r(4)),a=(n(r(53)),n(r(2))),u=n(r(23)),c=(n(r(55)),r(7)),l=function(){function t(e){var r=this,n=e.eventBus,s=e.configManager,c=e.httpRequestFactory,l=e.costStats,f=e.backendStats,d=e.errorFunnel;(0,o.default)(this,t),this.xt=null,this.hr=function(){r.ar&&r.ar.abort();var t={streamrootKey:r.Si.getStreamrootKey(),content:r.Si.getContentId()},e={timeout:r.Si.conf.REQUEST_RETRY.ROUTER.TIMEOUT,headers:{"Content-Type":"application/json"}},n=(0,i.default)(t),o=r.Si.conf.REQUEST_RETRY.ROUTER,s=r.Si.getRouterUrl(),c=function(t){r.lr.routerErrors.increment(t)};r.dr.routerRequestsCount++,r.dr.routerRequestsVolume+=n.length,r.ar=r.vr.getRequest(u.default.Methods.POST,s,e,o),r.ar.isStreamroot=!0,r.ar.send(n,c).then(function(t){r.ar=null,r.dr.routerResponsesVolume+=(0,i.default)(t).length,r.xt!==t.path&&(r.xt&&r.lr.azChanges++,r.xt=t.path,r.g.emit(a.default.ROUTER_AZ_CHANGED,r.xt)),r.wr()}).catch(function(t){r.ar=null,r.zi.notify("Request to router failed",t.status+" "+t.message,"error")})},this.Zi=function(){r.Si.conf.ROUTER_POLL_INTERVAL!==r.pr&&(r.pr=r.Si.conf.ROUTER_POLL_INTERVAL,r.wr())},this.g=n,this.Si=s,this.vr=c,this.dr=l,this.lr=f,this.zi=d,this.pr=s.conf.ROUTER_POLL_INTERVAL,this.g.on(a.default.LOCAL_CONF_UPDATED,this.Zi)}return t.prototype.dispose=function(){this.br&&(this.br.clear(),this.br=null),this.ar&&(this.ar.abort(),this.ar=null),this.g.removeListener(a.default.LOCAL_CONF_UPDATED,this.Zi)},t.prototype.call=function(){this.hr()},t.prototype.wr=function(){this.br&&this.br.clear(),this.br=(0,c.createTimeout)(this.hr,this.pr)},(0,s.default)(t,[{key:"az",get:function(){return this.xt}}]),t}();e.default=l,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(84)),o=n(r(16)),s=n(r(29)),a=n(r(48)),u=n(r(0)),c=(n(r(53)),n(r(2))),l=n(r(23)),f=(n(r(55)),function(){function t(e){var r=e.eventBus,n=e.configManager,i=e.environment,o=e.httpRequestFactory,s=e.costStats,c=e.backendStats,l=e.errorFunnel;(0,u.default)(this,t),this.ar=null,this.mr=new a.default,this.g=r,this.Si=n,this.Hi=i,this.vr=o,this.dr=s,this.lr=c,this.zi=l}return t.prototype.dispose=function(){this.ar&&(this.ar.abort(),this.ar=null);var t=!0,e=!1,r=void 0;try{for(var n,i=(0,s.default)(this.mr.values());!(t=(n=i.next()).done);t=!0)n.value.abort()}catch(t){e=!0,r=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw r}}this.mr.clear()},t.prototype.call=function(){var t=this;this.ar&&this.ar.abort();var e=this.Si.getDistributorUrl()+"v1/config/web",r=this.Si.getVersions().integrationTag,n={streamrootKey:this.Si.getStreamrootKey(),content:this.Si.getContentId(),defaultContentId:this.Si.getDefaultContentId(),property:this.Si.getProperty(),compassProperty:this.Si.getCompassProperty(),deviceInfo:{platform:this.Hi.getPlatform(),browserName:this.Hi.getBrowserName(),browserVersion:this.Hi.getBrowserVersion(),os:this.Hi.getOperatingSystemName(),osVersion:this.Hi.getOperatingSystemVersion(),integrationTag:r}},i={timeout:this.Si.conf.REQUEST_RETRY.DISTRIBUTOR.TIMEOUT,headers:{"Content-Type":"application/json"}},s=(0,o.default)(n),a=this.Si.conf.REQUEST_RETRY.DISTRIBUTOR,u=function(e){t.lr.distributorErrors.increment(e)};this.dr.distributorRequestsCount++,this.dr.distributorRequestsVolume+=s.length,this.ar=this.vr.getRequest(l.default.Methods.POST,e,i,a),this.ar.isStreamroot=!0,this.ar.send(s,u).then(function(e){t.ar=null,t.dr.distributorResponsesVolume+=(0,o.default)(e).length,t.g.emit(c.default.DISTRIBUTOR_ANSWERED,e)}).catch(function(e){t.ar=null,t.zi.notify("Injected conf request to distributor failed",e.status+" "+e.message,"error")})},t.prototype.fetchInjectedConf=function(t,e){var r=this,n=this.mr.get(t);n&&n.abort();var s=this.Si.getDistributorUrl()+"v1/injectedConf2",a={streamrootKey:this.Si.getStreamrootKey(),deviceFamily:this.Hi.getPlatform(),modules:(0,i.default)({},t,e),device:"unknown",content:this.Si.getContentId(),property:this.Si.getProperty()},u={timeout:this.Si.conf.REQUEST_RETRY.DISTRIBUTOR.TIMEOUT,headers:{}};u.headers["Content-Type"]="application/json";var f=this.Si.getBackendToken();f&&(u.headers.Authorization="Bearer "+f);var d=(0,o.default)(a),h=this.Si.conf.REQUEST_RETRY.DISTRIBUTOR;this.dr.distributorRequestsCount++,this.dr.distributorRequestsVolume+=d.length;var p=this.vr.getRequest(l.default.Methods.POST,s,u,h);p.isStreamroot=!0,p.send(d).then(function(e){r.mr.delete(t),r.dr.distributorResponsesVolume+=(0,o.default)(e).length,r.g.emit(c.default.MODULE_CONF_INJECTED,e)}).catch(function(e){r.mr.delete(t),r.zi.notify("Injected conf request to distributor failed",e.status+" "+e.message,"error")}),this.mr.set(t,p)},t}());e.default=f,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){return t.some(function(t){return-1!==t.indexOf(".local")})}function o(t,e,r){return((t>>>r|t<<32-r)^e)>>>0}function s(t){var e=o(t,302416016,23);return e=o(e,301181029,17),o(e,3162950659,19)}Object.defineProperty(e,"__esModule",{value:!0});var a=n(r(16)),u=n(r(0)),c=n(r(2)),l=n(r(23)),f=r(251),d=r(252),h=function(){function t(e){var r=this;(0,u.default)(this,t),this.ar=null,this.Er=function(t){i(t)?navigator.mediaDevices&&r.j.configManager.conf.ENABLE_GET_USER_MEDIA_REQUEST?navigator.mediaDevices.getUserMedia({audio:!0}).then(function(){r._r()}).catch(function(t){"NotReadableError"===t.name?r._r():r.yr([])}):r.yr([]):r.yr(t)},this.gr=function(t){i(t)?r.yr([]):r.yr(t)},this.j=e}return t.prototype.dispose=function(){this.ar&&(this.ar.abort(),this.ar=null)},t.prototype._r=function(){(0,f.getLocalAddresses)(this.gr)},t.prototype.Tr=function(){this.j.eventBus.emit(c.default.SUBNET_MATCHER_ANSWERED,{siteId:"unknownSiteId"})},t.prototype.call=function(){var t=this.j.configManager.getDnaConfig().privateIPAddress;t?this.gr([t]):(0,f.getLocalAddresses)(this.Er)},t.prototype.yr=function(t){var e=this.j.configManager.getPropertyParameters(),r=e.subnetMatching,n=e.subnetMatchingMap,i=e.subnetMatchingMask;!0===r||!0===n?this.hr(t):!0===i?this.Or(t):this.Tr()},t.prototype.Or=function(t){var e=this.j.configManager.getPropertyParameters(),r=e.subnetMatchingMask,n=e.subnetMask;if(!0===r&&null!=n&&t.length>=1){var i=(0,d.ipv4ToInt32)(t[0]);if(0!==i){var o=s((0,d.maskInt32)(i,n)).toString(16);return void this.j.eventBus.emit(c.default.SUBNET_MATCHER_ANSWERED,{siteId:o,dnaEnabled:!0})}}this.Tr()},t.prototype.hr=function(t){var e=this;this.ar&&this.ar.abort();var r=this.j,n=r.configManager,i=r.backendStats,o=r.costStats,s=r.httpRequestFactory,u=r.eventBus,f=r.errorFunnel,d=n.getSubnetMatcherUrl(),h={srKey:n.getStreamrootKey(),privateIPAddresses:t},p={timeout:n.conf.REQUEST_RETRY.SUBNET_MATCHER.TIMEOUT,headers:{}};p.headers["Content-Type"]="application/json";var v=n.getBackendToken();v&&(p.headers.Authorization="Bearer "+v);var g=(0,a.default)(h),y=n.conf.REQUEST_RETRY.SUBNET_MATCHER,m=function(t){i.subnetMatcherErrors.increment(t)};o.distributorRequestsCount++,o.distributorRequestsVolume+=g.length,this.ar=s.getRequest(l.default.Methods.POST,d,p,y),this.ar.isStreamroot=!0,this.ar.send(g,m).then(function(r){e.ar=null,o.subnetMatcherResponsesVolume+=(0,a.default)(r).length,"unknownSiteId"===r.siteId?e.Or(t):u.emit(c.default.SUBNET_MATCHER_ANSWERED,r)}).catch(function(r){e.ar=null,f.notify("Request to subnet matcher failed",r.status+" "+r.message,"error"),e.Or(t)})},t}();e.default=h,t.exports=e.default},function(t,e,r){"use strict";function n(t){var e=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(e&&e.prototype.createDataChannel){var r=new e({iceServers:[]}),n=[],i=/[0-9]{1,3}(?:\.[0-9]{1,3}){3}/g,o=/([0-9a-fA-F-]{36})\.local/g;r.onicecandidate=function(e){if(e.candidate){var s=i.exec(e.candidate.candidate);s&&n.push(s[0]),(s=o.exec(e.candidate.candidate))&&n.push(s[0])}else r.close(),t(n)},r.onnegotiationneeded=function(){try{r.createOffer().then(function(t){return r.setLocalDescription(t)}).catch(function(){r.close(),t([])})}catch(e){r.close(),t([])}},r.createDataChannel("dummy")}else t([])}Object.defineProperty(e,"__esModule",{value:!0}),e.getLocalAddresses=n},function(t,e,r){"use strict";function n(t){var e=t.split(".").map(function(t){return parseInt(t,10)});return 4!==e.length||e.some(function(t){return t>255||t<0})?0:e.reduceRight(function(t,e,r){return t+e*a[r]>>>0})}function i(t){if(t<a[0])return"0.0.0.0";for(var e=(t%a[2]).toString(10),r=Math.floor(t/a[2]);r>0;)e=(r%a[2]).toString(10)+"."+e,r=Math.floor(r/a[2]);return e}function o(t,e){return e<=0?0:e>32?t:(t&~((Math.pow(2,32-e)>>>0)-1)>>>0)>>>0}function s(t,e){return i(o(n(t),e))}Object.defineProperty(e,"__esModule",{value:!0}),e.ipv4ToInt32=n,e.int32ToIpv4=i,e.maskInt32=o,e.maskIpv4=s;var a=[Math.pow(2,24),Math.pow(2,16),Math.pow(2,8),Math.pow(2,0)]},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){return t.getPlatform()===a.default.UNKNOWN}function o(){var t=window.RTCPeerConnection||window.webkitPeerConnection00||window.webkitRTCPeerConnection;return!!(t&&t.prototype&&t.prototype.createDataChannel)}function s(t){return!!o()&&!i(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.isP2PEnabled=e.isP2PAvailable=void 0;var a=(n(r(115)),n(r(78)));e.isP2PAvailable=o,e.isP2PEnabled=s},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){for(var e=t.split("."),r=0,n=0;n<e.length;n++)r+=(0,a.default)(e[n],10)*(l[n]||0);return r}function o(t){var e=(0,c.extractVersionFromRepoPath)(t);return!(e&&i(e[2])<f)}Object.defineProperty(e,"__esModule",{value:!0});var s=n(r(0)),a=n(r(255)),u=n(r(2)),c=r(114),l=[1e7,1e4,1],f=i("5.24.0"),d=function(){function t(e){var r=this,n=e.eventBus,i=e.errorFunnel,o=e.configManager,a=e.moduleManager;(0,s.default)(this,t),this.Mr=function(t){var e=new t;if(isNaN(e.interfaceVersion)||e.interfaceVersion!==r.Si.conf.REQUIRED_DNA_INTERFACE_VERSION)throw new Error("DNA Client bundle has an incompatible interface version. Loader="+r.Si.conf.REQUIRED_DNA_INTERFACE_VERSION+" Client="+e.interfaceVersion);r.g.emit(u.default.DNA_CLIENT_LOADED,e)},this.g=n,this.zi=i,this.Si=o,this.Sr=a}return t.prototype.load=function(){var t=this,e=this.Si.getBaseRepoUrl();this.Sr.configure({baseRemoteRepoPath:e});var r=o(e)?"peer-agent":"dna-client";this.Sr.require(r).then(this.Mr).catch(function(e){t.zi.notifyError(e)})},t.prototype.dispose=function(){},t}();e.default=d,t.exports=e.default},function(t,e,r){t.exports={default:r(256),__esModule:!0}},function(t,e,r){r(257),t.exports=r(1).Number.parseInt},function(t,e,r){var n=r(3),i=r(258);n(n.S+n.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,e,r){var n=r(5).parseInt,i=r(259).trim,o=r(124),s=/^[-+]?0[xX]/;t.exports=8!==n(o+"08")||22!==n(o+"0x16")?function(t,e){var r=i(String(t),3);return n(r,e>>>0||(s.test(r)?16:10))}:n},function(t,e,r){var n=r(3),i=r(43),o=r(15),s=r(124),a="["+s+"]",u="âÂ",c=RegExp("^"+a+a+"*"),l=RegExp(a+a+"*$"),f=function(t,e,r){var i={},a=o(function(){return!!s[t]()||u[t]()!=u}),c=i[t]=a?e(d):s[t];r&&(i[r]=c),n(n.P+n.F*a,"String",i)},d=f.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(l,"")),t};t.exports=f},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),i=function(){function t(){(0,n.default)(this,t),this.Ar=0,this.Rr=0,this.Nr=0}return t.prototype.Cr=function(t){return{dnaDownload:this.Ar+t.p2p,cdnDownload:this.Rr+t.cdn,dnaUpload:this.Nr+t.upload}},t.prototype.Dr=function(t){return{dnaDownload:t.p2p,cdnDownload:t.cdn,dnaUpload:t.upload}},t.prototype.Ir=function(t){return{dnaSources:t.peers}},t.prototype.incrementHistorical=function(t){this.Ar+=t.p2p,this.Rr+=t.cdn,this.Nr+=t.upload},t.prototype.get=function(t){return{allContents:this.Cr(t),currentContent:this.Dr(t),realtime:this.Ir(t)}},t}();e.default=i,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=(n(r(120)),function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,i.default)(this,t),this.p2p=0,this.cdn=0,this.upload=0,this.peers=0,this.confLabel="",e&&(this.cdn=e.cdnDownloaded)});e.default=o,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(125)),s=n(r(263)),a=n(r(268)),u=n(r(269)),c=n(r(270)),l=n(r(271)),f=n(r(2)),d=r(7),h=function(){function t(e){var r=this;(0,i.default)(this,t),this.jr=[],this.kr=null,this.Lr=!1,this.Pr=0,this.Ur=0,this.Fr=function(){r.Lr=!0},this.Br=function(){r.Lr=!1},this.xr=function(){++r.Ur===r.Si.conf.ANALYTICS.REQUESTED_SEGMENTS_COUNT_TO_SEND_CONFIG&&r.sendSupportPayload()},this.Vr=function(){r.Lr||r.Hr("traffic","traffic-v2")},this.Gr=function(){r.Hr("stats","stats")},this.qr=function(){r.Hr("control","stats/control")},this.zr=function(){r.Hr("connections","stats/connections")},this.g=e.eventBus,this.Si=e.configManager,this.Wr=new s.default(e),this.Yr=new a.default(e),this.Kr=new u.default(e,this.Yr,this.jr),this.Xr=new l.default,this.Si.isLive()&&(this.kr=new c.default(e.eventBus,e.qosAnalyticsHandler.mediaElement)),this.g.on(f.default.STOP_REPORTING_TRAFFIC,this.Fr),this.g.on(f.default.RESTART_REPORTING_TRAFFIC,this.Br),this.g.on(f.default.MEDIA_SEGMENT_REQUESTED,this.xr),this.ai()}return t.prototype.attachProvider=function(t){t&&-1===this.jr.indexOf(t)&&this.jr.push(t)},t.prototype.sendSupportPayload=function(){this.Kr.sendPayload()},t.prototype.detachProvider=function(t){if(t){var e=this.jr.indexOf(t);e>-1&&this.jr.splice(e,1)}},t.prototype.ai=function(){(this.Si.isContentActivated()||this.Si.isCompassRampUpActivated())&&(this.Si.conf.ANALYTICS.ENABLE_STATS_SENDER&&this.Qr(),this.Si.conf.ANALYTICS.ENABLE_CONTROL_SENDER&&this.$r(),this.Si.conf.ANALYTICS.ENABLE_CONNECTIONS_SENDER&&this.Jr(),(this.Si.isRampUpActivated()||this.Si.isCompassRampUpActivated())&&(this.Zr(),this.g.on(f.default.MEDIA_ENDED,this.Vr),window.addEventListener("beforeunload",this.Vr)),this.attachProvider(this.Wr))},t.prototype.dispose=function(){this.Xr.clearAll(),this.kr&&this.kr.dispose(),this.g.removeListener(f.default.STOP_REPORTING_TRAFFIC,this.Fr),this.g.removeListener(f.default.RESTART_REPORTING_TRAFFIC,this.Br),this.g.removeListener(f.default.MEDIA_SEGMENT_FETCHED,this.xr),this.g.removeListener(f.default.MEDIA_ENDED,this.Vr),window.removeEventListener("beforeunload",this.Vr)},t.prototype.Zr=function(){var t=this;if(this.Pr<this.Si.conf.ANALYTICS.TRAFFIC_INTERVAL_ARRAY.length-1){var e=(0,d.createTimeout)(function(){t.Vr(),t.Zr()},this.Si.conf.ANALYTICS.TRAFFIC_INTERVAL_ARRAY[this.Pr]);this.Xr.register(e),this.Pr++}else{var r=this.Si.conf.ANALYTICS.TRAFFIC_INTERVAL_ARRAY[this.Si.conf.ANALYTICS.TRAFFIC_INTERVAL_ARRAY.length-1],n=(0,d.createInterval)(this.Vr,r);this.Xr.register(n)}},t.prototype.Qr=function(){var t=(0,d.createInterval)(this.Gr,this.Si.conf.ANALYTICS.STATS_INTERVAL);this.Xr.register(t)},t.prototype.$r=function(){var t=(0,d.createInterval)(this.qr,this.Si.conf.ANALYTICS.CONTROL_INTERVAL);this.Xr.register(t)},t.prototype.Jr=function(){var t=(0,d.createInterval)(this.zr,this.Si.conf.ANALYTICS.CONNECTIONS_INTERVAL);this.Xr.register(t)},t.prototype.Hr=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(0!==this.jr.length){var r=this.jr.reduce(function(e,r){return(0,o.default)(e,r.getAnalytics(t))},{});this.Yr.send(r,e)}},t}();e.default=h,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(264)),s=n(r(265)),a=n(r(266)),u=n(r(267)),c=function(){function t(e){(0,i.default)(this,t),this.ns=new o.default(e),this.es=new s.default(e),this.rs=new a.default(e),this.ss=new u.default(e)}return t.prototype.dispose=function(){},t.prototype.getAnalytics=function(t){return this.us(t)},t.prototype.us=function(t){switch(t){case"traffic":return this.ns.calculatePayload();case"stats":return this.es.calculatePayload();case"control":return this.rs.calculatePayload();case"support":return this.ss.calculatePayload();default:return{}}},t}();e.default=c,t.exports=e.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),i=r(42),o=function(){function t(e){var r=e.configManager,o=e.transferStats,s=e.bitrateStats,a=e.qosAnalyticsHandler;(0,n.default)(this,t),this.cs=new i.Delta,this.hs=new i.Delta,this.Zt=new i.Delta,this.tn=new i.Delta,this.as=new i.Delta,this.fs=new i.Delta,this.ls=new i.Delta,this.Si=r,this.ds=o,this.vs=s,this.ws=a,this.ps=Date.now()}return t.prototype.calculatePayload=function(){var t=this.bs(),e=this.ws.getQoSAnalytics(),r=e?Math.round(1e3*Math.max(this.cs.calcDelta(e.timeSpentPlaying),0)):0,n=e?Math.round(1e3*Math.max(this.hs.calcDelta(e.timeSpentRebuffering),0)):0,i={timespan:t,live:this.Si.isLive(),bitrate:this.vs.getAverageBitrate(t),played:r>0?r:void 0,buffered:n>0?n:void 0,dna:void 0,compass:void 0};if(this.Si.conf.QOS_P2P_DISABLED){var o=this.Zt.calcDelta(this.ds.cdnDownloaded);i.dna={cdn:o,p2p:0,upload:0}}if(this.Si.conf.QOS_COMPASS_DISABLED){var s={id:"sr-default",bytes:this.Zt.calcDelta(this.ds.cdnDownloaded),dTime:this.tn.calcDelta(this.ds.cdnDownloadedTime)};i.compass={cdns:[s]}}return this.ms(),i},t.prototype.bs=function(){return Date.now()-this.ps},t.prototype.ms=function(){this.ps=Date.now()},t}();e.default=o,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(25)),o=n(r(0)),s=r(42),a=r(24),u=n(r(54)),c=function(){function t(e){var r=e.configManager,n=e.transferStats,i=e.backendStats,a=e.bitrateStats,u=e.mediaEngineStats,c=e.networkTypeStats,l=e.qosAnalyticsHandler;(0,o.default)(this,t),this.Zt=new s.Delta,this.tn=new s.Delta,this.Ti=new s.Delta,this.Es=new s.Delta,this.ys=new s.Delta,this.gs=new s.Delta,this.Ts=new s.Delta,this.Os=new s.Delta,this.Ms=new s.Delta,this.Ss=new s.Delta,this.As=new s.Delta,this.Rs=new s.Delta,this.Ns=new s.Delta,this.Cs=new s.Delta,this.Ds=new s.Delta,this.Is=new s.Delta,this.js=new s.Delta,this.ks=new s.Delta,this.Ls=new s.Delta,this.Ps=new s.Delta,this.Si=r,this.ds=n,this.lr=i,this.vs=a,this.qi=u,this.Us=c,this.ws=l,this.Fs=Date.now(),this.ps=Date.now()}return t.prototype.calculatePayload=function(){var t=this.bs(),e=this.Si.getActivationStatus(),r=this.Si.getVersions(),n=r.mediaEngineTag,o=r.integrationTag,s=this.Bs(),a=this.Is.calcDelta(this.qi.playbackErrorCount),u=this.js.calcDelta(this.qi.segmentsNotFound),c=this.ks.calcDelta(this.qi.segmentsFound),l=this.Ls.calcDelta(this.qi.tracksNotFound),f=this.Ps.calcDelta(this.qi.tracksFound),d=this.Si.getPropertyParameters(),h=(0,i.default)({timespan:t,sessionDuration:this.xs(),live:this.Si.isLive(),activationStatus:e,compassActivationStatus:this.Si.getCompassActivationStatus(),qosTester:this.Si.conf.QOS_P2P_DISABLED,compassQosTester:this.Si.conf.QOS_COMPASS_DISABLED,rampUpActivated:this.Si.isRampUpActivated(),sdkConfLabel:this.Si.conf.CONF_LABEL,mediaEngine:n,integrationTag:o,siteId:this.Si.getSiteId()||void 0,bitrate:this.vs.getAverageBitrate(t),transfers:this.Vs(),backend:this.Hs(),qos:this.ws.getFormattedQoSAnalytics(),options:void 0},s,{aggPlaybackErrorCount:this.qi.playbackErrorCount,playbackErrorCount:a,segmentsNotFound:u,segmentsFound:c,tracksNotFound:l,tracksFound:f,latency:this.Si.isLive()?this.Si.getLatency():void 0,sampledPlaybackPosition:this.ws.getPlaybackPosition(),usedProperty:d.name,customerLabel:this.Si.getDnaConfig().customerLabel,clientUrlVersion:this.Si.getClientUrlVersion()});return this.Si.conf.QOS_P2P_DISABLED&&(h.options={p2pDownloadAlwaysOn:!1,p2pUploadAlwaysOn:!1}),this.ms(),h},t.prototype.Vs=function(){var t=this.ds,e=this.Zt.calcDelta(t.cdnDownloaded);return{cdnDownloaded:e,cdnDownloadedTime:this.tn.calcDelta(t.cdnDownloadedTime),cdnUseful:e,cdnConsumed:e,durationConsumed:this.Ti.calcDelta(this.qi.durationConsumed)}},t.prototype.Hs=function(){var t=this.lr;return u.default.cleanProperties({routerErrors:this.Es.calcDelta(t.routerErrors.all),routerErrorsHTTP:this.ys.calcDelta(t.routerErrors.http),azChanges:this.gs.calcDelta(t.azChanges),distributorErrors:this.Ts.calcDelta(t.distributorErrors.all),distributorErrorsHTTP:this.Os.calcDelta(t.distributorErrors.http),analyticsErrors:this.Ms.calcDelta(t.analyticsErrors.all),analyticsErrorsHTTP:this.Ss.calcDelta(t.analyticsErrors.http),subnetMatcherErrors:this.As.calcDelta(t.subnetMatcherErrors.all),subnetMatcherErrorsHTTP:this.Rs.calcDelta(t.subnetMatcherErrors.http)})},t.prototype.Bs=function(){return{timeSpentOnWifi:(0,a.toDecimal)(this.Ns.calcDelta(this.Us.timeSpentOnWifi),2),timeSpentOnCellular:(0,a.toDecimal)(this.Cs.calcDelta(this.Us.timeSpentOnCellular),2),timeSpentWithoutNetwork:(0,a.toDecimal)(this.Ds.calcDelta(this.Us.timeSpentWithoutNetwork),2)}},t.prototype.xs=function(){return Date.now()-this.Fs},t.prototype.bs=function(){return Date.now()-this.ps},t.prototype.ms=function(){this.ps=Date.now()},t}();e.default=c,t.exports=e.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),i=r(42),o=function(){function t(e){var r=e.configManager,o=e.costStats;(0,n.default)(this,t),this.Gs=new i.Delta,this.zs=new i.Delta,this.Ws=new i.Delta,this.Ys=new i.Delta,this.Ks=new i.Delta,this.Xs=new i.Delta,this.Qs=new i.Delta,this.$s=new i.Delta,this.Js=new i.Delta,this.Zs=new i.Delta,this.to=new i.Delta,this.no=new i.Delta,this.Si=r,this.dr=o,this.Fs=Date.now(),this.ps=Date.now()}return t.prototype.calculatePayload=function(){var t=this.bs(),e=this.Si.getVersions(),r=e.mediaEngineTag,n=e.integrationTag,i={timespan:t,sessionDuration:this.xs(),live:this.Si.isLive(),qosTester:this.Si.conf.QOS_P2P_DISABLED,compassQosTester:this.Si.conf.QOS_COMPASS_DISABLED,sdkConfLabel:this.Si.conf.CONF_LABEL,mediaEngine:r,integrationTag:n,cost:this.io()};return this.ms(),i},t.prototype.io=function(){var t=this.dr;return{routerRequestsCount:this.Gs.calcDelta(t.routerRequestsCount),routerRequestsVolume:this.zs.calcDelta(t.routerRequestsVolume),routerResponsesVolume:this.Ws.calcDelta(t.routerResponsesVolume),distributorRequestsCount:this.Ys.calcDelta(t.distributorRequestsCount),distributorRequestsVolume:this.Ks.calcDelta(t.distributorRequestsVolume),distributorResponsesVolume:this.Xs.calcDelta(t.distributorResponsesVolume),subnetMatcherRequestsCount:this.Qs.calcDelta(t.subnetMatcherRequestsCount),subnetMatcherRequestsVolume:this.$s.calcDelta(t.subnetMatcherRequestsVolume),subnetMatcherResponsesVolume:this.Js.calcDelta(t.subnetMatcherResponsesVolume),usagePayloadsCount:this.Zs.calcDelta(t.usagePayloadsCount),usagePayloadsVolume:this.to.calcDelta(t.usagePayloadsVolume),researchPayloadsVolume:this.no.calcDelta(t.researchPayloadsVolume)}},t.prototype.xs=function(){return Date.now()-this.Fs},t.prototype.bs=function(){return Date.now()-this.ps},t.prototype.ms=function(){this.ps=Date.now()},t}();e.default=o,t.exports=e.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),i=function(){function t(e){var r=e.configManager;(0,n.default)(this,t),this.Si=r}return t.prototype.calculatePayload=function(){return{}},t}();e.default=i,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(16)),o=n(r(17)),s=n(r(0)),a=n(r(23)),u=(n(r(55)),function(){function t(e){var r=e.configManager,n=e.environment,i=e.httpRequestFactory,o=e.costStats,a=e.backendStats,u=e.errorFunnel;(0,s.default)(this,t),this.Si=r,this.Hi=n,this.vr=i,this.dr=o,this.lr=a,this.zi=u,this.ft=r.getPeerId()}return t.prototype.send=function(t,e){var r=this;(0,o.default)(t,{customer:this.Si.getStreamrootKey(),content:this.Si.getContentId(),token:this.ft,peerId:this.ft,platform:this.Hi.getPlatform()});var n=(0,i.default)(t);switch(e?e.split("/").pop():""){case"traffic-v2":this.dr.usagePayloadsCount++,this.dr.usagePayloadsVolume+=n.length;break;default:this.dr.researchPayloadsVolume+=n.length}var s=""+this.Si.getAnalyticsUrl()+e,u={timeout:this.Si.conf.REQUEST_RETRY.ANALYTICS.TIMEOUT,headers:{}},c=this.Si.conf.REQUEST_RETRY.ANALYTICS;u.headers["Content-Type"]="application/json";var l=this.Si.getBackendToken();l&&(u.headers.Authorization="Bearer "+l);var f=this.vr.getRequest(a.default.Methods.POST,s,u,c);f.isStreamroot=!0,f.send(n).catch(function(t){r.lr.analyticsErrors.increment(t),r.zi.notify("Could not send analytics payload",t.status+" "+t.message,"warning")})},t}());e.default=u,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(29)),o=n(r(25)),s=n(r(0)),a=n(r(125)),u=function(){function t(e,r,n){var i=e.configManager,o=e.peerAgentCounter;(0,s.default)(this,t),this.eo=!1,this.Si=i,this.Yr=r,this.jr=n,this.ro=o}return t.prototype.sendPayload=function(){if(!this.eo){var t=this.Si.getPropertyParameters(),e=this.Si.getParserOptions(),r={requestedProperty:t.requested,usedProperty:t.name,ssaiEnabled:t.ssaiEnabled,activationRatio:t.activationRatio,superSeederRatio:t.superSeederRatio,wifiEthernetUpload:t.wifiEthernetUpload,wifiEthernetDownload:t.wifiEthernetDownload,cellularOtherUpload:t.cellularOtherUpload,cellularOtherDownload:t.cellularOtherDownload,ssaiProvider:e.ssaiOptions&&e.ssaiOptions.label||e.ssaiProvider,ssaiVariant:e.ssaiVariant},n=this.Si.getStreamInfo(),s=n.segmentDuration,u=n.playListLength,c=n.trackCount,l={contentUrl:this.Si.getContentUrl(),segmentDuration:s,playlistLength:u,videoFormat:this.Si.getStreamType(),formatDetails:void 0,live:this.Si.isLive(),dvr:void 0,trackCount:c,subtitles:void 0,multiAudio:void 0,latency:this.Si.getLatency(),parsingDuration:void 0,abrStrategy:this.Si.getAbrStrategy()},f=this.Si.getVersions().integrationTag,d=this.Si.getMediaEngineInfo(),h={ssai:void 0,cdn:void 0,mediaEngine:d.name,mediaEngineVersion:d.version,player:void 0,playerVersion:void 0},p=this.Si.getPlayerInfo();null!=p&&(h.player=p.name,h.playerVersion=p.version);var v=(0,o.default)({backendHost:this.Si.getBackendHost()},this.Si.getBackendUrls()),g={integrationTag:f,deliveryMethod:this.Si.getDeliveryMethod(),sdkConfLabel:this.Si.conf.CONF_LABEL,clientUrlVersion:this.Si.getClientUrlVersion()},y={asyncLoadingOption:this.Si.getAsyncLoadingOption(),siteId:this.Si.getSiteId()||void 0,hostingOption:this.Si.getHostingOption(),bundleId:void 0},m={href:window&&window.location?window.location.href:"",origin:window?window.origin:"",referrer:document?document.referrer:""},E={activationStatus:this.Si.getActivationStatus(),compassActivationStatus:this.Si.getCompassActivationStatus(),defaultContentId:this.Si.getDefaultContentId(),properties:r,compassProperties:void 0,media:l,videoWorkflow:h,backend:v,srElements:g,srOptions:y,webSite:m,peerAgentCounter:this.ro,statsSender:this.Si.conf.ANALYTICS.ENABLE_STATS_SENDER,controlSender:this.Si.conf.ANALYTICS.ENABLE_CONTROL_SENDER,connectionsSender:this.Si.conf.ANALYTICS.ENABLE_CONNECTIONS_SENDER,customerLabel:this.Si.getDnaConfig().customerLabel},_=!0,b=!1,T=void 0;try{for(var S,w=(0,i.default)(this.jr);!(_=(S=w.next()).done);_=!0){var A=S.value.getAnalytics("support");A.compass||A.srElements?(0,a.default)(E,A):E.srElements=(0,o.default)({},E.srElements,A)}}catch(t){b=!0,T=t}finally{try{!_&&w.return&&w.return()}finally{if(b)throw T}}if(this.Si.isCompassActivated()){var R=this.Si.getCompassPropertyParameters();E.compassProperties={activationRatio:R.activationRatio||0,cdnListName:R.cdnListName||"",requestedProperty:R.requested||"",usedProperty:R.name||"",cdnScoreProviderName:R.cdnScoreProvider&&R.cdnScoreProvider.name||""}}this.Yr.send(E,"support"),this.eo=!0}},t}();e.default=u,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(2)),s=r(7),a=100,u=function(){function t(e,r){(0,i.default)(this,t),c.call(this),this.hn=r,this.g=e,this.hn&&(this.we=(0,s.createInterval)(this.so,a)),this.g.on(o.default.MEDIA_ELEMENT_ATTACHED,this.Qi),this.g.on(o.default.MEDIA_ELEMENT_DETACHED,this.Ji)}return t.prototype.dispose=function(){this.g.removeListener(o.default.MEDIA_ELEMENT_ATTACHED,this.Qi),this.g.removeListener(o.default.MEDIA_ELEMENT_DETACHED,this.Ji),this.hn=null,this.we&&(this.we.clear(),this.we=null)},t}(),c=function(){var t=this;this.hn=null,this.we=null,this.Qi=function(e){t.hn=e,t.we||(t.we=(0,s.createInterval)(t.so,a))},this.Ji=function(){t.hn=null,t.we&&(t.we.clear(),t.we=null)},this.so=function(){if(t.hn){var e=t.hn,r=e.duration,n=e.currentTime;r&&r-n<.3&&(t.g.emit(o.default.MEDIA_ENDED),t.dispose())}}};e.default=u,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(29)),o=n(r(48)),s=n(r(0)),a=function(){function t(){(0,s.default)(this,t),this.oo=new o.default}return t.prototype.register=function(t){var e=t.name;return!this.oo.has(e)&&(this.oo.set(e,t),!0)},t.prototype.registerAs=function(t,e){return!this.oo.has(t)&&(e.name=t,this.oo.set(t,e),!0)},t.prototype.clear=function(t){return!!t&&this.clearNamedTimer(t.name)},t.prototype.clearNamedTimer=function(t){var e=this.oo.get(t);return!!e&&(e.clear(),this.oo.delete(e.name))},t.prototype.clearAll=function(){var t=!0,e=!1,r=void 0;try{for(var n,o=(0,i.default)(this.oo.values());!(t=(n=o.next()).done);t=!0){var s=n.value;this.clear(s)}}catch(t){e=!0,r=t}finally{try{!t&&o.return&&o.return()}finally{if(e)throw r}}},t}();e.default=a,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){return!0===e.loadAfterPlaybackStarted?new u.default(t):null!==e.fragmentsFetchedBeforeLoad&&0!==e.fragmentsFetchedBeforeLoad?new s.default(t,e.fragmentsFetchedBeforeLoad):null!==e.secondsPrebufferedBeforeLoad?new a.default(t,e.secondsPrebufferedBeforeLoad):new o.default(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.createTrigger=i;var o=n(r(273)),s=n(r(274)),a=n(r(275)),u=n(r(276))},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(39)),s=n(r(40)),a=function(t){function e(r){return(0,i.default)(this,e),(0,o.default)(this,t.call(this,r))}return(0,s.default)(e,t),e.prototype.isConditionMet=function(){return!0},e}(n(r(57)).default);e.default=a,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(39)),s=n(r(40)),a=n(r(57)),u=n(r(2)),c=function(t){function e(r,n){(0,i.default)(this,e);var s=(0,o.default)(this,t.call(this,r));return s.uo=n,s.co(),s.ho=s.ao.bind(s),s.g.on(u.default.MEDIA_SEGMENT_FETCHED,s.ho),s.fo=s.lo.bind(s),s.g.on(u.default.STOPPED,s.fo),s}return(0,s.default)(e,t),e.prototype.isConditionMet=function(){return this.do<=0},e.prototype.dispose=function(){this.g.removeListener(u.default.MEDIA_SEGMENT_FETCHED,this.ho),this.g.removeListener(u.default.STOPPED,this.fo),t.prototype.dispose.call(this)},e.prototype.ao=function(){this.do--,this.checkTrigger()},e.prototype.lo=function(){this.co()},e.prototype.co=function(){this.do=this.uo},e}(a.default);e.default=c,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(39)),s=n(r(40)),a=n(r(57)),u=n(r(2)),c=r(122),l=r(7),f=function(t){function e(r,n){(0,i.default)(this,e);var s=(0,o.default)(this,t.call(this,r));return s.hn=null,s.vo=n,s.wo=s.Qi.bind(s),s.g.on(u.default.MEDIA_ELEMENT_ATTACHED,s.wo),s.po=s.bo.bind(s),s.g.on(u.default.DNA_CLIENT_LOAD_CONDITION_REACHED,s.po),s}return(0,s.default)(e,t),e.prototype.isConditionMet=function(){return(0,c.getBufferedAmount)(this.hn)>=this.vo||null!==this.mo&&this.mo<=Date.now()},e.prototype.dispose=function(){this.Eo(),this.mo=null,this.hn=null,this.g.removeListener(u.default.MEDIA_ELEMENT_ATTACHED,this.wo),this.g.removeListener(u.default.DNA_CLIENT_LOAD_CONDITION_REACHED,this.po),t.prototype.dispose.call(this)},e.prototype.M=function(){this.Eo(),this.br=(0,l.createInterval)(this.checkTrigger.bind(this),100),this.mo=Date.now()+3e4},e.prototype.Eo=function(){this.br&&(this.br.clear(),this.br=null)},e.prototype.Qi=function(t){this.hn=t,this.checkTrigger()},e.prototype.bo=function(){this.Eo()},e}(a.default);e.default=f,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(39)),s=n(r(40)),a=n(r(57)),u=n(r(2)),c=r(7),l=function(t){function e(r){(0,i.default)(this,e);var n=(0,o.default)(this,t.call(this,r));return n._o=null,n.hn=null,n.wo=n.Qi.bind(n),n.g.on(u.default.MEDIA_ELEMENT_ATTACHED,n.wo),n.po=n.bo.bind(n),n.g.on(u.default.DNA_CLIENT_LOAD_CONDITION_REACHED,n.po),n}return(0,s.default)(e,t),e.prototype.isConditionMet=function(){if(null!=this.hn){var t=this.hn.currentTime;if(null==this._o)return this._o=t,!1;var e=t-this._o;return e<0||e>10?(this._o=t,!1):e>=.5}return!1},e.prototype.dispose=function(){this.Eo(),this.hn=null,this.g.removeListener(u.default.MEDIA_ELEMENT_ATTACHED,this.wo),this.g.removeListener(u.default.DNA_CLIENT_LOAD_CONDITION_REACHED,this.po),t.prototype.dispose.call(this)},e.prototype.M=function(){this.Eo(),this._o=null,this.br=(0,c.createInterval)(this.checkTrigger.bind(this),100)},e.prototype.Eo=function(){this.br&&(this.br.clear(),this.br=null)},e.prototype.Qi=function(t){this.hn=t,this.checkTrigger()},e.prototype.bo=function(){this.Eo()},e}(a.default);e.default=l,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.abrInterfaceGenerator=void 0;var i=n(r(0)),o=n(r(4)),s=n(r(278)),a=void 0,u=function(t){return a=function(){function e(){(0,i.default)(this,e)}return(0,o.default)(e,[{key:"nextSegmentPrebuffered",get:function(){return t.peerAgent?t.peerAgent.nextSegmentPrebuffered:new s.default}}]),e}()};e.abrInterfaceGenerator=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),i=function t(){(0,n.default)(this,t),this.video=!1,this.audio=!1};e.default=i,t.exports=e.default},function(t,e,r){"use strict";function n(){window.Streamroot=window.Streamroot||{},window.Streamroot.instances=window.Streamroot.instances||[]}function i(t){if(window.Streamroot.instances){var e={};(0,s.mapPublicAPI)(t,e),window.Streamroot.instances.push(e)}}function o(t){if(window.Streamroot.instances)for(var e=0;e<window.Streamroot.instances.length;e++)if(window.Streamroot.instances[e].id===t.id){window.Streamroot.instances.splice(e,1);break}}Object.defineProperty(e,"__esModule",{value:!0}),e.removeFromStreamrootInstances=e.addToStreamrootInstances=e.setupNamespace=void 0;var s=r(126);e.setupNamespace=n,e.addToStreamrootInstances=i,e.removeFromStreamrootInstances=o},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(25)),o=n(r(0)),s=n(r(4)),a=n(r(85)),u=n(r(281)),c=r(7),l=function(){function t(e,r){(0,o.default)(this,t);var n=e.configManager.getStreamrootKey(),s={createTimeout:c.createTimeout,createInterval:c.createInterval},l=e.httpRequestFactory,f=e.errorFunnel,d=e.dnaConfig,h={httpRequestFactory:l,errorFunnel:f,timerFactory:s,compassConfig:d},p=e.configManager.getCompassPropertyParameters(),v=p.cdnListName,g=p.cdnScoreProvider,y=a.default.newBuilder().streamrootKey(n).interfaces(h).config(r);"citrix"===g.name?y.scoreProvider("citrix",g):y.scoreProvider("streamroot",(0,i.default)({},g,{cdnListName:v,providerHost:d.compassScoreProviderHost})),this.yo=y.build(),this.To=new u.default(this.yo,e.eventBus)}return t.prototype.dispose=function(){this.To.dispose(),this.yo.dispose(),this.yo=null,this.g=null},t.prototype.getUpdatedRequest=function(t){return this.yo.getUpdatedRequest(t)},t.prototype.getAnalytics=function(t){return this.yo.getAnalytics(t)},(0,s.default)(t,[{key:"stats",get:function(){return this.yo.stats}}]),t}();e.default=l,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(r(0)),o=n(r(2)),s=(n(r(80)),function(){function t(e,r){var n=this;(0,i.default)(this,t),this.Oo=function(t){n.yo.reportCdnSuccess(t.url,t.requestStats)},this.Mo=function(t){var e=t.url,r=t.error;n.yo.reportCdnError(e,r)},this.yo=e,this.g=r,this.g.on(o.default.CDN_TIMING_EVENT,this.Oo),this.g.on(o.default.CDN_DOWNLOAD_ERROR,this.Mo)}return t.prototype.dispose=function(){this.g.removeListener(o.default.CDN_TIMING_EVENT,this.Oo),this.g.removeListener(o.default.CDN_DOWNLOAD_ERROR,this.Mo),this.g=null,this.yo=null},t}());e.default=s,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){return null!=t&&"function"==typeof t.info&&"function"==typeof t.module}function o(t){var e=window["sr-"+t];return null!=e&&!i(e)&&(e.info=function(){var e={version:"legacy",provides:{},conflicts:{}};return e.provides[t]=0,e},e.module=function(){return f.default.resolve(e)},!0)}var s=n(r(21)),a=n(r(16)),u=n(r(17)),c=n(r(22)),l=n(r(0)),f=n(r(56)),d=function(){function t(){(0,l.default)(this,t),this.clear()}return t.prototype.clear=function(){this.So=!1,this.L={remoteRepoPath:null,provides:{},conflicts:{}},this.Ao={}},t.prototype.configure=function(t){return!0!==this.So&&null!=t&&"object"===(void 0===t?"undefined":(0,c.default)(t))&&"string"==typeof t.baseRemoteRepoPath&&(this.clear(),this.L.remoteRepoPath=t.baseRemoteRepoPath,null!=t.initProvides&&"object"===(0,c.default)(t.initProvides)&&(0,u.default)(this.L.provides,t.initProvides),null!=t.initConflicts&&"object"===(0,c.default)(t.initConflicts)&&(0,u.default)(this.L.conflicts,t.initConflicts),this.scan(),this.So=!0,!0)},t.prototype.config=function(){return JSON.parse((0,a.default)(this.L))},t.prototype.Ro=function(t,e){for(var r in t)if(null!=e[r]&&t[r]<=e[r])return!1;return!0},t.prototype.No=function(t){return this.Ro(this.L.provides,t.info().conflicts)&&this.Ro(t.info().provides,this.L.conflicts)},t.prototype.Co=function(t,e,r){for(var n in e)null==t[n]?t[n]=e[n]:t[n]=r(t[n],e[n])},t.prototype.Do=function(t){this.Co(this.L.provides,t.info().provides,function(t,e){return Math.min(t,e)}),this.Co(this.L.conflicts,t.info().conflicts,function(t,e){return Math.max(t,e)})},t.prototype.index=function(t,e){return!(!i(e)||this.has(e)||!this.No(e)||(this.Ao[t]=e,this.Do(e),0))},t.prototype.has=function(t){return!!this.Ao[t]},t.prototype.info=function(t){return this.has(t)?this.Ao[t].info():null},t.prototype.get=function(t){return this.has(t)?this.Ao[t].module(this):f.default.reject(new Error("Module '"+t+"' not indexed by MoMan."))},t.prototype.Io=function(t){var e=this;return new f.default(function(r,n){var i=document.createElement("script");e.jo=i,document.body&&document.body.appendChild(i),i.onload=function(){r()},i.onerror=function(){n(new Error("Failed to load script from URL: "+t))},i.src=t})},t.prototype.ko=function(t){var e=this;return new f.default(function(r,n){e.L.remoteRepoPath?e.Io(e.L.remoteRepoPath+"/"+t+".js").then(function(){e.scan(),e.get(t).then(function(t){return r(t)}).catch(function(t){return n(t)})}).catch(function(t){n(t)}):n(new Error("Remote module repo path not configured."))})},t.prototype.require=function(t){return this.has(t)?this.get(t):this.ko(t)},t.prototype.scan=function(){var t=this,e=/^sr-([0-9a-z\-]+)/,r=(0,s.default)(window).filter(function(t){return e.test(t)}).map(function(t){return e.exec(t)[1]}).filter(function(e){return!t.has(e)}),n=!1;return r.forEach(function(e){var r=window["sr-"+e];i(r)||o(e),t.index(e,r)&&(n=!0)}),n},t.prototype.list=function(){var t=this,e={};return(0,s.default)(this.Ao).forEach(function(r){e[r]=t.Ao[r].info().version}),e},t}();if(!window["sr-module-manager"]){var h=new d;h.info=function(){return{version:"1.0.0",provides:{"module-manager":1},conflicts:{}}},h.module=function(){return f.default.resolve(h)},window["sr-module-manager"]=h,h.scan()}}])})},function(t,e,r){t.exports={default:r(86),__esModule:!0}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(53),o=n(i),s=r(69),a=n(s),u="function"==typeof a.default&&"symbol"==typeof o.default?function(t){return typeof t}:function(t){return t&&"function"==typeof a.default&&t.constructor===a.default&&t!==a.default.prototype?"symbol":typeof t};e.default="function"==typeof a.default&&"symbol"===u(o.default)?function(t){return void 0===t?"undefined":u(t)}:function(t){return t&&"function"==typeof a.default&&t.constructor===a.default&&t!==a.default.prototype?"symbol":void 0===t?"undefined":u(t)}},function(t,e){t.exports=!0},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,r){var n=r(43),i=r(31);t.exports=Object.keys||function(t){return n(t,i)}},function(t,e){var r=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+n).toString(36))}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,r){"use strict";e.__esModule=!0;var n=r(16),i=function(t){return t&&t.__esModule?t:{default:t}}(n);e.default=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":(0,i.default)(e))&&"function"!=typeof e?t:e}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(91),o=n(i),s=r(95),a=n(s),u=r(16),c=n(u);e.default=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":(0,c.default)(e)));t.prototype=(0,a.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(o.default?(0,o.default)(t,e):t.__proto__=e)}},function(t,e){var r=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:r)(t)}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,r){var n=r(9);t.exports=function(t,e){if(!n(t))return t;var r,i;if(e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!n(i=r.call(t)))return i;if(!e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports={}},function(t,e,r){var n=r(12),i=r(59),o=r(31),s=r(29)("IE_PROTO"),a=function(){},u=function(){var t,e=r(41)("iframe"),n=o.length;for(e.style.display="none",r(64).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;n--;)delete u.prototype[o[n]];return u()};t.exports=Object.create||function(t,e){var r;return null!==t?(a.prototype=n(t),r=new a,a.prototype=null,r[s]=t):r=u(),void 0===e?r:i(r,e)}},function(t,e,r){var n=r(30)("keys"),i=r(20);t.exports=function(t){return n[t]||(n[t]=i(t))}},function(t,e,r){var n=r(0),i=r(1),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:r(17)?"pure":"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,r){var n=r(6).f,i=r(7),o=r(10)("toStringTag");t.exports=function(t,e,r){t&&!i(t=r?t:t.prototype,o)&&n(t,o,{configurable:!0,value:e})}},function(t,e,r){var n=r(25);t.exports=function(t){return Object(n(t))}},function(t,e,r){e.f=r(10)},function(t,e,r){var n=r(1),i=r(0),o=r(17),s=r(34),a=r(6).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:s.f(t)})}},function(t,e,r){var n=r(21),i=r(18),o=r(3),s=r(26),a=r(7),u=r(40),c=Object.getOwnPropertyDescriptor;e.f=r(2)?c:function(t,e){if(t=o(t),e=s(e,!0),u)try{return c(t,e)}catch(t){}if(a(t,e))return i(!n.f.call(t,e),t[e])}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(15),o=n(i),s=r(88),a=n(s);e.default=function t(e,r,n){null===e&&(e=Function.prototype);var i=(0,a.default)(e,r);if(void 0===i){var s=(0,o.default)(e);return null===s?void 0:t(s,r,n)}if("value"in i)return i.value;var u=i.get;return void 0!==u?u.call(n):void 0}},function(t,e,r){"use strict";var n=r(17),i=r(5),o=r(42),s=r(8),a=r(27),u=r(58),c=r(32),l=r(45),f=r(10)("iterator"),d=!([].keys&&"next"in[].keys()),h=function(){return this};t.exports=function(t,e,r,p,v,g,y){u(r,e,p);var m,E,_,b=function(t){if(!d&&t in A)return A[t];switch(t){case"keys":case"values":return function(){return new r(this,t)}}return function(){return new r(this,t)}},T=e+" Iterator",S="values"==v,w=!1,A=t.prototype,R=A[f]||A["@@iterator"]||v&&A[v],D=R||b(v),O=v?S?b("entries"):D:void 0,L="Array"==e?A.entries||R:R;if(L&&(_=l(L.call(new t)))!==Object.prototype&&_.next&&(c(_,T,!0),n||"function"==typeof _[f]||s(_,f,h)),S&&R&&"values"!==R.name&&(w=!0,D=function(){return R.call(this)}),n&&!y||!d&&!w&&A[f]||s(A,f,D),a[e]=D,a[T]=h,v)if(m={values:S?D:b("values"),keys:g?D:b("keys"),entries:O},y)for(E in m)E in A||o(A,E,m[E]);else i(i.P+i.F*(d||w),e,m);return m}},function(t,e,r){var n=r(57);t.exports=function(t,e,r){if(n(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}}},function(t,e,r){t.exports=!r(2)&&!r(13)(function(){return 7!=Object.defineProperty(r(41)("div"),"a",{get:function(){return 7}}).a})},function(t,e,r){var n=r(9),i=r(1).document,o=n(i)&&n(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,r){t.exports=r(8)},function(t,e,r){var n=r(7),i=r(3),o=r(61)(!1),s=r(29)("IE_PROTO");t.exports=function(t,e){var r,a=i(t),u=0,c=[];for(r in a)r!=s&&n(a,r)&&c.push(r);for(;e.length>u;)n(a,r=e[u++])&&(~o(c,r)||c.push(r));return c}},function(t,e){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,e,r){var n=r(7),i=r(33),o=r(29)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),n(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,r){var n=r(43),i=r(31).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,i)}},function(t,e,r){t.exports={default:r(79),__esModule:!0}},function(t,e,r){var n=r(5),i=r(0),o=r(13);t.exports=function(t,e){var r=(i.Object||{})[t]||Object[t],s={};s[t]=e(r),n(n.S+n.F*o(function(){r(1)}),"Object",s)}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=r(15),o=n(i),s=r(4),a=n(s),u=r(11),c=n(u),l=r(22),f=n(l),d=r(23),h=n(d),p=r(14),v=n(p),g=r(100),y=n(g),m=r(101),E=function(t){return function(e){function r(){return(0,a.default)(this,r),(0,f.default)(this,(r.__proto__||(0,o.default)(r)).apply(this,arguments))}return(0,h.default)(r,e),(0,c.default)(r,[{key:"destroy",value:function(){this.abort()}},{key:"abort",value:function(){this.fetchRequest&&(this.stats.aborted=!0,this.fetchRequest.abort()),clearTimeout(this.requestTimeout),this.requestTimeout=null,clearTimeout(this.retryTimeout),this.retryTimeout=null}},{key:"loadInternal",value:function(){this.stats.tfirst=0,this.stats.loaded=0;var e=this._contentType,r="arraybuffer"===this.context.responseType?v.default.ResponseTypes.ARRAY_BUFFER:v.default.ResponseTypes.TEXT,n=(0,m.extractInfoFromXhrSetup)(this.xhrSetup,this.context.url),i=n.headers,o=n.withCredentials,s=n.url,a=n.timeout;a&&(this.config.timeout=a),this.context.rangeEnd&&(i.Range="bytes="+this.context.rangeStart+"-"+(this.context.rangeEnd-1));var u={headers:i,withCredentials:o,url:s,contentType:e,responseType:r},c={onSuccess:this._loadSuccess.bind(this),onError:this._loadError.bind(this),onProgress:this._loadProgress.bind(this)};this.requestTimeout=setTimeout(this._loadTimeout.bind(this),this.config.timeout),this.fetchRequest=t.streamrooter.fetch(u,c)}},{key:"_loadSuccess",value:function(t,e,r){if(!this.stats.aborted){clearTimeout(this.requestTimeout),this.stats.tload=Math.max(this.stats.tfirst,performance.now()),this.stats.loaded=r.total,this.stats.total=r.total,this._modifyRequestTiming(r);var n=t.responseURL||t.url,i={url:n,data:e};this.callbacks.onSuccess(i,this.stats,this.context)}}},{key:"_loadError",value:function(t,e){if(!this.stats.aborted)if(clearTimeout(this.requestTimeout),this.stats.retry>=this.config.maxRetry||e.status>=400&&e.status<499){var r={code:e.status,text:e.message};this.callbacks.onError(r,this.context)}else this.destroy(),this.retryTimeout=setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,this.config.maxRetryDelay),this.stats.retry++}},{key:"_loadProgress",value:function(t,e){if(!this.stats.aborted){0===this.stats.tfirst&&(this.stats.tfirst=Math.max(performance.now(),this.stats.trequest),clearTimeout(this.requestTimeout),this.requestTimeout=setTimeout(this._loadTimeout.bind(this),this.config.timeout)),this.stats.loaded=e.loaded,e.lengthComputable&&(this.stats.total=e.total);var r=this.callbacks.onProgress;r&&r(this.stats,this.context)}}},{key:"_loadTimeout",value:function(){this.callbacks.onTimeout(this.stats,this.context,null)}},{key:"_modifyRequestTiming",value:function(t){}},{key:"_contentType",get:function(){throw new Error("Cannot call getter _contentType from abstract class")}}]),r}(y.default)};e.default=E,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=r(4),o=n(i),s=r(52),a=n(s),u=r(105),c=function t(e,r,n,i){(0,o.default)(this,t);var s=new a.default(e,r,n,i);"function"==typeof s.streamrooter.mapIntegrationInterface?s.streamrooter.mapIntegrationInterface(this):(0,u.mapStreamrooterInterface)(this,s.streamrooter)};e.default=c,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){return"function"==typeof t?t:E}Object.defineProperty(e,"__esModule",{value:!0});var o=r(16),s=n(o),a=r(4),u=n(a),c=r(11),l=n(c),f=r(14),d=n(f),h=r(81),p=n(h),v=r(99),g=n(v),y=r(104),m=n(y),E=function(){},_=function(){function t(e,r,n,i){(0,u.default)(this,t),this.loaderHooks={pLoader:{load:E,abort:E,destroy:E},fLoader:{load:E,abort:E,destroy:E}},this._handleWrapperConfig(i);var o=new p.default(e,this.playerInfo);o.setAbrStrategy(),this.streamrooter=new d.default(r,o,n,"1.0.93"),e.media&&this.streamrooter.attachMediaElement(e.media),e.config.pLoader=(0,g.default)(this,e),e.config.fLoader=(0,m.default)(this,e),e.media||e.on(e.constructor.Events.MEDIA_ATTACHING,this._onMediaAttaching.bind(this)),e.on(e.constructor.Events.DESTROYING,this._onDestroy.bind(this)),this._overrideLoadSource(e),this._overrideABRController(e)}return(0,l.default)(t,[{key:"_handleWrapperConfig",value:function(t){if(null!=t&&"object"===(void 0===t?"undefined":(0,s.default)(t))){var e=t.hooks;null!=e&&"object"===(void 0===e?"undefined":(0,s.default)(e))&&("object"===(0,s.default)(e.pLoader)&&(this.loaderHooks.pLoader.load=i(e.pLoader.load),this.loaderHooks.pLoader.abort=i(e.pLoader.abort),this.loaderHooks.pLoader.destroy=i(e.pLoader.destroy)),"object"===(0,s.default)(e.fLoader)&&(this.loaderHooks.fLoader.load=i(e.fLoader.load),this.loaderHooks.fLoader.abort=i(e.fLoader.abort),this.loaderHooks.fLoader.destroy=i(e.fLoader.destroy))),this.playerInfo=t.playerInfo}}}]),(0,l.default)(t,[{key:"_overrideLoadSource",value:function(t){var e=this,r=t.loadSource,n=function(n){!0===e.streamrooter.loaded&&e.streamrooter.stop(),e.streamrooter.load(n,e.streamrooter.constructor.StreamTypes.HLS),r.apply(t,arguments)};t.loadSource=n}},{key:"_overrideABRController",value:function(t){var e=void 0,r=void 0;if(t.abrController._findBestLevel)r=t.abrController._findBestLevel,e=!0;else{if(!t.abrController.findBestLevel)return;r=t.abrController.findBestLevel,e=!1}var n=this,i=function(){var e=r.apply(t.abrController,arguments),i=t.loadLevel;return n.streamrooter&&n.streamrooter.abr.nextSegmentPrebuffered.video&&e<i&&(e=i),e};e?t.abrController._findBestLevel=i:t.abrController.findBestLevel=i}},{key:"_onMediaAttaching",value:function(t,e){this.streamrooter.attachMediaElement(e.media)}},{key:"_onMediaDetaching",value:function(){this.streamrooter.detachMediaElement()}},{key:"_onDestroy",value:function(){this.streamrooter.destroy()}}]),t}();e.default=_,t.exports=e.default},function(t,e,r){t.exports={default:r(54),__esModule:!0}},function(t,e,r){r(55),r(65),t.exports=r(34).f("iterator")},function(t,e,r){"use strict";var n=r(56)(!0);r(38)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=n(e,r),this._i+=t.length,{value:t,done:!1})})},function(t,e,r){var n=r(24),i=r(25);t.exports=function(t){return function(e,r){var o,s,a=String(i(e)),u=n(r),c=a.length;return u<0||u>=c?t?"":void 0:(o=a.charCodeAt(u),o<55296||o>56319||u+1===c||(s=a.charCodeAt(u+1))<56320||s>57343?t?a.charAt(u):o:t?a.slice(u,u+2):s-56320+(o-55296<<10)+65536)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,r){"use strict";var n=r(28),i=r(18),o=r(32),s={};r(8)(s,r(10)("iterator"),function(){return this}),t.exports=function(t,e,r){t.prototype=n(s,{next:i(1,r)}),o(t,e+" Iterator")}},function(t,e,r){var n=r(6),i=r(12),o=r(19);t.exports=r(2)?Object.defineProperties:function(t,e){i(t);for(var r,s=o(e),a=s.length,u=0;a>u;)n.f(t,r=s[u++],e[r]);return t}},function(t,e,r){var n=r(44);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},function(t,e,r){var n=r(3),i=r(62),o=r(63);t.exports=function(t){return function(e,r,s){var a,u=n(e),c=i(u.length),l=o(s,c);if(t&&r!=r){for(;c>l;)if((a=u[l++])!=a)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===r)return t||l||0;return!t&&-1}}},function(t,e,r){var n=r(24),i=Math.min;t.exports=function(t){return t>0?i(n(t),9007199254740991):0}},function(t,e,r){var n=r(24),i=Math.max,o=Math.min;t.exports=function(t,e){return t=n(t),t<0?i(t+e,0):o(t,e)}},function(t,e,r){var n=r(1).document;t.exports=n&&n.documentElement},function(t,e,r){r(66);for(var n=r(1),i=r(8),o=r(27),s=r(10)("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<a.length;u++){var c=a[u],l=n[c],f=l&&l.prototype;f&&!f[s]&&i(f,s,c),o[c]=o.Array}},function(t,e,r){"use strict";var n=r(67),i=r(68),o=r(27),s=r(3);t.exports=r(38)(Array,"Array",function(t,e){this._t=s(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==e?i(0,r):"values"==e?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,r){t.exports={default:r(70),__esModule:!0}},function(t,e,r){r(71),r(76),r(77),r(78),t.exports=r(0).Symbol},function(t,e,r){"use strict";var n=r(1),i=r(7),o=r(2),s=r(5),a=r(42),u=r(72).KEY,c=r(13),l=r(30),f=r(32),d=r(20),h=r(10),p=r(34),v=r(35),g=r(73),y=r(74),m=r(12),E=r(9),_=r(33),b=r(3),T=r(26),S=r(18),w=r(28),A=r(75),R=r(36),D=r(46),O=r(6),L=r(19),C=R.f,I=O.f,P=A.f,M=n.Symbol,N=n.JSON,k=N&&N.stringify,x=h("_hidden"),F=h("toPrimitive"),U={}.propertyIsEnumerable,B=l("symbol-registry"),j=l("symbols"),G=l("op-symbols"),H=Object.prototype,V="function"==typeof M&&!!D.f,q=n.QObject,W=!q||!q.prototype||!q.prototype.findChild,Y=o&&c(function(){return 7!=w(I({},"a",{get:function(){return I(this,"a",{value:7}).a}})).a})?function(t,e,r){var n=C(H,e);n&&delete H[e],I(t,e,r),n&&t!==H&&I(H,e,n)}:I,K=function(t){var e=j[t]=w(M.prototype);return e._k=t,e},z=V&&"symbol"==typeof M.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof M},X=function(t,e,r){return t===H&&X(G,e,r),m(t),e=T(e,!0),m(r),i(j,e)?(r.enumerable?(i(t,x)&&t[x][e]&&(t[x][e]=!1),r=w(r,{enumerable:S(0,!1)})):(i(t,x)||I(t,x,S(1,{})),t[x][e]=!0),Y(t,e,r)):I(t,e,r)},Q=function(t,e){m(t);for(var r,n=g(e=b(e)),i=0,o=n.length;o>i;)X(t,r=n[i++],e[r]);return t},$=function(t,e){return void 0===e?w(t):Q(w(t),e)},Z=function(t){var e=U.call(this,t=T(t,!0));return!(this===H&&i(j,t)&&!i(G,t))&&(!(e||!i(this,t)||!i(j,t)||i(this,x)&&this[x][t])||e)},J=function(t,e){if(t=b(t),e=T(e,!0),t!==H||!i(j,e)||i(G,e)){var r=C(t,e);return!r||!i(j,e)||i(t,x)&&t[x][e]||(r.enumerable=!0),r}},tt=function(t){for(var e,r=P(b(t)),n=[],o=0;r.length>o;)i(j,e=r[o++])||e==x||e==u||n.push(e);return n},et=function(t){for(var e,r=t===H,n=P(r?G:b(t)),o=[],s=0;n.length>s;)!i(j,e=n[s++])||r&&!i(H,e)||o.push(j[e]);return o};V||(M=function(){if(this instanceof M)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(r){this===H&&e.call(G,r),i(this,x)&&i(this[x],t)&&(this[x][t]=!1),Y(this,t,S(1,r))};return o&&W&&Y(H,t,{configurable:!0,set:e}),K(t)},a(M.prototype,"toString",function(){return this._k}),R.f=J,O.f=X,r(47).f=A.f=tt,r(21).f=Z,D.f=et,o&&!r(17)&&a(H,"propertyIsEnumerable",Z,!0),p.f=function(t){return K(h(t))}),s(s.G+s.W+s.F*!V,{Symbol:M});for(var rt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;rt.length>nt;)h(rt[nt++]);for(var it=L(h.store),ot=0;it.length>ot;)v(it[ot++]);s(s.S+s.F*!V,"Symbol",{for:function(t){return i(B,t+="")?B[t]:B[t]=M(t)},keyFor:function(t){if(!z(t))throw TypeError(t+" is not a symbol!");for(var e in B)if(B[e]===t)return e},useSetter:function(){W=!0},useSimple:function(){W=!1}}),s(s.S+s.F*!V,"Object",{create:$,defineProperty:X,defineProperties:Q,getOwnPropertyDescriptor:J,getOwnPropertyNames:tt,getOwnPropertySymbols:et});var st=c(function(){D.f(1)});s(s.S+s.F*st,"Object",{getOwnPropertySymbols:function(t){return D.f(_(t))}}),N&&s(s.S+s.F*(!V||c(function(){var t=M();return"[null]"!=k([t])||"{}"!=k({a:t})||"{}"!=k(Object(t))})),"JSON",{stringify:function(t){for(var e,r,n=[t],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=e=n[1],(E(e)||void 0!==t)&&!z(t))return y(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!z(e))return e}),n[1]=e,k.apply(N,n)}}),M.prototype[F]||r(8)(M.prototype,F,M.prototype.valueOf),f(M,"Symbol"),f(Math,"Math",!0),f(n.JSON,"JSON",!0)},function(t,e,r){var n=r(20)("meta"),i=r(9),o=r(7),s=r(6).f,a=0,u=Object.isExtensible||function(){return!0},c=!r(13)(function(){return u(Object.preventExtensions({}))}),l=function(t){s(t,n,{value:{i:"O"+ ++a,w:{}}})},f=function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,n)){if(!u(t))return"F";if(!e)return"E";l(t)}return t[n].i},d=function(t,e){if(!o(t,n)){if(!u(t))return!0;if(!e)return!1;l(t)}return t[n].w},h=function(t){return c&&p.NEED&&u(t)&&!o(t,n)&&l(t),t},p=t.exports={KEY:n,NEED:!1,fastKey:f,getWeak:d,onFreeze:h}},function(t,e,r){var n=r(19),i=r(46),o=r(21);t.exports=function(t){var e=n(t),r=i.f;if(r)for(var s,a=r(t),u=o.f,c=0;a.length>c;)u.call(t,s=a[c++])&&e.push(s);return e}},function(t,e,r){var n=r(44);t.exports=Array.isArray||function(t){return"Array"==n(t)}},function(t,e,r){var n=r(3),i=r(47).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(t){try{return i(t)}catch(t){return s.slice()}};t.exports.f=function(t){return s&&"[object Window]"==o.call(t)?a(t):i(n(t))}},function(t,e){},function(t,e,r){r(35)("asyncIterator")},function(t,e,r){r(35)("observable")},function(t,e,r){r(80);var n=r(0).Object;t.exports=function(t,e,r){return n.defineProperty(t,e,r)}},function(t,e,r){var n=r(5);n(n.S+n.F*!r(2),"Object",{defineProperty:r(6).f})},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=r(16),o=n(i),s=r(82),a=n(s),u=r(15),c=n(u),l=r(4),f=n(l),d=r(11),h=n(d),p=r(22),v=n(p),g=r(37),y=n(g),m=r(23),E=n(m),_=r(14),b=n(_),T=r(98),S=n(T),w={CONVENTIONAL:"conventional",CUSTOM:"custom",UNKNOWN:"unknown"},A=function(t){function e(t,r){(0,f.default)(this,e);var n=(0,v.default)(this,(e.__proto__||(0,c.default)(e)).call(this));n.hlsjs=t,n._playerInfo=r,n._abrStrategy=w.UNKNOWN,n.hlsjs.on(t.constructor.Events.ERROR,function(t,e){var r=e.type+" - "+e.details;e.fatal&&n.emit(b.default.Events.PLAYBACK_ERROR,r)});var i=t.constructor.Events.LEVEL_SWITCH||t.constructor.Events.LEVEL_SWITCHING;if(void 0===i)throw new Error("Cannot find neither LEVEL_SWITCH nor LEVEL_SWITCHING hls.js event.");n.hlsjs.on(i,function(t,e){var r=n.hlsjs.levels[e.level],i=r.url,o=r.urlId;n.emit(b.default.Events.TRACK_SWITCH,i[o])});var o=t.constructor.Events.FRAG_LOAD_EMERGENCY_ABORTED;if(void 0===o)throw new Error("Cannot find FRAG_LOAD_EMERGENCY_ABORTED hls.js event.");n.hlsjs.on(o,function(){n.emit(b.default.Events.EMERGENCY_TRACK_SWITCH)});var s=t.constructor.Events.FPS_DROP_LEVEL_CAPPING;null!=s&&n.hlsjs.on(s,function(){n.emit(b.default.Events.DROPPED_FRAMES_ABR_CAPPING)});var a=t.constructor.Events.MANIFEST_LOADED;if(void 0===a)throw new Error("Cannot find MANIFEST_LOADED hls.js event.");var u=t.constructor.Events.LEVEL_LOADED;if(void 0===u)throw new Error("Cannot find LEVEL_LOADED hls.js event.");return n.hlsjs.on(a,function(){n._isLive=!1,(n.hlsjs.observer||n.hlsjs).once(u,function(t,e){n._isLive=e&&e.details&&e.details.live})}),n}return(0,E.default)(e,t),(0,h.default)(e,[{key:"on",value:function(t,r){(0,a.default)(b.default.Events).indexOf(t)>-1&&(0,y.default)(e.prototype.__proto__||(0,c.default)(e.prototype),"on",this).call(this,t,r)}},{key:"removeListener",value:function(t,r){(0,a.default)(b.default.Events).indexOf(t)>-1&&(0,y.default)(e.prototype.__proto__||(0,c.default)(e.prototype),"removeListener",this).call(this,t,r)}},{key:"getBufferTarget",value:function(){return this.hlsjs.config.maxBufferLength}},{key:"setBufferTarget",value:function(t){this.hlsjs.config.maxBufferSize=0,this.hlsjs.config.maxBufferLength=t}},{key:"setAbrStrategy",value:function(){this._abrStrategy=this.hlsjs.config.abrController===this.hlsjs.constructor.DefaultConfig.abrController?w.CONVENTIONAL:w.CUSTOM}},{key:"getPlayerInfo",value:function(){var t={bufferBasedABR:!1,abrStrategy:this._abrStrategy};return null!=this._playerInfo&&"object"===(0,o.default)(this._playerInfo)&&(t.playerInfo=this._playerInfo),t}},{key:"getLatency",value:function(){if(!this.hlsjs||!this.hlsjs.media)return 0;var t=this.hlsjs.media;return t.duration&&this._isLive?t.currentTime?t.duration-t.currentTime:this.hlsjs.liveSyncPosition?t.duration-this.hlsjs.liveSyncPosition:0:0}},{key:"getMediaEngineName",value:function(){return"hls.js"}},{key:"getMediaEngineVersion",value:function(){return this.hlsjs.constructor.version}}]),e}(S.default);e.default=A,t.exports=e.default},function(t,e,r){t.exports={default:r(83),__esModule:!0}},function(t,e,r){r(84),t.exports=r(0).Object.values},function(t,e,r){var n=r(5),i=r(85)(!1);n(n.S,"Object",{values:function(t){return i(t)}})},function(t,e,r){var n=r(2),i=r(19),o=r(3),s=r(21).f;t.exports=function(t){return function(e){for(var r,a=o(e),u=i(a),c=u.length,l=0,f=[];c>l;)r=u[l++],n&&!s.call(a,r)||f.push(t?[r,a[r]]:a[r]);return f}}},function(t,e,r){r(87),t.exports=r(0).Object.getPrototypeOf},function(t,e,r){var n=r(33),i=r(45);r(49)("getPrototypeOf",function(){return function(t){return i(n(t))}})},function(t,e,r){t.exports={default:r(89),__esModule:!0}},function(t,e,r){r(90);var n=r(0).Object;t.exports=function(t,e){return n.getOwnPropertyDescriptor(t,e)}},function(t,e,r){var n=r(3),i=r(36).f;r(49)("getOwnPropertyDescriptor",function(){return function(t,e){return i(n(t),e)}})},function(t,e,r){t.exports={default:r(92),__esModule:!0}},function(t,e,r){r(93),t.exports=r(0).Object.setPrototypeOf},function(t,e,r){var n=r(5);n(n.S,"Object",{setPrototypeOf:r(94).set})},function(t,e,r){var n=r(9),i=r(12),o=function(t,e){if(i(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{n=r(39)(Function.call,r(36).f(Object.prototype,"__proto__").set,2),n(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,r){return o(t,r),e?t.__proto__=r:n(t,r),t}}({},!1):void 0),check:o}},function(t,e,r){t.exports={default:r(96),__esModule:!0}},function(t,e,r){r(97);var n=r(0).Object;t.exports=function(t,e){return n.create(t,e)}},function(t,e,r){var n=r(5);n(n.S,"Object",{create:r(28)})},function(t,e,r){"use strict";function n(t){console&&console.warn}function i(){i.init.call(this)}function o(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function s(t){return void 0===t._maxListeners?i.defaultMaxListeners:t._maxListeners}function a(t,e,r,i){var a,u,c;if(o(r),u=t._events,void 0===u?(u=t._events=Object.create(null),t._eventsCount=0):(void 0!==u.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),u=t._events),c=u[e]),void 0===c)c=u[e]=r,++t._eventsCount;else if("function"==typeof c?c=u[e]=i?[r,c]:[c,r]:i?c.unshift(r):c.push(r),(a=s(t))>0&&c.length>a&&!c.warned){c.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=c.length,n(l)}return t}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=u.bind(n);return i.listener=r,n.wrapFn=i,i}function l(t,e,r){var n=t._events;if(void 0===n)return[];var i=n[e];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?p(i):d(i,i.length)}function f(t){var e=this._events;if(void 0!==e){var r=e[t];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function d(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function h(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function p(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function v(t,e){return new Promise(function(r,n){function i(){void 0!==o&&t.removeListener("error",o),r([].slice.call(arguments))}var o;"error"!==e&&(o=function(r){t.removeListener(e,i),n(r)},t.once("error",o)),t.once(e,i)})}var g,y="object"==typeof Reflect?Reflect:null,m=y&&"function"==typeof y.apply?y.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)};g=y&&"function"==typeof y.ownKeys?y.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var E=Number.isNaN||function(t){return t!==t};t.exports=i,t.exports.once=v,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var _=10;Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return _},set:function(t){if("number"!=typeof t||t<0||E(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");_=t}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||E(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},i.prototype.getMaxListeners=function(){return s(this)},i.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var n="error"===t,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[t];if(void 0===a)return!1;if("function"==typeof a)m(a,this,e);else for(var u=a.length,c=d(a,u),r=0;r<u;++r)m(c[r],this,e);return!0},i.prototype.addListener=function(t,e){return a(this,t,e,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(t,e){return a(this,t,e,!0)},i.prototype.once=function(t,e){return o(e),this.on(t,c(this,t,e)),this},i.prototype.prependOnceListener=function(t,e){return o(e),this.prependListener(t,c(this,t,e)),this},i.prototype.removeListener=function(t,e){var r,n,i,s,a;if(o(e),void 0===(n=this._events))return this;if(void 0===(r=n[t]))return this;if(r===e||r.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(i=-1,s=r.length-1;s>=0;s--)if(r[s]===e||r[s].listener===e){a=r[s].listener,i=s;break}if(i<0)return this;0===i?r.shift():h(r,i),1===r.length&&(n[t]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",t,a||e)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(t){var e,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[t]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},i.prototype.listeners=function(t){return l(this,t,!0)},i.prototype.rawListeners=function(t){return l(this,t,!1)},i.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):f.call(t,e)},i.prototype.listenerCount=f,i.prototype.eventNames=function(){return this._eventsCount>0?g(this._events):[]}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=r(15),o=n(i),s=r(4),a=n(s),u=r(11),c=n(u),l=r(22),f=n(l),d=r(37),h=n(d),p=r(23),v=n(p),g=r(14),y=n(g),m=r(50),E=n(m),_=function(t,e){var r=(0,E.default)(t,e);return function(e){function r(){return(0,a.default)(this,r),(0,f.default)(this,(r.__proto__||(0,o.default)(r)).apply(this,arguments))}return(0,v.default)(r,e),(0,c.default)(r,[{key:"load",value:function(e,n,i){t.loaderHooks.pLoader.load(e,n,i),(0,h.default)(r.prototype.__proto__||(0,o.default)(r.prototype),"load",this).call(this,e,n,i)}},{key:"abort",value:function(){t.loaderHooks.pLoader.abort(this.context),(0,h.default)(r.prototype.__proto__||(0,o.default)(r.prototype),"abort",this).call(this)}},{key:"destroy",value:function(){t.loaderHooks.pLoader.destroy(this.context),(0,h.default)(r.prototype.__proto__||(0,o.default)(r.prototype),"destroy",this).call(this)}},{key:"_contentType",get:function(){return y.default.ContentTypes.MANIFEST}}]),r}(r)};e.default=_,t.exports=e.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=r(4),o=n(i),s=r(11),a=n(s),u=function(){function t(e){(0,o.default)(this,t),e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}return(0,a.default)(t,[{key:"destroy",value:function(){this.abort(),this.loader=null}},{key:"abort",value:function(){var t=this.loader;t&&4!==t.readyState&&(this.stats.aborted=!0,t.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null}},{key:"load",value:function(t,e,r){this.context=t,this.config=e,this.callbacks=r,this.stats={trequest:performance.now(),retry:0},this.retryDelay=e.retryDelay,this.loadInternal()}},{key:"loadInternal",value:function(){var t,e=this.context;t=this.loader=new XMLHttpRequest;var r=this.stats;r.tfirst=0,r.loaded=0;var n=this.xhrSetup;try{if(n)try{n(t,e.url)}catch(r){t.open("GET",e.url,!0),n(t,e.url)}t.readyState||t.open("GET",e.url,!0)}catch(r){return void this.callbacks.onError({code:t.status,text:r.message},e,t)}e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),t.send()}},{key:"readystatechange",value:function(t){var e=t.currentTarget,r=e.readyState,n=this.stats,i=this.context,o=this.config;if(!n.aborted&&r>=2)if(window.clearTimeout(this.requestTimeout),0===n.tfirst&&(n.tfirst=Math.max(performance.now(),n.trequest)),4===r){var s=e.status;if(s>=200&&s<300){n.tload=Math.max(n.tfirst,performance.now());var a=void 0,u=void 0;"arraybuffer"===i.responseType?(a=e.response,u=a.byteLength):(a=e.responseText,u=a.length),n.loaded=n.total=u;var c={url:e.responseURL,data:a};this.callbacks.onSuccess(c,n,i,e)}else n.retry>=o.maxRetry||s>=400&&s<499?this.callbacks.onError({code:s,text:e.statusText},i,e):(this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,o.maxRetryDelay),n.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),o.timeout)}},{key:"loadtimeout",value:function(){this.callbacks.onTimeout(this.stats,this.context,null)}},{key:"loadprogress",value:function(t){var e=t.currentTarget,r=this.stats;r.loaded=t.loaded,t.lengthComputable&&(r.total=t.total);var n=this.callbacks.onProgress;n&&n(r,this.context,null,e)}}]),t}();e.default=u,t.exports=e.default},function(t,e,r){"use strict";function n(t,e,r){var n=r||{},i=e,s=new o.default({setRequestHeader:function(t,e){n[t]=e},withCredentials:!1,open:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if("GET"!==t)throw new Error("xhrSetup is calling open with a method other than GET, which is not supported at the moment. Please contact Streamroot support");if(!0!==r)throw new Error("xhrSetup is trying to open a synchronous request, which is not supported at the moment. Please contact Streamroot support");i=e},timeout:0});try{t&&t(s,e)}catch(t){throw new Error("xhrSetup is trying to acces a forbidden property/method of XHR mock. Please contact Streamroot support. Internal mock error: "+t.message)}return{headers:n,withCredentials:s.withCredentials,url:i,timeout:s.timeout}}Object.defineProperty(e,"__esModule",{value:!0}),e.extractInfoFromXhrSetup=void 0;var i=r(102),o=function(t){return t&&t.__esModule?t:{default:t}}(i);e.extractInfoFromXhrSetup=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(103),i=function(t){return t&&t.__esModule?t:{default:t}}(n),o=function(t){var e={},r=t||{};return i.default.mirrorRwProp(e,r,"responseType"),i.default.mirrorRwProp(e,r,"timeout"),i.default.mirrorRwProp(e,r,"withCredentials"),i.default.mirrorReadOnlyProp(e,r,"readyState"),i.default.mirrorReadOnlyProp(e,r,"response"),i.default.mirrorReadOnlyProp(e,r,"responseText"),i.default.mirrorReadOnlyProp(e,r,"responseURL"),i.default.mirrorReadOnlyProp(e,r,"responseXML"),i.default.mirrorReadOnlyProp(e,r,"status"),i.default.mirrorReadOnlyProp(e,r,"statusText"),i.default.mirrorReadOnlyProp(e,r,"upload"),i.default.mirrorFunc(e,r,"abort"),i.default.mirrorFunc(e,r,"open"),i.default.mirrorFunc(e,r,"send"),i.default.mirrorFunc(e,r,"setRequestHeader"),i.default.mirrorFunc(e,r,"getResponseHeader"),i.default.mirrorFunc(e,r,"overrideMimeType"),i.default.mirrorFunc(e,r,"getAllResponseHeaders"),i.default.mirrorFunc(e,r,"addEventListener"),i.default.mirrorFunc(e,r,"removeEventListener"),i.default.mirrorRwProp(e,r,"onload"),i.default.mirrorRwProp(e,r,"onloadstart"),i.default.mirrorRwProp(e,r,"onloadend"),i.default.mirrorRwProp(e,r,"onabort"),i.default.mirrorRwProp(e,r,"onerror"),i.default.mirrorRwProp(e,r,"onprogress"),i.default.mirrorRwProp(e,r,"ontimeout"),i.default.mirrorRwProp(e,r,"onreadystatechange"),e};e.default=o,t.exports=e.default},function(t,e,r){"use strict";function n(t,e){if(void 0===t[e])throw new Error("Requiring undefined property on source object: "+e)}function i(t,e,r,i){if(i){var o=i(t,e,r);if(o.override)return o.value}return n(e,r),e[r]}function o(t,e,r,i,o){o&&o(t,e,r,i).override||(n(r,i),r[i]=t)}function s(t,e,r,n){(0,l.default)(t,r,{get:function(){return i(t,e,r,n)},configurable:!0})}function a(t,e,r,n,s){(0,l.default)(t,r,{get:function(){return i(t,e,r,s)},set:function(i){return o(i,t,e,r,n)},configurable:!0})}function u(t,e,r){t[r]=function(){return n(e,r),e[r].apply(e,arguments)}}var c=r(48),l=function(t){return t&&t.__esModule?t:{default:t}}(c);t.exports={mirrorFunc:u,mirrorRwProp:a,mirrorReadOnlyProp:s}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=r(15),o=n(i),s=r(4),a=n(s),u=r(11),c=n(u),l=r(22),f=n(l),d=r(37),h=n(d),p=r(23),v=n(p),g=r(14),y=n(g),m=r(50),E=n(m),_=function(t,e){var r=(0,E.default)(t,e);return function(e){function r(){return(0,a.default)(this,r),(0,f.default)(this,(r.__proto__||(0,o.default)(r)).apply(this,arguments))}return(0,v.default)(r,e),(0,c.default)(r,[{key:"load",value:function(e,n,i){t.loaderHooks.fLoader.load(e,n,i),(0,h.default)(r.prototype.__proto__||(0,o.default)(r.prototype),"load",this).call(this,e,n,i)}},{key:"abort",value:function(){t.loaderHooks.fLoader.abort(this.context),(0,h.default)(r.prototype.__proto__||(0,o.default)(r.prototype),"abort",this).call(this)}},{key:"destroy",value:function(){t.loaderHooks.fLoader.destroy(this.context),(0,h.default)(r.prototype.__proto__||(0,o.default)(r.prototype),"destroy",this).call(this)}},{key:"_modifyRequestTiming",value:function(t){this.stats.trequest=this.stats.tload-t.timeElapsed,this.stats.tfirst=this.stats.trequest+t.latency}},{key:"_contentType",get:function(){return"initSegment"===this.context.frag.sn&&"main"===this.context.frag.type?y.default.ContentTypes.INIT_SEGMENT:"main"===this.context.frag.type?y.default.ContentTypes.MEDIA_SEGMENT:y.default.ContentTypes.OTHER}}]),r}(r)};e.default=_,t.exports=e.default},function(t,e,r){"use strict";function n(t,e){t.attachMediaElement=e.attachMediaElement.bind(e),t.detachMediaElement=e.detachMediaElement.bind(e),Object.defineProperty(t,"dnaDownloadEnabled",{get:function(){return e.dnaDownloadEnabled},set:function(t){e.dnaDownloadEnabled=t}}),Object.defineProperty(t,"dnaUploadEnabled",{get:function(){return e.dnaUploadEnabled},set:function(t){e.dnaUploadEnabled=t}}),Object.defineProperty(t,"id",{get:function(){return e.id}}),Object.defineProperty(t,"stats",{get:function(){return e.stats}}),Object.defineProperty(t,"status",{get:function(){return e.status}}),Object.defineProperty(t,"versions",{get:function(){return e.versions}})}Object.defineProperty(e,"__esModule",{value:!0}),e.mapStreamrooterInterface=n}])})},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t){for(var e=t.split("&"),r={},n=0;n<e.length;n++){var i=e[n].split("="),o=decodeURIComponent(i[0]),s=i.length>1?decodeURIComponent(i[1]):null;r[o]=s}return r}function o(){if(!u||!u.src)return null;var t=(0,a.default)(u.src);return i((""!==t.query?t.query:t.hash).substring(1))}Object.defineProperty(e,"__esModule",{value:!0}),e.getFragmentParameters=void 0;var s=r(6),a=n(s),u=document.currentScript;e.getFragmentParameters=o},function(t,e,r){!function(e,r){t.exports=r()}(0,function(){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=7)}([function(t,e,r){"use strict";function n(){}function i(t,e){return e="["+t+"] > "+e}function o(t){var e=self.console[t];return e?function(){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];n[0]&&(n[0]=i(t,n[0])),e.apply(self.console,n)}:n}function s(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];r.forEach(function(e){c[e]=t[e]?t[e].bind(t):o(e)})}r.d(e,"a",function(){return l}),r.d(e,"b",function(){return f});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u={trace:n,debug:n,log:n,warn:n,info:n,error:n},c=u,l=function(t){if(!0===t||"object"===(void 0===t?"undefined":a(t))){s(t,"debug","log","info","warn","error");try{c.log()}catch(t){c=u}}else c=u},f=c},function(t,e,r){"use strict";e.a={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCH:"hlsLevelSwitch",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCH:"hlsAudioTrackSwitch",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},function(t,e,r){"use strict";r.d(e,"b",function(){return n}),r.d(e,"a",function(){return i});var n={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},i={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(){n(this,t)}return t.isHeader=function(t,e){return e+10<=t.length&&73===t[e]&&68===t[e+1]&&51===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128},t.isFooter=function(t,e){return e+10<=t.length&&51===t[e]&&68===t[e+1]&&73===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128},t.getID3Data=function(e,r){for(var n=r,i=0;t.isHeader(e,r);){i+=10;i+=t._readSize(e,r+6),t.isFooter(e,r+10)&&(i+=10),r+=i}if(i>0)return e.subarray(n,n+i)},t._readSize=function(t,e){var r=0;return r=(127&t[e])<<21,r|=(127&t[e+1])<<14,r|=(127&t[e+2])<<7,r|=127&t[e+3]},t.getTimeStamp=function(e){for(var r=t.getID3Frames(e),n=0;n<r.length;n++){var i=r[n];if(t.isTimeStampFrame(i))return t._readTimeStamp(i)}},t.isTimeStampFrame=function(t){return t&&"PRIV"===t.key&&"com.apple.streaming.transportStreamTimestamp"===t.info},t._getFrameData=function(e){var r=String.fromCharCode(e[0],e[1],e[2],e[3]),n=t._readSize(e,4),i=10;return{type:r,size:n,data:e.subarray(i,i+n)}},t.getID3Frames=function(e){for(var r=0,n=[];t.isHeader(e,r);){var i=t._readSize(e,r+6);r+=10;for(var o=r+i;r+8<o;){var s=t._getFrameData(e.subarray(r)),a=t._decodeFrame(s);a&&n.push(a),r+=s.size+10}t.isFooter(e,r)&&(r+=10)}return n},t._decodeFrame=function(e){return"PRIV"===e.type?t._decodePrivFrame(e):"T"===e.type[0]?t._decodeTextFrame(e):"W"===e.type[0]?t._decodeURLFrame(e):void 0},t._readTimeStamp=function(t){if(8===t.data.byteLength){var e=new Uint8Array(t.data),r=1&e[3],n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,r&&(n+=47721858.84),Math.round(n)}},t._decodePrivFrame=function(e){if(!(e.size<2)){var r=t._utf8ArrayToStr(e.data),n=new Uint8Array(e.data.subarray(r.length+1));return{key:e.type,info:r,data:n.buffer}}},t._decodeTextFrame=function(e){if(!(e.size<2)){if("TXXX"===e.type){var r=1,n=t._utf8ArrayToStr(e.data.subarray(r));r+=n.length+1;var i=t._utf8ArrayToStr(e.data.subarray(r));return{key:e.type,info:n,data:i}}var o=t._utf8ArrayToStr(e.data.subarray(1));return{key:e.type,data:o}}},t._decodeURLFrame=function(e){if("WXXX"===e.type){if(e.size<2)return;var r=1,n=t._utf8ArrayToStr(e.data.subarray(r));r+=n.length+1;var i=t._utf8ArrayToStr(e.data.subarray(r));return{key:e.type,info:n,data:i}}var o=t._utf8ArrayToStr(e.data);return{key:e.type,data:o}},t._utf8ArrayToStr=function(t){for(var e=void 0,r=void 0,n="",i=0,o=t.length;i<o;){var s=t[i++];switch(s>>4){case 0:return n;case 1:case 2:case 3:case 4:case 5:case 6:case 7:n+=String.fromCharCode(s);break;case 12:case 13:e=t[i++],n+=String.fromCharCode((31&s)<<6|63&e);break;case 14:e=t[i++],r=t[i++],n+=String.fromCharCode((15&s)<<12|(63&e)<<6|(63&r)<<0)}}return n},t}();e.a=i},function(t,e){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function i(t){return"number"==typeof t}function o(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!i(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,r,i,a,u,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var l=new Error('Uncaught, unspecified "error" event. ('+e+")");throw l.context=e,l}if(r=this._events[t],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),r.apply(this,a)}else if(o(r))for(a=Array.prototype.slice.call(arguments,1),c=r.slice(),i=c.length,u=0;u<i;u++)c[u].apply(this,a);return!0},r.prototype.addListener=function(t,e){var i;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned&&(i=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&i>0&&this._events[t].length>i&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function r(){this.removeListener(t,r),i||(i=!0,e.apply(this,arguments))}if(!n(e))throw TypeError("listener must be a function");var i=!1;return r.listener=e,this.on(t,r),this},r.prototype.removeListener=function(t,e){var r,i,s,a;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],s=r.length,i=-1,r===e||n(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(r)){for(a=s;a-- >0;)if(r[a]===e||r[a].listener&&r[a].listener===e){i=a;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],n(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){return this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,r){!function(e){var r=/^((?:[^\/;?#]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,n=/^([^\/;?#]*)(.*)$/,i=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,s={buildAbsoluteURL:function(t,e,r){if(r=r||{},t=t.trim(),!(e=e.trim())){if(!r.alwaysNormalize)return t;var i=this.parseURL(t);if(!a)throw new Error("Error trying to parse base URL.");return i.path=s.normalizePath(i.path),s.buildURLFromParts(i)}var o=this.parseURL(e);if(!o)throw new Error("Error trying to parse relative URL.");if(o.scheme)return r.alwaysNormalize?(o.path=s.normalizePath(o.path),s.buildURLFromParts(o)):e;var a=this.parseURL(t);if(!a)throw new Error("Error trying to parse base URL.");if(!a.netLoc&&a.path&&"/"!==a.path[0]){var u=n.exec(a.path);a.netLoc=u[1],a.path=u[2]}a.netLoc&&!a.path&&(a.path="/");var c={scheme:a.scheme,netLoc:o.netLoc,path:null,params:o.params,query:o.query,fragment:o.fragment};if(!o.netLoc&&(c.netLoc=a.netLoc,"/"!==o.path[0]))if(o.path){var l=a.path,f=l.substring(0,l.lastIndexOf("/")+1)+o.path;c.path=s.normalizePath(f)}else c.path=a.path,o.params||(c.params=a.params,o.query||(c.query=a.query));return null===c.path&&(c.path=r.alwaysNormalize?s.normalizePath(o.path):o.path),s.buildURLFromParts(c)},parseURL:function(t){var e=r.exec(t);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(t){for(t=t.split("").reverse().join("").replace(i,"");t.length!==(t=t.replace(o,"")).length;);return t.split("").reverse().join("")},buildURLFromParts:function(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}};t.exports=s}()},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e,r,n){var i,o,s,a,u,c=navigator.userAgent.toLowerCase(),l=n,f=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];return i=1+((192&e[r+2])>>>6),(o=(60&e[r+2])>>>2)>f.length-1?void t.trigger(Event.ERROR,{type:L.b.MEDIA_ERROR,details:L.a.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+o}):(a=(1&e[r+2])<<2,a|=(192&e[r+3])>>>6,x.b.log("manifest codec:"+n+",ADTS data:type:"+i+",sampleingIndex:"+o+"["+f[o]+"Hz],channelConfig:"+a),/firefox/i.test(c)?o>=6?(i=5,u=new Array(4),s=o-3):(i=2,u=new Array(2),s=o):-1!==c.indexOf("android")?(i=2,u=new Array(2),s=o):(i=5,u=new Array(4),n&&(-1!==n.indexOf("mp4a.40.29")||-1!==n.indexOf("mp4a.40.5"))||!n&&o>=6?s=o-3:((n&&-1!==n.indexOf("mp4a.40.2")&&(o>=6&&1===a||/vivaldi/i.test(c))||!n&&1===a)&&(i=2,u=new Array(2)),s=o)),u[0]=i<<3,u[0]|=(14&o)>>1,u[1]|=(1&o)<<7,u[1]|=a<<3,5===i&&(u[1]|=(14&s)>>1,u[2]=(1&s)<<7,u[2]|=8,u[3]=0),{config:u,samplerate:f[o],channelCount:a,codec:"mp4a.40."+i,manifestCodec:l})}function u(t,e){return 255===t[e]&&240==(246&t[e+1])}function c(t,e){return 1&t[e+1]?7:9}function l(t,e){return(3&t[e+3])<<11|t[e+4]<<3|(224&t[e+5])>>>5}function f(t,e){return!!(e+1<t.length&&u(t,e))}function d(t,e){if(e+1<t.length&&u(t,e)){var r=c(t,e),n=r;e+5<t.length&&(n=l(t,e));var i=e+n;if(i===t.length||i+1<t.length&&u(t,i))return!0}return!1}function h(t,e,r,n,i){if(!t.samplerate){var o=a(e,r,n,i);t.config=o.config,t.samplerate=o.samplerate,t.channelCount=o.channelCount,t.codec=o.codec,t.manifestCodec=o.manifestCodec,x.b.log("parsed codec:"+t.codec+",rate:"+o.samplerate+",nb channel:"+o.channelCount)}}function p(t){return 9216e4/t}function v(t,e,r,n,i){var o,s,a,u=t.length;if(o=c(t,e),s=l(t,e),(s-=o)>0&&e+o+s<=u)return a=r+n*i,{headerLength:o,frameLength:s,stamp:a}}function g(t,e,r,n,i){var o=p(t.samplerate),s=v(e,r,n,i,o);if(s){var a=s.stamp,u=s.headerLength,c=s.frameLength,l={unit:e.subarray(r+u,r+u+c),pts:a,dts:a};return t.samples.push(l),t.len+=c,{sample:l,length:c+u}}}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function D(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var O=r(1),L=r(2),C=function(){function t(e,r){n(this,t),this.subtle=e,this.aesIV=r}return t.prototype.decrypt=function(t,e){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t)},t}(),I=C,P=function(){function t(e,r){i(this,t),this.subtle=e,this.key=r}return t.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},t}(),M=P,N=function(){function t(){o(this,t),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return t.prototype.uint8ArrayToUint32Array_=function(t){for(var e=new DataView(t),r=new Uint32Array(4),n=0;n<4;n++)r[n]=e.getUint32(4*n);return r},t.prototype.initTable=function(){var t=this.sBox,e=this.invSBox,r=this.subMix,n=r[0],i=r[1],o=r[2],s=r[3],a=this.invSubMix,u=a[0],c=a[1],l=a[2],f=a[3],d=new Uint32Array(256),h=0,p=0,v=0;for(v=0;v<256;v++)d[v]=v<128?v<<1:v<<1^283;for(v=0;v<256;v++){var g=p^p<<1^p<<2^p<<3^p<<4;g=g>>>8^255&g^99,t[h]=g,e[g]=h;var y=d[h],m=d[y],E=d[m],_=257*d[g]^16843008*g;n[h]=_<<24|_>>>8,i[h]=_<<16|_>>>16,o[h]=_<<8|_>>>24,s[h]=_,_=16843009*E^65537*m^257*y^16843008*h,u[g]=_<<24|_>>>8,c[g]=_<<16|_>>>16,l[g]=_<<8|_>>>24,f[g]=_,h?(h=y^d[d[d[E^y]]],p^=d[d[p]]):h=p=1}},t.prototype.expandKey=function(t){for(var e=this.uint8ArrayToUint32Array_(t),r=!0,n=0;n<e.length&&r;)r=e[n]===this.key[n],n++;if(!r){this.key=e;var i=this.keySize=e.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);var o=this.ksRows=4*(i+6+1),s=void 0,a=void 0,u=this.keySchedule=new Uint32Array(o),c=this.invKeySchedule=new Uint32Array(o),l=this.sBox,f=this.rcon,d=this.invSubMix,h=d[0],p=d[1],v=d[2],g=d[3],y=void 0,m=void 0;for(s=0;s<o;s++)s<i?y=u[s]=e[s]:(m=y,s%i==0?(m=m<<8|m>>>24,m=l[m>>>24]<<24|l[m>>>16&255]<<16|l[m>>>8&255]<<8|l[255&m],m^=f[s/i|0]<<24):i>6&&s%i==4&&(m=l[m>>>24]<<24|l[m>>>16&255]<<16|l[m>>>8&255]<<8|l[255&m]),u[s]=y=(u[s-i]^m)>>>0);for(a=0;a<o;a++)s=o-a,m=3&a?u[s]:u[s-4],c[a]=a<4||s<=4?m:h[l[m>>>24]]^p[l[m>>>16&255]]^v[l[m>>>8&255]]^g[l[255&m]],c[a]=c[a]>>>0}},t.prototype.networkToHostOrderSwap=function(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24},t.prototype.decrypt=function(t,e,r){for(var n,i,o=this.keySize+6,s=this.invKeySchedule,a=this.invSBox,u=this.invSubMix,c=u[0],l=u[1],f=u[2],d=u[3],h=this.uint8ArrayToUint32Array_(r),p=h[0],v=h[1],g=h[2],y=h[3],m=new Int32Array(t),E=new Int32Array(m.length),_=void 0,b=void 0,T=void 0,S=void 0,w=void 0,A=void 0,R=void 0,D=void 0,O=void 0,L=void 0,C=void 0,I=void 0,P=this.networkToHostOrderSwap;e<m.length;){for(O=P(m[e]),L=P(m[e+1]),C=P(m[e+2]),I=P(m[e+3]),w=O^s[0],A=I^s[1],R=C^s[2],D=L^s[3],n=4,i=1;i<o;i++)_=c[w>>>24]^l[A>>16&255]^f[R>>8&255]^d[255&D]^s[n],b=c[A>>>24]^l[R>>16&255]^f[D>>8&255]^d[255&w]^s[n+1],T=c[R>>>24]^l[D>>16&255]^f[w>>8&255]^d[255&A]^s[n+2],S=c[D>>>24]^l[w>>16&255]^f[A>>8&255]^d[255&R]^s[n+3],w=_,A=b,R=T,D=S,n+=4;_=a[w>>>24]<<24^a[A>>16&255]<<16^a[R>>8&255]<<8^a[255&D]^s[n],b=a[A>>>24]<<24^a[R>>16&255]<<16^a[D>>8&255]<<8^a[255&w]^s[n+1],T=a[R>>>24]<<24^a[D>>16&255]<<16^a[w>>8&255]<<8^a[255&A]^s[n+2],S=a[D>>>24]<<24^a[w>>16&255]<<16^a[A>>8&255]<<8^a[255&R]^s[n+3],n+=3,E[e]=P(_^p),E[e+1]=P(S^v),E[e+2]=P(T^g),E[e+3]=P(b^y),p=O,v=L,g=C,y=I,e+=4}return E.buffer},t.prototype.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},t}(),k=N,x=r(0),F=function(){function t(e,r){s(this,t),this.observer=e,this.config=r,this.logEnabled=!0;try{var n=crypto||self.crypto;this.subtle=n.subtle||n.webkitSubtle}catch(t){}this.disableWebCrypto=!this.subtle}return t.prototype.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},t.prototype.decrypt=function(t,e,r,n){var i=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(x.b.log("JS AES decrypt"),this.logEnabled=!1);var o=this.decryptor;o||(this.decryptor=o=new k),o.expandKey(e),n(o.decrypt(t,0,r))}else{this.logEnabled&&(x.b.log("WebCrypto AES decrypt"),this.logEnabled=!1);var s=this.subtle;this.key!==e&&(this.key=e,this.fastAesKey=new M(s,e)),this.fastAesKey.expandKey().then(function(o){new I(s,r).decrypt(t,o).catch(function(o){i.onWebCryptoError(o,t,e,r,n)}).then(function(t){n(t)})}).catch(function(o){i.onWebCryptoError(o,t,e,r,n)})}},t.prototype.onWebCryptoError=function(t,e,r,n,i){this.config.enableSoftwareAES?(x.b.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(e,r,n,i)):(x.b.error("decrypting error : "+t.message),this.observer.trigger(Event.ERROR,{type:L.b.MEDIA_ERROR,details:L.a.FRAG_DECRYPT_ERROR,fatal:!0,reason:t.message}))},t.prototype.destroy=function(){var t=this.decryptor;t&&(t.destroy(),this.decryptor=void 0)},t}(),U=F,B=r(3),j=function(){function t(e,r,n){y(this,t),this.observer=e,this.config=n,this.remuxer=r}return t.prototype.resetInitSegment=function(t,e,r,n){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:e,duration:n,inputTimeScale:9e4}},t.prototype.resetTimeStamp=function(){},t.probe=function(t){var e,r,n=B.a.getID3Data(t,0);if(n&&void 0!==B.a.getTimeStamp(n))for(e=n.length,r=Math.min(t.length-1,e+100);e<r;e++)if(d(t,e))return x.b.log("ADTS sync word found !"),!0;return!1},t.prototype.append=function(t,e,r,n){for(var i=this._audioTrack,o=B.a.getID3Data(t,0),s=90*B.a.getTimeStamp(o),a=0,u=s,c=t.length,l=o.length,d=[{pts:u,dts:u,data:o}];l<c-1;)if(f(t,l)&&l+5<c){h(i,this.observer,t,l,i.manifestCodec);var p=g(i,t,l,s,a);if(!p){x.b.log("Unable to parse AAC frame");break}l+=p.length,u=p.sample.pts,a++}else B.a.isHeader(t,l)?(o=B.a.getID3Data(t,l),d.push({pts:u,dts:u,data:o}),l+=o.length):l++;this.remuxer.remux(i,{samples:[]},{samples:d,inputTimeScale:9e4},{samples:[]},e,r,n)},t.prototype.destroy=function(){},t}(),G=j,H=Math.pow(2,32)-1,V=function(){function t(e,r){m(this,t),this.observer=e,this.remuxer=r}return t.prototype.resetTimeStamp=function(t){this.initPTS=t},t.prototype.resetInitSegment=function(e,r,n,i){if(e&&e.byteLength){var o=this.initData=t.parseInitSegment(e),s={};o.audio&&o.video?s.audiovideo={container:"video/mp4",codec:r+","+n,initSegment:i?e:null}:(o.audio&&(s.audio={container:"audio/mp4",codec:r,initSegment:i?e:null}),o.video&&(s.video={container:"video/mp4",codec:n,initSegment:i?e:null})),this.observer.trigger(O.a.FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else r&&(this.audioCodec=r),n&&(this.videoCodec=n)},t.probe=function(e){if(e.length>=8){return["moof","ftyp","styp"].indexOf(t.bin2str(e.subarray(4,8)))>=0}return!1},t.bin2str=function(t){return String.fromCharCode.apply(null,t)},t.readUint32=function(t,e){t.data&&(e+=t.start,t=t.data);var r=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3];return r<0?4294967296+r:r},t.writeUint32=function(t,e,r){t.data&&(e+=t.start,t=t.data),t[e]=r>>24,t[e+1]=r>>16&255,t[e+2]=r>>8&255,t[e+3]=255&r},t.findBox=function(e,r){var n,i,o,s,a,u,c,l=[];if(e.data?(u=e.start,s=e.end,e=e.data):(u=0,s=e.byteLength),!r.length)return null;for(n=u;n<s;)i=t.readUint32(e,n),o=t.bin2str(e.subarray(n+4,n+8)),c=i>1?n+i:s,o===r[0]&&(1===r.length?l.push({data:e,start:n+8,end:c}):(a=t.findBox({data:e,start:n+8,end:c},r.slice(1)),a.length&&(l=l.concat(a)))),n=c;return l},t.parseInitSegment=function(e){var r=[];return t.findBox(e,["moov","trak"]).forEach(function(e){var n=t.findBox(e,["tkhd"])[0];if(n){var i=n.data[n.start],o=0===i?12:20,s=t.readUint32(n,o),a=t.findBox(e,["mdia","mdhd"])[0];if(a){i=a.data[a.start],o=0===i?12:20;var u=t.readUint32(a,o),c=t.findBox(e,["mdia","hdlr"])[0];if(c){var l=t.bin2str(c.data.subarray(c.start+8,c.start+12)),f={soun:"audio",vide:"video"}[l];f&&(r[s]={timescale:u,type:f},r[f]={timescale:u,id:s})}}}}),r},t.getStartDTS=function(e,r){var n,i,o;return n=t.findBox(r,["moof","traf"]),i=[].concat.apply([],n.map(function(r){return t.findBox(r,["tfhd"]).map(function(n){var i,o;return i=t.readUint32(n,4),o=e[i].timescale||9e4,t.findBox(r,["tfdt"]).map(function(e){var r,n;return r=e.data[e.start],n=t.readUint32(e,4),1===r&&(n*=Math.pow(2,32),n+=t.readUint32(e,8)),n})[0]/o})})),o=Math.min.apply(null,i),isFinite(o)?o:0},t.offsetStartDTS=function(e,r,n){t.findBox(r,["moof","traf"]).map(function(r){return t.findBox(r,["tfhd"]).map(function(i){var o=t.readUint32(i,4),s=e[o].timescale||9e4;t.findBox(r,["tfdt"]).map(function(e){var r=e.data[e.start],i=t.readUint32(e,4);if(0===r)t.writeUint32(e,4,i-n*s);else{i*=Math.pow(2,32),i+=t.readUint32(e,8),i-=n*s;var o=Math.floor(i/(H+1)),a=Math.floor(i%(H+1));t.writeUint32(e,4,o),t.writeUint32(e,8,a)}})})})},t.prototype.append=function(e,r,n,i){var o=this.initData;o||(this.resetInitSegment(e,this.audioCodec,this.videoCodec),o=this.initData);var s=void 0,a=this.initPTS;if(void 0===a){var u=t.getStartDTS(o,e);this.initPTS=a=u-r,this.observer.trigger(O.a.INIT_PTS_FOUND,{initPTS:a})}t.offsetStartDTS(o,e,a),s=t.getStartDTS(o,e),this.remuxer.remux(o.audio,o.video,null,null,s,n,i,e)},t.prototype.destroy=function(){},t}(),q=V,W={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],appendFrame:function(t,e,r,n,i){if(!(r+24>e.length)){var o=this.parseHeader(e,r);if(o&&r+o.frameLength<=e.length){var s=10368e4/o.sampleRate,a=n+i*s,u={unit:e.subarray(r,r+o.frameLength),pts:a,dts:a};return t.config=[],t.channelCount=o.channelCount,t.samplerate=o.sampleRate,t.samples.push(u),t.len+=o.frameLength,{sample:u,length:o.frameLength}}}},parseHeader:function(t,e){var r=t[e+1]>>3&3,n=t[e+1]>>1&3,i=t[e+2]>>4&15,o=t[e+2]>>2&3,s=!!(2&t[e+2]);if(1!==r&&0!==i&&15!==i&&3!==o){var a=3===r?3-n:3===n?3:4,u=1e3*W.BitratesMap[14*a+i-1],c=3===r?0:2===r?1:2,l=W.SamplingRateMap[3*c+o],f=s?1:0;return{sampleRate:l,channelCount:t[e+3]>>6==3?1:2,frameLength:3===n?(3===r?12:6)*u/l+f<<2:(3===r?144:72)*u/l+f|0}}},isHeaderPattern:function(t,e){return 255===t[e]&&224==(224&t[e+1])&&0!=(6&t[e+1])},isHeader:function(t,e){return!!(e+1<t.length&&this.isHeaderPattern(t,e))},probe:function(t,e){if(e+1<t.length&&this.isHeaderPattern(t,e)){var r=4,n=this.parseHeader(t,e),i=r;n&&n.frameLength&&(i=n.frameLength);var o=e+i;if(o===t.length||o+1<t.length&&this.isHeaderPattern(t,o))return!0}return!1}},Y=W,K=function(){function t(e){E(this,t),this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}return t.prototype.loadWord=function(){var t=this.data,e=this.bytesAvailable,r=t.byteLength-e,n=new Uint8Array(4),i=Math.min(4,e);if(0===i)throw new Error("no bytes available");n.set(t.subarray(r,r+i)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i},t.prototype.skipBits=function(t){var e;this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(t-=this.bitsAvailable,e=t>>3,t-=e>>3,this.bytesAvailable-=e,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)},t.prototype.readBits=function(t){var e=Math.min(this.bitsAvailable,t),r=this.word>>>32-e;return t>32&&x.b.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,this.bitsAvailable>0?this.word<<=e:this.bytesAvailable>0&&this.loadWord(),e=t-e,e>0&&this.bitsAvailable?r<<e|this.readBits(e):r},t.prototype.skipLZ=function(){var t;for(t=0;t<this.bitsAvailable;++t)if(0!=(this.word&2147483648>>>t))return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()},t.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())},t.prototype.readUEG=function(){var t=this.skipLZ();return this.readBits(t+1)-1},t.prototype.readEG=function(){var t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)},t.prototype.readBoolean=function(){return 1===this.readBits(1)},t.prototype.readUByte=function(){return this.readBits(8)},t.prototype.readUShort=function(){return this.readBits(16)},t.prototype.readUInt=function(){return this.readBits(32)},t.prototype.skipScalingList=function(t){var e,r,n=8,i=8;for(e=0;e<t;e++)0!==i&&(r=this.readEG(),i=(n+r+256)%256),n=0===i?n:i},t.prototype.readSPS=function(){var t,e,r,n,i,o,s,a=0,u=0,c=0,l=0,f=this.readUByte.bind(this),d=this.readBits.bind(this),h=this.readUEG.bind(this),p=this.readBoolean.bind(this),v=this.skipBits.bind(this),g=this.skipEG.bind(this),y=this.skipUEG.bind(this),m=this.skipScalingList.bind(this);if(f(),t=f(),d(5),v(3),f(),y(),100===t||110===t||122===t||244===t||44===t||83===t||86===t||118===t||128===t){var E=h();if(3===E&&v(1),y(),y(),v(1),p())for(o=3!==E?8:12,s=0;s<o;s++)p()&&m(s<6?16:64)}y();var _=h();if(0===_)h();else if(1===_)for(v(1),g(),g(),e=h(),s=0;s<e;s++)g();y(),v(1),r=h(),n=h(),i=d(1),0===i&&v(1),v(1),p()&&(a=h(),u=h(),c=h(),l=h());var b=[1,1];if(p()&&p()){switch(f()){case 1:b=[1,1];break;case 2:b=[12,11];break;case 3:b=[10,11];break;case 4:b=[16,11];break;case 5:b=[40,33];break;case 6:b=[24,11];break;case 7:b=[20,11];break;case 8:b=[32,11];break;case 9:b=[80,33];break;case 10:b=[18,11];break;case 11:b=[15,11];break;case 12:b=[64,33];break;case 13:b=[160,99];break;case 14:b=[4,3];break;case 15:b=[3,2];break;case 16:b=[2,1];break;case 255:b=[f()<<8|f(),f()<<8|f()]}}return{width:Math.ceil(16*(r+1)-2*a-2*u),height:(2-i)*(n+1)*16-(i?2:4)*(c+l),pixelRatio:b}},t.prototype.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},t}(),z=K,X=function(){function t(e,r,n,i){_(this,t),this.decryptdata=n,this.discardEPB=i,this.decrypter=new U(e,r)}return t.prototype.decryptBuffer=function(t,e){this.decrypter.decrypt(t,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,e)},t.prototype.decryptAacSample=function(t,e,r,n){var i=t[e].unit,o=i.subarray(16,i.length-i.length%16),s=o.buffer.slice(o.byteOffset,o.byteOffset+o.length),a=this;this.decryptBuffer(s,function(o){o=new Uint8Array(o),i.set(o,16),n||a.decryptAacSamples(t,e+1,r)})},t.prototype.decryptAacSamples=function(t,e,r){for(;;e++){if(e>=t.length)return void r();if(!(t[e].unit.length<32)){var n=this.decrypter.isSync();if(this.decryptAacSample(t,e,r,n),!n)return}}},t.prototype.getAvcEncryptedData=function(t){for(var e=16*Math.floor((t.length-48)/160)+16,r=new Int8Array(e),n=0,i=32;i<=t.length-16;i+=160,n+=16)r.set(t.subarray(i,i+16),n);return r},t.prototype.getAvcDecryptedUnit=function(t,e){e=new Uint8Array(e);for(var r=0,n=32;n<=t.length-16;n+=160,r+=16)t.set(e.subarray(r,r+16),n);return t},t.prototype.decryptAvcSample=function(t,e,r,n,i,o){var s=this.discardEPB(i.data),a=this.getAvcEncryptedData(s),u=this;this.decryptBuffer(a.buffer,function(a){i.data=u.getAvcDecryptedUnit(s,a),o||u.decryptAvcSamples(t,e,r+1,n)})},t.prototype.decryptAvcSamples=function(t,e,r,n){for(;;e++,r=0){if(e>=t.length)return void n();for(var i=t[e].units;!(r>=i.length);r++){var o=i[r];if(!(o.length<=48||1!==o.type&&5!==o.type)){var s=this.decrypter.isSync();if(this.decryptAvcSample(t,e,r,n,o,s),!s)return}}}},t}(),Q=X,$=function(){function t(e,r,n,i){b(this,t),this.observer=e,this.config=n,this.typeSupported=i,this.remuxer=r,this.sampleAes=null}return t.prototype.setDecryptData=function(t){null!=t&&null!=t.key&&"SAMPLE-AES"===t.method?this.sampleAes=new Q(this.observer,this.config,t,this.discardEPB):this.sampleAes=null},t.probe=function(t){return t.length>=564&&71===t[0]&&71===t[188]&&71===t[376]},t.prototype.resetInitSegment=function(t,e,r,n){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack={container:"video/mp2t",type:"video",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:0},this._audioTrack={container:"video/mp2t",type:"audio",id:-1,inputTimeScale:9e4,duration:n,sequenceNumber:0,samples:[],len:0,isAAC:!0},this._id3Track={type:"id3",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0},this._txtTrack={type:"text",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0},this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=e,this.videoCodec=r,this._duration=n},t.prototype.resetTimeStamp=function(){},t.prototype.append=function(t,e,r,n){var i,o,s,a,u,c=t.length,l=!1;this.contiguous=r;var f=this.pmtParsed,d=this._avcTrack,h=this._audioTrack,p=this._id3Track,v=d.id,g=h.id,y=p.id,m=this._pmtId,E=d.pesData,_=h.pesData,b=p.pesData,T=this._parsePAT,S=this._parsePMT,w=this._parsePES,A=this._parseAVCPES.bind(this),R=this._parseAACPES.bind(this),D=this._parseMPEGPES.bind(this),C=this._parseID3PES.bind(this);for(c-=c%188,i=0;i<c;i+=188)if(71===t[i]){if(o=!!(64&t[i+1]),s=((31&t[i+1])<<8)+t[i+2],(48&t[i+3])>>4>1){if((a=i+5+t[i+4])===i+188)continue}else a=i+4;switch(s){case v:o&&(E&&(u=w(E))&&A(u,!1),E={data:[],size:0}),E&&(E.data.push(t.subarray(a,i+188)),E.size+=i+188-a);break;case g:o&&(_&&(u=w(_))&&(h.isAAC?R(u):D(u)),_={data:[],size:0}),_&&(_.data.push(t.subarray(a,i+188)),_.size+=i+188-a);break;case y:o&&(b&&(u=w(b))&&C(u),b={data:[],size:0}),b&&(b.data.push(t.subarray(a,i+188)),b.size+=i+188-a);break;case 0:o&&(a+=t[a]+1),m=this._pmtId=T(t,a);break;case m:o&&(a+=t[a]+1);var I=S(t,a,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);v=I.avc,v>0&&(d.id=v),g=I.audio,g>0&&(h.id=g,h.isAAC=I.isAAC),y=I.id3,y>0&&(p.id=y),l&&!f&&(x.b.log("reparse from beginning"),l=!1,i=-188),f=this.pmtParsed=!0;break;case 17:case 8191:break;default:l=!0}}else this.observer.trigger(O.a.ERROR,{type:L.b.MEDIA_ERROR,details:L.a.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});E&&(u=w(E))?(A(u,!0),d.pesData=null):d.pesData=E,_&&(u=w(_))?(h.isAAC?R(u):D(u),h.pesData=null):(_&&_.size&&x.b.log("last AAC PES packet truncated,might overlap between fragments"),h.pesData=_),b&&(u=w(b))?(C(u),p.pesData=null):p.pesData=b,null==this.sampleAes?this.remuxer.remux(h,d,p,this._txtTrack,e,r,n):this.decryptAndRemux(h,d,p,this._txtTrack,e,r,n)},t.prototype.decryptAndRemux=function(t,e,r,n,i,o,s){if(t.samples&&t.isAAC){var a=this;this.sampleAes.decryptAacSamples(t.samples,0,function(){a.decryptAndRemuxAvc(t,e,r,n,i,o,s)})}else this.decryptAndRemuxAvc(t,e,r,n,i,o,s)},t.prototype.decryptAndRemuxAvc=function(t,e,r,n,i,o,s){if(e.samples){var a=this;this.sampleAes.decryptAvcSamples(e.samples,0,0,function(){a.remuxer.remux(t,e,r,n,i,o,s)})}else this.remuxer.remux(t,e,r,n,i,o,s)},t.prototype.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},t.prototype._parsePAT=function(t,e){return(31&t[e+10])<<8|t[e+11]},t.prototype._parsePMT=function(t,e,r,n){var i,o,s,a,u={audio:-1,avc:-1,id3:-1,isAAC:!0};for(i=(15&t[e+1])<<8|t[e+2],o=e+3+i-4,s=(15&t[e+10])<<8|t[e+11],e+=12+s;e<o;){switch(a=(31&t[e+1])<<8|t[e+2],t[e]){case 207:if(!n){x.b.log("unkown stream type:"+t[e]);break}case 15:-1===u.audio&&(u.audio=a);break;case 21:-1===u.id3&&(u.id3=a);break;case 219:if(!n){x.b.log("unkown stream type:"+t[e]);break}case 27:-1===u.avc&&(u.avc=a);break;case 3:case 4:r?-1===u.audio&&(u.audio=a,u.isAAC=!1):x.b.log("MPEG audio found, not supported in this browser for now");break;case 36:x.b.warn("HEVC stream type found, not supported for now");break;default:x.b.log("unkown stream type:"+t[e])}e+=5+((15&t[e+3])<<8|t[e+4])}return u},t.prototype._parsePES=function(t){var e,r,n,i,o,s,a,u,c=0,l=t.data;if(!t||0===t.size)return null;for(;l[0].length<19&&l.length>1;){var f=new Uint8Array(l[0].length+l[1].length);f.set(l[0]),f.set(l[1],l[0].length),l[0]=f,l.splice(1,1)}if(e=l[0],1===(e[0]<<16)+(e[1]<<8)+e[2]){if((n=(e[4]<<8)+e[5])&&n>t.size-6)return null;r=e[7],192&r&&(s=536870912*(14&e[9])+4194304*(255&e[10])+16384*(254&e[11])+128*(255&e[12])+(254&e[13])/2,s>4294967295&&(s-=8589934592),64&r?(a=536870912*(14&e[14])+4194304*(255&e[15])+16384*(254&e[16])+128*(255&e[17])+(254&e[18])/2,a>4294967295&&(a-=8589934592),s-a>54e5&&(x.b.warn(Math.round((s-a)/9e4)+"s delta between PTS and DTS, align them"),s=a)):a=s),i=e[8],u=i+9,t.size-=u,o=new Uint8Array(t.size);for(var d=0,h=l.length;d<h;d++){e=l[d];var p=e.byteLength;if(u){if(u>p){u-=p;continue}e=e.subarray(u),p-=u,u=0}o.set(e,c),c+=p}return n&&(n-=i+3),{data:o,pts:s,dts:a,len:n}}return null},t.prototype.pushAccesUnit=function(t,e){if(t.units.length&&t.frame){var r=e.samples,n=r.length;!this.config.forceKeyFrameOnDiscontinuity||!0===t.key||e.sps&&(n||this.contiguous)?(t.id=n,r.push(t)):e.dropped++}t.debug.length&&x.b.log(t.pts+"/"+t.dts+":"+t.debug)},t.prototype._parseAVCPES=function(t,e){var r,n,i,o=this,s=this._avcTrack,a=this._parseAVCNALu(t.data),u=!1,c=this.avcSample,l=!1,f=this.pushAccesUnit.bind(this),d=function(t,e,r,n){return{key:t,pts:e,dts:r,units:[],debug:n}};t.data=null,c&&a.length&&!s.audFound&&(f(c,s),c=this.avcSample=d(!1,t.pts,t.dts,"")),a.forEach(function(e){switch(e.type){case 1:n=!0,c||(c=o.avcSample=d(!0,t.pts,t.dts,"")),u&&(c.debug+="NDR "),c.frame=!0;var a=e.data;if(l&&a.length>4){var h=new z(a).readSliceType();2!==h&&4!==h&&7!==h&&9!==h||(c.key=!0)}break;case 5:n=!0,c||(c=o.avcSample=d(!0,t.pts,t.dts,"")),u&&(c.debug+="IDR "),c.key=!0,c.frame=!0;break;case 6:n=!0,u&&c&&(c.debug+="SEI "),r=new z(o.discardEPB(e.data)),r.readUByte();for(var p=0,v=0,g=!1,y=0;!g&&r.bytesAvailable>1;){p=0;do{y=r.readUByte(),p+=y}while(255===y);v=0;do{y=r.readUByte(),v+=y}while(255===y);if(4===p&&0!==r.bytesAvailable){g=!0;if(181===r.readUByte()){if(49===r.readUShort()){if(1195456820===r.readUInt()){if(3===r.readUByte()){var m=r.readUByte(),E=r.readUByte(),_=31&m,b=[m,E];for(i=0;i<_;i++)b.push(r.readUByte()),b.push(r.readUByte()),b.push(r.readUByte());o._insertSampleInOrder(o._txtTrack.samples,{type:3,pts:t.pts,bytes:b})}}}}}else if(v<r.bytesAvailable)for(i=0;i<v;i++)r.readUByte()}break;case 7:if(n=!0,l=!0,u&&c&&(c.debug+="SPS "),!s.sps){r=new z(e.data);var T=r.readSPS();s.width=T.width,s.height=T.height,s.pixelRatio=T.pixelRatio,s.sps=[e.data],s.duration=o._duration;var S=e.data.subarray(1,4),w="avc1.";for(i=0;i<3;i++){var A=S[i].toString(16);A.length<2&&(A="0"+A),w+=A}s.codec=w}break;case 8:n=!0,u&&c&&(c.debug+="PPS "),s.pps||(s.pps=[e.data]);break;case 9:n=!1,s.audFound=!0,c&&f(c,s),c=o.avcSample=d(!1,t.pts,t.dts,u?"AUD ":"");break;case 12:n=!1;break;default:n=!1,c&&(c.debug+="unknown NAL "+e.type+" ")}if(c&&n){c.units.push(e)}}),e&&c&&(f(c,s),this.avcSample=null)},t.prototype._insertSampleInOrder=function(t,e){var r=t.length;if(r>0){if(e.pts>=t[r-1].pts)t.push(e);else for(var n=r-1;n>=0;n--)if(e.pts<t[n].pts){t.splice(n,0,e);break}}else t.push(e)},t.prototype._getLastNalUnit=function(){var t=this.avcSample,e=void 0;if(!t||0===t.units.length){var r=this._avcTrack,n=r.samples;t=n[n.length-1]}if(t){var i=t.units;e=i[i.length-1]}return e},t.prototype._parseAVCNALu=function(t){var e,r,n,i,o,s=0,a=t.byteLength,u=this._avcTrack,c=u.naluState||0,l=c,f=[],d=-1;for(-1===c&&(d=0,o=31&t[0],c=0,s=1);s<a;)if(e=t[s++],c)if(1!==c)if(e)if(1===e){if(d>=0)n={data:t.subarray(d,s-c-1),type:o},f.push(n);else{var h=this._getLastNalUnit();if(h&&(l&&s<=4-l&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-l)),(r=s-c-1)>0)){var p=new Uint8Array(h.data.byteLength+r);p.set(h.data,0),p.set(t.subarray(0,r),h.data.byteLength),h.data=p}}s<a?(i=31&t[s],d=s,o=i,c=0):c=-1}else c=0;else c=3;else c=e?0:2;else c=e?0:1;if(d>=0&&c>=0&&(n={data:t.subarray(d,a),type:o,state:c},f.push(n)),0===f.length){var v=this._getLastNalUnit();if(v){var g=new Uint8Array(v.data.byteLength+t.byteLength);g.set(v.data,0),g.set(t,v.data.byteLength),v.data=g}}return u.naluState=c,f},t.prototype.discardEPB=function(t){for(var e,r,n=t.byteLength,i=[],o=1;o<n-2;)0===t[o]&&0===t[o+1]&&3===t[o+2]?(i.push(o+2),o+=2):o++;if(0===i.length)return t;e=n-i.length,r=new Uint8Array(e);var s=0;for(o=0;o<e;s++,o++)s===i[0]&&(s++,i.shift()),r[o]=t[s];return r},t.prototype._parseAACPES=function(t){var e,r,n,i,o,s=this._audioTrack,a=t.data,u=t.pts,c=0,l=this.aacOverFlow,d=this.aacLastPTS;if(l){var v=new Uint8Array(l.byteLength+a.byteLength);v.set(l,0),v.set(a,l.byteLength),a=v}for(n=c,o=a.length;n<o-1&&!f(a,n);n++);if(n){var y,m;if(n<o-1?(y="AAC PES did not start with ADTS header,offset:"+n,m=!1):(y="no ADTS header found in AAC PES",m=!0),x.b.warn("parsing error:"+y),this.observer.trigger(O.a.ERROR,{type:L.b.MEDIA_ERROR,details:L.a.FRAG_PARSING_ERROR,fatal:m,reason:y}),m)return}if(h(s,this.observer,a,n,this.audioCodec),r=0,e=p(s.samplerate),l&&d){var E=d+e;Math.abs(E-u)>1&&(x.b.log("AAC: align PTS for overlapping frames by "+Math.round((E-u)/90)),u=E)}for(;n<o;)if(f(a,n)&&n+5<o){var _=g(s,a,n,u,r);if(!_)break;n+=_.length,i=_.sample.pts,r++}else n++;l=n<o?a.subarray(n,o):null,this.aacOverFlow=l,this.aacLastPTS=i},t.prototype._parseMPEGPES=function(t){for(var e=t.data,r=e.length,n=0,i=0,o=t.pts;i<r;)if(Y.isHeader(e,i)){var s=Y.appendFrame(this._audioTrack,e,i,o,n);if(!s)break;i+=s.length,n++}else i++},t.prototype._parseID3PES=function(t){this._id3Track.samples.push(t)},t}(),Z=$,J=function(){function t(e,r,n){T(this,t),this.observer=e,this.config=n,this.remuxer=r}return t.prototype.resetInitSegment=function(t,e,r,n){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:e,duration:n,inputTimeScale:9e4}},t.prototype.resetTimeStamp=function(){},t.probe=function(t){var e,r,n=B.a.getID3Data(t,0);if(n&&void 0!==B.a.getTimeStamp(n))for(e=n.length,r=Math.min(t.length-1,e+100);e<r;e++)if(Y.probe(t,e))return x.b.log("MPEG Audio sync word found !"),!0;return!1},t.prototype.append=function(t,e,r,n){for(var i=B.a.getID3Data(t,0),o=90*B.a.getTimeStamp(i),s=i.length,a=t.length,u=0,c=0,l=this._audioTrack,f=[{pts:o,dts:o,data:i}];s<a;)if(Y.isHeader(t,s)){var d=Y.appendFrame(l,t,s,o,u);if(!d)break;s+=d.length,c=d.sample.pts,u++}else B.a.isHeader(t,s)?(i=B.a.getID3Data(t,s),f.push({pts:c,dts:c,data:i}),s+=i.length):s++;this.remuxer.remux(l,{samples:[]},{samples:f,inputTimeScale:9e4},{samples:[]},e,r,n)},t.prototype.destroy=function(){},t}(),tt=J,et=function(){function t(){S(this,t)}return t.getSilentFrame=function(t,e){switch(t){case"mp4a.40.2":if(1===e)return new Uint8Array([0,200,0,128,35,128]);if(2===e)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===e)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},t}(),rt=et,nt=Math.pow(2,32)-1,it=function(){function t(){w(this,t)}return t.init=function(){t.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var e;for(e in t.types)t.types.hasOwnProperty(e)&&(t.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);t.HDLR_TYPES={video:r,audio:n};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);t.STTS=t.STSC=t.STCO=o,t.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),t.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),t.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),t.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var s=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),u=new Uint8Array([0,0,0,1]);t.FTYP=t.box(t.types.ftyp,s,u,s,a),t.DINF=t.box(t.types.dinf,t.box(t.types.dref,i))},t.box=function(t){for(var e,r=Array.prototype.slice.call(arguments,1),n=8,i=r.length,o=i;i--;)n+=r[i].byteLength;for(e=new Uint8Array(n),e[0]=n>>24&255,e[1]=n>>16&255,e[2]=n>>8&255,e[3]=255&n,e.set(t,4),i=0,n=8;i<o;i++)e.set(r[i],n),n+=r[i].byteLength;return e},t.hdlr=function(e){return t.box(t.types.hdlr,t.HDLR_TYPES[e])},t.mdat=function(e){return t.box(t.types.mdat,e)},t.mdhd=function(e,r){r*=e;var n=Math.floor(r/(nt+1)),i=Math.floor(r%(nt+1));return t.box(t.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))},t.mdia=function(e){return t.box(t.types.mdia,t.mdhd(e.timescale,e.duration),t.hdlr(e.type),t.minf(e))},t.mfhd=function(e){return t.box(t.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))},t.minf=function(e){return"audio"===e.type?t.box(t.types.minf,t.box(t.types.smhd,t.SMHD),t.DINF,t.stbl(e)):t.box(t.types.minf,t.box(t.types.vmhd,t.VMHD),t.DINF,t.stbl(e))},t.moof=function(e,r,n){return t.box(t.types.moof,t.mfhd(e),t.traf(n,r))},t.moov=function(e){for(var r=e.length,n=[];r--;)n[r]=t.trak(e[r]);return t.box.apply(null,[t.types.moov,t.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(t.mvex(e)))},t.mvex=function(e){for(var r=e.length,n=[];r--;)n[r]=t.trex(e[r]);return t.box.apply(null,[t.types.mvex].concat(n))},t.mvhd=function(e,r){r*=e;var n=Math.floor(r/(nt+1)),i=Math.floor(r%(nt+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return t.box(t.types.mvhd,o)},t.sdtp=function(e){var r,n,i=e.samples||[],o=new Uint8Array(4+i.length);for(n=0;n<i.length;n++)r=i[n].flags,o[n+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return t.box(t.types.sdtp,o)},t.stbl=function(e){return t.box(t.types.stbl,t.stsd(e),t.box(t.types.stts,t.STTS),t.box(t.types.stsc,t.STSC),t.box(t.types.stsz,t.STSZ),t.box(t.types.stco,t.STCO))},t.avc1=function(e){var r,n,i,o=[],s=[];for(r=0;r<e.sps.length;r++)n=e.sps[r],i=n.byteLength,o.push(i>>>8&255),o.push(255&i),o=o.concat(Array.prototype.slice.call(n));for(r=0;r<e.pps.length;r++)n=e.pps[r],i=n.byteLength,s.push(i>>>8&255),s.push(255&i),s=s.concat(Array.prototype.slice.call(n));var a=t.box(t.types.avcC,new Uint8Array([1,o[3],o[4],o[5],255,224|e.sps.length].concat(o).concat([e.pps.length]).concat(s))),u=e.width,c=e.height,l=e.pixelRatio[0],f=e.pixelRatio[1];return t.box(t.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,255&u,c>>8&255,255&c,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,t.box(t.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),t.box(t.types.pasp,new Uint8Array([l>>24,l>>16&255,l>>8&255,255&l,f>>24,f>>16&255,f>>8&255,255&f])))},t.esds=function(t){var e=t.config.length;return new Uint8Array([0,0,0,0,3,23+e,0,1,0,4,15+e,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([e]).concat(t.config).concat([6,1,2]))},t.mp4a=function(e){var r=e.samplerate;return t.box(t.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),t.box(t.types.esds,t.esds(e)))},t.mp3=function(e){var r=e.samplerate;return t.box(t.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))},t.stsd=function(e){return"audio"===e.type?e.isAAC||"mp3"!==e.codec?t.box(t.types.stsd,t.STSD,t.mp4a(e)):t.box(t.types.stsd,t.STSD,t.mp3(e)):t.box(t.types.stsd,t.STSD,t.avc1(e))},t.tkhd=function(e){var r=e.id,n=e.duration*e.timescale,i=e.width,o=e.height,s=Math.floor(n/(nt+1)),a=Math.floor(n%(nt+1));return t.box(t.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,o>>8&255,255&o,0,0]))},t.traf=function(e,r){var n=t.sdtp(e),i=e.id,o=Math.floor(r/(nt+1)),s=Math.floor(r%(nt+1));return t.box(t.types.traf,t.box(t.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),t.box(t.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s])),t.trun(e,n.length+16+20+8+16+8+8),n)},t.trak=function(e){return e.duration=e.duration||4294967295,t.box(t.types.trak,t.tkhd(e),t.mdia(e))},t.trex=function(e){var r=e.id;return t.box(t.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},t.trun=function(e,r){var n,i,o,s,a,u,c=e.samples||[],l=c.length,f=12+16*l,d=new Uint8Array(f);for(r+=8+f,d.set([0,0,15,1,l>>>24&255,l>>>16&255,l>>>8&255,255&l,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),n=0;n<l;n++)i=c[n],o=i.duration,s=i.size,a=i.flags,u=i.cts,d.set([o>>>24&255,o>>>16&255,o>>>8&255,255&o,s>>>24&255,s>>>16&255,s>>>8&255,255&s,a.isLeading<<2|a.dependsOn,a.isDependedOn<<6|a.hasRedundancy<<4|a.paddingValue<<1|a.isNonSync,61440&a.degradPrio,15&a.degradPrio,u>>>24&255,u>>>16&255,u>>>8&255,255&u],12+16*n);return t.box(t.types.trun,d)},t.initSegment=function(e){t.types||t.init();var r,n=t.moov(e);return r=new Uint8Array(t.FTYP.byteLength+n.byteLength),r.set(t.FTYP),r.set(n,t.FTYP.byteLength),r},t}(),ot=it,st=1e4,at=function(){function t(e,r,n,i){A(this,t),this.observer=e,this.config=r,this.typeSupported=n;var o=navigator.userAgent;this.isSafari=i&&i.indexOf("Apple")>-1&&o&&!o.match("CriOS"),this.ISGenerated=!1}return t.prototype.destroy=function(){},t.prototype.resetTimeStamp=function(t){this._initPTS=this._initDTS=t},t.prototype.resetInitSegment=function(){this.ISGenerated=!1},t.prototype.remux=function(t,e,r,n,i,o,s){if(this.ISGenerated||this.generateIS(t,e,i),this.ISGenerated)if(t.samples.length){t.timescale||(x.b.warn("regenerate InitSegment as audio detected"),this.generateIS(t,e,i));var a=this.remuxAudio(t,i,o,s);if(e.samples.length){var u=void 0;a&&(u=a.endPTS-a.startPTS),e.timescale||(x.b.warn("regenerate InitSegment as video detected"),this.generateIS(t,e,i)),this.remuxVideo(e,i,o,u,s)}}else{var c=void 0;e.samples.length&&(c=this.remuxVideo(e,i,o,s)),c&&t.codec&&this.remuxEmptyAudio(t,i,o,c)}r.samples.length&&this.remuxID3(r,i),n.samples.length&&this.remuxText(n,i),this.observer.trigger(O.a.FRAG_PARSED)},t.prototype.generateIS=function(t,e,r){var n,i,o=this.observer,s=t.samples,a=e.samples,u=this.typeSupported,c="audio/mp4",l={},f={tracks:l},d=void 0===this._initPTS;if(d&&(n=i=1/0),t.config&&s.length&&(t.timescale=t.samplerate,x.b.log("audio sampling rate : "+t.samplerate),t.isAAC||(u.mpeg?(c="audio/mpeg",t.codec=""):u.mp3&&(t.codec="mp3")),l.audio={container:c,codec:t.codec,initSegment:!t.isAAC&&u.mpeg?new Uint8Array:ot.initSegment([t]),metadata:{channelCount:t.channelCount}},d&&(n=i=s[0].pts-t.inputTimeScale*r)),e.sps&&e.pps&&a.length){var h=e.inputTimeScale;e.timescale=h,l.video={container:"video/mp4",codec:e.codec,initSegment:ot.initSegment([e]),metadata:{width:e.width,height:e.height}},d&&(n=Math.min(n,a[0].pts-h*r),i=Math.min(i,a[0].dts-h*r),this.observer.trigger(O.a.INIT_PTS_FOUND,{initPTS:n}))}Object.keys(l).length?(o.trigger(O.a.FRAG_PARSING_INIT_SEGMENT,f),this.ISGenerated=!0,d&&(this._initPTS=n,this._initDTS=i)):o.trigger(O.a.ERROR,{type:L.b.MEDIA_ERROR,details:L.a.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},t.prototype.remuxVideo=function(t,e,r,n,i){var o,s,a,u,c,l,f,d=8,h=t.timescale,p=t.samples,v=[],g=p.length,y=this._PTSNormalize,m=this._initDTS,E=this.nextAvcDts,_=this.isSafari;_&&(r|=p.length&&E&&(i&&Math.abs(e-E/h)<.1||Math.abs(p[0].pts-E-m)<h/5)),r||(E=e*h),p.forEach(function(t){t.pts=y(t.pts-m,E),t.dts=y(t.dts-m,E)}),p.sort(function(t,e){var r=t.dts-e.dts,n=t.pts-e.pts;return r||(n||t.id-e.id)});var b=p.reduce(function(t,e){return Math.max(Math.min(t,e.pts-e.dts),-18e3)},0);if(b<0){x.b.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(b/90)+" ms to overcome this issue");for(var T=0;T<p.length;T++)p[T].dts+=b}var S=p[0];c=Math.max(S.dts,0),u=Math.max(S.pts,0);var w=Math.round((c-E)/90);r&&w&&(w>1?x.b.log("AVC:"+w+" ms hole between fragments detected,filling it"):w<-1&&x.b.log("AVC:"+-w+" ms overlapping between fragments detected"),c=E,p[0].dts=c,u=Math.max(u-w,E),p[0].pts=u,x.b.log("Video/PTS/DTS adjusted: "+Math.round(u/90)+"/"+Math.round(c/90)+",delta:"+w+" ms")),S=p[p.length-1],f=Math.max(S.dts,0),l=Math.max(S.pts,0,f),_&&(o=Math.round((f-c)/(p.length-1)));for(var A=0,R=0,D=0;D<g;D++){for(var C=p[D],I=C.units,P=I.length,M=0,N=0;N<P;N++)M+=I[N].data.length;R+=M,A+=P,C.length=M,C.dts=_?c+D*o:Math.max(C.dts,c),C.pts=Math.max(C.pts,C.dts)}var k=R+4*A+8;try{s=new Uint8Array(k)}catch(t){return void this.observer.trigger(O.a.ERROR,{type:L.b.MUX_ERROR,details:L.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:k,reason:"fail allocating video mdat "+k})}var F=new DataView(s.buffer);F.setUint32(0,k),s.set(ot.types.mdat,4);for(var U=0;U<g;U++){for(var B=p[U],j=B.units,G=0,H=void 0,V=0,q=j.length;V<q;V++){var W=j[V],Y=W.data,K=W.data.byteLength;F.setUint32(d,K),d+=4,s.set(Y,d),d+=K,G+=4+K}if(_)H=Math.max(0,o*Math.round((B.pts-B.dts)/o));else{if(U<g-1)o=p[U+1].dts-B.dts;else{var z=this.config,X=B.dts-p[U>0?U-1:U].dts;if(z.stretchShortVideoTrack){var Q=z.maxBufferHole,$=z.maxSeekHole,Z=Math.floor(Math.min(Q,$)*h),J=(n?u+n*h:this.nextAudioPts)-B.pts;J>Z?(o=J-X,o<0&&(o=X),x.b.log("It is approximately "+J/90+" ms to the next segment; using duration "+o/90+" ms for the last video frame.")):o=X}else o=X}H=Math.round(B.pts-B.dts)}v.push({size:G,duration:o,cts:H,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:B.key?2:1,isNonSync:B.key?0:1}})}this.nextAvcDts=f+o;var tt=t.dropped;if(t.len=0,t.nbNalu=0,t.dropped=0,v.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var et=v[0].flags;et.dependsOn=2,et.isNonSync=0}t.samples=v,a=ot.moof(t.sequenceNumber++,c,t),t.samples=[];var rt={data1:a,data2:s,startPTS:u/h,endPTS:(l+o)/h,startDTS:c/h,endDTS:this.nextAvcDts/h,type:"video",nb:v.length,dropped:tt};return this.observer.trigger(O.a.FRAG_PARSING_DATA,rt),rt},t.prototype.remuxAudio=function(t,e,r,n){var i,o,s,a,u,c,l,f=t.inputTimeScale,d=t.timescale,h=f/d,p=t.isAAC?1024:1152,v=p*h,g=this._PTSNormalize,y=this._initDTS,m=!t.isAAC&&this.typeSupported.mpeg,E=t.samples,_=[],b=this.nextAudioPts;if(r|=E.length&&b&&(n&&Math.abs(e-b/f)<.1||Math.abs(E[0].pts-b-y)<20*v),r||(b=e*f),E.forEach(function(t){t.pts=t.dts=g(t.pts-y,b)}),E.sort(function(t,e){return t.pts-e.pts}),n&&t.isAAC)for(var T=0,S=b;T<E.length;){var w,A=E[T],R=A.pts;w=R-S;var D=Math.abs(1e3*w/f);if(w<=-v)x.b.warn("Dropping 1 audio frame @ "+(S/f).toFixed(3)+"s due to "+D+" ms overlap."),E.splice(T,1),t.len-=A.unit.length;else if(w>=v&&D<st&&S){var C=Math.round(w/v);x.b.warn("Injecting "+C+" audio frame @ "+(S/f).toFixed(3)+"s due to "+Math.round(1e3*w/f)+" ms gap.");for(var I=0;I<C;I++){var P=Math.max(S,0);s=rt.getSilentFrame(t.manifestCodec||t.codec,t.channelCount),s||(x.b.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),s=A.unit.subarray()),E.splice(T,0,{unit:s,pts:P,dts:P}),t.len+=s.length,S+=v,T++}A.pts=A.dts=S,S+=v,T++}else Math.abs(w),A.pts=A.dts=S,S+=v,T++}for(var M=0,N=E.length;M<N;M++){var k=E[M],F=k.unit,U=k.pts;if(void 0!==l)o.duration=Math.round((U-l)/h);else{var B=Math.round(1e3*(U-b)/f),j=0;if(r&&t.isAAC&&B){if(B>0&&B<st)j=Math.round((U-b)/v),x.b.log(B+" ms hole between AAC samples detected,filling it"),j>0&&(s=rt.getSilentFrame(t.manifestCodec||t.codec,t.channelCount),s||(s=F.subarray()),t.len+=j*s.length);else if(B<-12){x.b.log("drop overlapping AAC sample, expected/parsed/delta:"+(b/f).toFixed(3)+"s/"+(U/f).toFixed(3)+"s/"+-B+"ms"),t.len-=F.byteLength;continue}U=b}if(c=Math.max(0,U),!(t.len>0))return;var G=m?t.len:t.len+8;i=m?0:8;try{a=new Uint8Array(G)}catch(t){return void this.observer.trigger(O.a.ERROR,{type:L.b.MUX_ERROR,details:L.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:G,reason:"fail allocating audio mdat "+G})}if(!m){new DataView(a.buffer).setUint32(0,G),a.set(ot.types.mdat,4)}for(var H=0;H<j;H++)s=rt.getSilentFrame(t.manifestCodec||t.codec,t.channelCount),s||(x.b.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),s=F.subarray()),a.set(s,i),i+=s.byteLength,o={size:s.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},_.push(o)}a.set(F,i);var V=F.byteLength;i+=V,o={size:V,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},_.push(o),l=U}var q=0,W=_.length;if(W>=2&&(q=_[W-2].duration,o.duration=q),W){this.nextAudioPts=b=l+h*q,t.len=0,t.samples=_,u=m?new Uint8Array:ot.moof(t.sequenceNumber++,c/h,t),t.samples=[];var Y=c/f,K=b/f,z={data1:u,data2:a,startPTS:Y,endPTS:K,startDTS:Y,endDTS:K,type:"audio",nb:W};return this.observer.trigger(O.a.FRAG_PARSING_DATA,z),z}return null},t.prototype.remuxEmptyAudio=function(t,e,r,n){var i=t.inputTimeScale,o=t.samplerate?t.samplerate:i,s=i/o,a=this.nextAudioPts,u=(void 0!==a?a:n.startDTS*i)+this._initDTS,c=n.endDTS*i+this._initDTS,l=1024,f=s*l,d=Math.ceil((c-u)/f),h=rt.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(x.b.warn("remux empty Audio"),!h)return void x.b.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");for(var p=[],v=0;v<d;v++){var g=u+v*f;p.push({unit:h,pts:g,dts:g}),t.len+=h.length}t.samples=p,this.remuxAudio(t,e,r)},t.prototype.remuxID3=function(t,e){var r,n=t.samples.length,i=t.inputTimeScale,o=this._initPTS,s=this._initDTS;if(n){for(var a=0;a<n;a++)r=t.samples[a],r.pts=(r.pts-o)/i,r.dts=(r.dts-s)/i;this.observer.trigger(O.a.FRAG_PARSING_METADATA,{samples:t.samples})}t.samples=[],e=e},t.prototype.remuxText=function(t,e){t.samples.sort(function(t,e){return t.pts-e.pts});var r,n=t.samples.length,i=t.inputTimeScale,o=this._initPTS;if(n){for(var s=0;s<n;s++)r=t.samples[s],r.pts=(r.pts-o)/i;this.observer.trigger(O.a.FRAG_PARSING_USERDATA,{samples:t.samples})}t.samples=[],e=e},t.prototype._PTSNormalize=function(t,e){var r;if(void 0===e)return t;for(r=e<t?-8589934592:8589934592;Math.abs(t-e)>4294967296;)t+=r;return t},t}(),ut=at,ct=function(){function t(e){R(this,t),this.observer=e}return t.prototype.destroy=function(){},t.prototype.resetTimeStamp=function(){},t.prototype.resetInitSegment=function(){},t.prototype.remux=function(t,e,r,n,i,o,s,a){var u=this.observer,c="";t&&(c+="audio"),e&&(c+="video"),u.trigger(O.a.FRAG_PARSING_DATA,{data1:a,startPTS:i,startDTS:i,type:c,nb:1,dropped:0}),u.trigger(O.a.FRAG_PARSED)},t}(),lt=ct,ft=function(){function t(e,r,n,i){D(this,t),this.observer=e,this.typeSupported=r,this.config=n,this.vendor=i}return t.prototype.destroy=function(){var t=this.demuxer;t&&t.destroy()},t.prototype.push=function(t,e,r,n,i,o,s,a,u,c,l,f){if(t.byteLength>0&&null!=e&&null!=e.key&&"AES-128"===e.method){var d=this.decrypter;null==d&&(d=this.decrypter=new U(this.observer,this.config));var h,p=this;try{h=performance.now()}catch(t){h=Date.now()}d.decrypt(t,e.key.buffer,e.iv.buffer,function(t){var d;try{d=performance.now()}catch(t){d=Date.now()}p.observer.trigger(O.a.FRAG_DECRYPTED,{stats:{tstart:h,tdecrypt:d}}),p.pushDecrypted(new Uint8Array(t),e,new Uint8Array(r),n,i,o,s,a,u,c,l,f)})}else this.pushDecrypted(new Uint8Array(t),e,new Uint8Array(r),n,i,o,s,a,u,c,l,f)},t.prototype.pushDecrypted=function(t,e,r,n,i,o,s,a,u,c,l,f){var d=this.demuxer;if(!d||s&&!this.probe(t)){for(var h=this.observer,p=this.typeSupported,v=this.config,g=[{demux:G,remux:ut},{demux:tt,remux:ut},{demux:Z,remux:ut},{demux:q,remux:lt}],y=0,m=g.length;y<m;y++){var E=g[y],_=E.demux.probe;if(_(t)){var b=this.remuxer=new E.remux(h,v,p,this.vendor);d=new E.demux(h,b,v,p),this.probe=_;break}}if(!d)return void h.trigger(O.a.ERROR,{type:L.b.MEDIA_ERROR,details:L.a.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=d}var T=this.remuxer;(s||a)&&(d.resetInitSegment(r,n,i,c),T.resetInitSegment()),s&&(d.resetTimeStamp(f),T.resetTimeStamp(f)),"function"==typeof d.setDecryptData&&d.setDecryptData(e),d.append(t,o,u,l)},t}();e.a=ft},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){var r=Ft[e];return!!r&&!0===r[t.slice(0,4)]}function s(t){return MediaSource.isTypeSupported('video/mp4;codecs="'+t+'"')}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function v(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e,r){var n=t[e],i=t[r],o=i.startPTS;isNaN(o)?i.start=r>e?n.start+n.duration:Math.max(n.start-i.duration,0):r>e?(n.duration=o-n.start,n.duration<0&&Lt.b.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):(i.duration=n.start-o,i.duration<0&&Lt.b.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!"))}function m(t,e,r,n,i,o){if(!isNaN(e.startPTS)){var s=Math.abs(e.startPTS-r);isNaN(e.deltaPTS)?e.deltaPTS=s:e.deltaPTS=Math.max(s,e.deltaPTS),r=Math.min(r,e.startPTS),n=Math.max(n,e.endPTS),i=Math.min(i,e.startDTS),o=Math.max(o,e.endDTS)}var a=r-e.start;e.start=e.startPTS=r,e.endPTS=n,e.startDTS=i,e.endDTS=o,e.duration=n-r;var u=e.sn;if(!t||u<t.startSN||u>t.endSN)return 0;var c,l,f;for(c=u-t.startSN,l=t.fragments,l[c]=e,f=c;f>0;f--)y(l,f,f-1);for(f=c;f<l.length-1;f++)y(l,f,f+1);return t.PTSKnown=!0,a}function E(t,e){var r,n=Math.max(t.startSN,e.startSN)-e.startSN,i=Math.min(t.endSN,e.endSN)-e.startSN,o=e.startSN-t.startSN,s=t.fragments,a=e.fragments,u=0;if(i<n)return void(e.PTSKnown=!1);for(var c=n;c<=i;c++){var l=s[o+c],f=a[c];f&&l&&(u=l.cc-f.cc,isNaN(l.startPTS)||(f.start=f.startPTS=l.startPTS,f.endPTS=l.endPTS,f.duration=l.duration,f.backtracked=l.backtracked,f.dropped=l.dropped,r=f))}if(u)for(Lt.b.log("discontinuity sliding from playlist, take drift into account"),c=0;c<a.length;c++)a[c].cc+=u;if(r)m(e,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS);else if(o>=0&&o<s.length){var d=s[o].start;for(c=0;c<a.length;c++)a[c].start+=d}e.PTSKnown=t.PTSKnown}function _(t,e){for(var r=null,n=0;n<t.length;n+=1){var i=t[n];if(i&&i.cc===e){r=i;break}}return r}function b(t,e){return Zt.search(t,function(t){return t.cc<e?1:t.cc>e?-1:0})}function T(t,e,r){var n=!1;return e&&e.details&&r&&(r.endCC>r.startCC||t&&t.cc<r.startCC)&&(n=!0),n}function S(t,e){var r=t.fragments,n=e.fragments;if(!n.length||!r.length)return void Lt.b.log("No fragments to align");var i=_(r,n[0].cc);return!i||i&&!i.startPTS?void Lt.b.log("No frag in previous level to align on"):i}function w(t,e){e.fragments.forEach(function(e){if(e){var r=e.start+t;e.start=e.startPTS=r,e.endPTS=r+e.duration}}),e.PTSKnown=!0}function A(t,e,r){if(T(t,e,r)){var n=S(e.details,r);n&&(Lt.b.log("Adjusting PTS using last level due to CC increase within current level"),w(n.start,r))}if(!1===r.PTSKnown&&e&&e.details){var i=e.details.programDateTime,o=r.programDateTime,s=(o-i)/1e3+e.details.fragments[0].start;isNaN(s)||(Lt.b.log("adjusting PTS using programDateTime delta, sliding:"+s.toFixed(3)),w(s,r))}}function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function D(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function O(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function L(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function I(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function M(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function N(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function k(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function F(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function U(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function B(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function j(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function G(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function H(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function V(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function q(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function W(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function Y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function K(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function z(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function X(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function Z(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function J(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tt(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function et(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function rt(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new qe,this.regionList=[]}function nt(t){function e(t,e,r,n){return 3600*(0|t)+60*(0|e)+(0|r)+(0|n)/1e3}var r=t.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?e(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?e(r[1],r[2],0,r[4]):e(0,r[1],r[2],r[4]):null}function it(){this.values=Object.create(null)}function ot(t,e,r,n){var i=n?t.split(n):[t];for(var o in i)if("string"==typeof i[o]){var s=i[o].split(r);if(2===s.length){var a=s[0],u=s[1];e(a,u)}}}function st(t,e,r){function n(){var e=nt(t);if(null===e)throw new Error("Malformed timestamp: "+s);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function i(t,e){var n=new it;ot(t,function(t,e){switch(t){case"region":for(var i=r.length-1;i>=0;i--)if(r[i].id===e){n.set(t,r[i].region);break}break;case"vertical":n.alt(t,e,["rl","lr"]);break;case"line":var o=e.split(","),s=o[0];n.integer(t,s),n.percent(t,s)&&n.set("snapToLines",!1),n.alt(t,s,["auto"]),2===o.length&&n.alt("lineAlign",o[1],["start",Ye,"end"]);break;case"position":o=e.split(","),n.percent(t,o[0]),2===o.length&&n.alt("positionAlign",o[1],["start",Ye,"end","line-left","line-right","auto"]);break;case"size":n.percent(t,e);break;case"align":n.alt(t,e,["start",Ye,"end","left","right"])}},/:/,/\s/),e.region=n.get("region",null),e.vertical=n.get("vertical","");var i=n.get("line","auto");"auto"===i&&-1===We.line&&(i=-1),e.line=i,e.lineAlign=n.get("lineAlign","start"),e.snapToLines=n.get("snapToLines",!0),e.size=n.get("size",100),e.align=n.get("align",Ye);var o=n.get("position","auto");"auto"===o&&50===We.position&&(o="start"===e.align||"left"===e.align?0:"end"===e.align||"right"===e.align?100:50),e.position=o}function o(){t=t.replace(/^\s+/,"")}var s=t;if(o(),e.startTime=n(),o(),"--\x3e"!==t.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+s);t=t.substr(3),o(),e.endTime=n(),o(),i(t,e)}function at(t){return t.replace(/<br(?: \/)?>/gi,"\n")}function ut(t,e,r,n){for(var i,o,s,a,u,c=window.VTTCue||window.TextTrackCue,l=0;l<n.rows.length;l++)if(i=n.rows[l],s=!0,a=0,u="",!i.isEmpty()){for(var f=0;f<i.chars.length;f++)i.chars[f].uchar.match(/\s/)&&s?a++:(u+=i.chars[f].uchar,s=!1);i.cueStartTime=e,e===r&&(r+=1e-4),o=new c(e,r,at(u.trim())),a>=16?a--:a++,navigator.userAgent.match(/Firefox\//)?o.line=l+1:o.line=l>7?l-2:l+1,o.align="left",o.position=Math.max(0,Math.min(100,a/32*100+(navigator.userAgent.match(/Firefox\//)?50:0))),t.addCue(o)}}function ct(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ft(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function dt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function ht(t){if(t&&t.cues)for(;t.cues.length>0;)t.removeCue(t.cues[0])}function pt(t,e){return t&&t.label===e.name&&!(t.textTrack1||t.textTrack2)}function vt(t,e,r,n){return Math.min(e,n)-Math.max(t,r)}function gt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yt(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function mt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function Et(t){for(var e=[],r=0;r<t.length;r++)"subtitles"===t[r].kind&&e.push(t[r]);return e}function _t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bt(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function Tt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function St(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var wt={};r.d(wt,"newCue",function(){return ut});var At=r(5),Rt=r.n(At),Dt=r(1),Ot=r(2),Lt=r(0),Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},It=function(){function t(e){n(this,t),this.hls=e,this.onEvent=this.onEvent.bind(this);for(var r=arguments.length,i=Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];this.handledEvents=i,this.useGenericHandler=!0,this.registerListeners()}return t.prototype.destroy=function(){this.unregisterListeners()},t.prototype.isEventHandler=function(){return"object"===Ct(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent},t.prototype.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(t){if("hlsEventGeneric"===t)throw new Error("Forbidden event name: "+t);this.hls.on(t,this.onEvent)},this)},t.prototype.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(t){this.hls.off(t,this.onEvent)},this)},t.prototype.onEvent=function(t,e){this.onEventGeneric(t,e)},t.prototype.onEventGeneric=function(t,e){var r=function(t,e){var r="on"+t.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+t+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,e)};try{r.call(this,t,e).call()}catch(e){Lt.b.error("internal error happened while processing "+t+":"+e.message),this.hls.trigger(Dt.a.ERROR,{type:Ot.b.OTHER_ERROR,details:Ot.a.INTERNAL_EXCEPTION,fatal:!1,event:t,err:e})}},t}(),Pt=It,Mt=/^(\d+)x(\d+)$/,Nt=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,kt=function(){function t(e){i(this,t),"string"==typeof e&&(e=t.parseAttrList(e));for(var r in e)e.hasOwnProperty(r)&&(this[r]=e[r])}return t.prototype.decimalInteger=function(t){var e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e},t.prototype.hexadecimalInteger=function(t){if(this[t]){var e=(this[t]||"0x").slice(2);e=(1&e.length?"0":"")+e;for(var r=new Uint8Array(e.length/2),n=0;n<e.length/2;n++)r[n]=parseInt(e.slice(2*n,2*n+2),16);return r}return null},t.prototype.hexadecimalIntegerAsNumber=function(t){var e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e},t.prototype.decimalFloatingPoint=function(t){return parseFloat(this[t])},t.prototype.enumeratedString=function(t){return this[t]},t.prototype.decimalResolution=function(t){var e=Mt.exec(this[t]);if(null!==e)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}},t.parseAttrList=function(t){var e,r={};for(Nt.lastIndex=0;null!==(e=Nt.exec(t));){var n=e[2],i='"';0===n.indexOf(i)&&n.lastIndexOf(i)===n.length-1&&(n=n.slice(1,-1)),r[e[1]]=n}return r},t}(),xt=kt,Ft={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}},Ut=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),Bt=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,jt=/#EXT-X-MEDIA:(.*)/g,Gt=new RegExp([/#EXTINF:(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),Ht=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,Vt=function(){function t(){c(this,t),this.method=null,this.key=null,this.iv=null,this._uri=null}return Ut(t,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Rt.a.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),t}(),qt=function(){function t(){c(this,t),this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[]}return t.prototype.createInitializationVector=function(t){for(var e=new Uint8Array(16),r=12;r<16;r++)e[r]=t>>8*(15-r)&255;return e},t.prototype.fragmentDecryptdataFromLevelkey=function(t,e){var r=t;return t&&t.method&&t.uri&&!t.iv&&(r=new Vt,r.method=t.method,r.baseuri=t.baseuri,r.reluri=t.reluri,r.iv=this.createInitializationVector(e)),r},t.prototype.cloneObj=function(t){return JSON.parse(JSON.stringify(t))},Ut(t,[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Rt.a.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(t){this._url=t}},{key:"programDateTime",get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:"byteRange",get:function(){if(!this._byteRange){var t=this._byteRange=[];if(this.rawByteRange){var e=this.rawByteRange.split("@",2);if(1===e.length){var r=this.lastByteRangeEndOffset;t[0]=r||0}else t[0]=parseInt(e[1]);t[1]=parseInt(e[0])+t[0]}}return this._byteRange}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}}]),t}(),Wt=function(t){function e(r){c(this,e);var n=a(this,t.call(this,r,Dt.a.MANIFEST_LOADING,Dt.a.LEVEL_LOADING,Dt.a.AUDIO_TRACK_LOADING,Dt.a.SUBTITLE_TRACK_LOADING));return n.loaders={},n}return u(e,t),e.prototype.destroy=function(){for(var t in this.loaders){var e=this.loaders[t];e&&e.destroy()}this.loaders={},Pt.prototype.destroy.call(this)},e.prototype.onManifestLoading=function(t){this.load(t.url,{type:"manifest"})},e.prototype.onLevelLoading=function(t){this.load(t.url,{type:"level",level:t.level,id:t.id})},e.prototype.onAudioTrackLoading=function(t){this.load(t.url,{type:"audioTrack",id:t.id})},e.prototype.onSubtitleTrackLoading=function(t){this.load(t.url,{type:"subtitleTrack",id:t.id})},e.prototype.load=function(t,e){var r=this.loaders[e.type];if(r){var n=r.context;if(n&&n.url===t)return void Lt.b.trace("playlist request ongoing");Lt.b.warn("abort previous loader for type:"+e.type),r.abort()}var i=this.hls.config,o=void 0,s=void 0,a=void 0,u=void 0;"manifest"===e.type?(o=i.manifestLoadingMaxRetry,s=i.manifestLoadingTimeOut,a=i.manifestLoadingRetryDelay,u=i.manifestLoadingMaxRetryTimeout):(o=i.levelLoadingMaxRetry,s=i.levelLoadingTimeOut,a=i.levelLoadingRetryDelay,u=i.levelLoadingMaxRetryTimeout,Lt.b.log("loading playlist for "+e.type+" "+(e.level||e.id))),r=this.loaders[e.type]=e.loader=void 0!==i.pLoader?new i.pLoader(i):new i.loader(i),e.url=t,e.responseType="";var c=void 0,l=void 0;c={timeout:s,maxRetry:o,retryDelay:a,maxRetryDelay:u},l={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},r.load(e,c,l)},e.prototype.resolve=function(t,e){return Rt.a.buildAbsoluteURL(e,t,{alwaysNormalize:!0})},e.prototype.parseMasterPlaylist=function(t,e){function r(t,e){["video","audio"].forEach(function(r){var n=t.filter(function(t){return o(t,r)});if(n.length){var i=n.filter(function(t){return 0===t.lastIndexOf("avc1",0)||0===t.lastIndexOf("mp4a",0)});e[r+"Codec"]=i.length>0?i[0]:n[0],t=t.filter(function(t){return-1===n.indexOf(t)})}}),e.unknownCodecs=t}var n=[],i=void 0;for(Bt.lastIndex=0;null!=(i=Bt.exec(t));){var s={},a=s.attrs=new xt(i[1]);s.url=this.resolve(i[2],e);var u=a.decimalResolution("RESOLUTION");u&&(s.width=u.width,s.height=u.height),s.bitrate=a.decimalInteger("AVERAGE-BANDWIDTH")||a.decimalInteger("BANDWIDTH"),s.name=a.NAME,r([].concat((a.CODECS||"").split(/[ ,]+/)),s),s.videoCodec&&-1!==s.videoCodec.indexOf("avc1")&&(s.videoCodec=this.avc1toavcoti(s.videoCodec)),n.push(s)}return n},e.prototype.parseMasterPlaylistMedia=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=void 0,o=[],s=0;for(jt.lastIndex=0;null!=(i=jt.exec(t));){var a={},u=new xt(i[1]);u.TYPE===r&&(a.groupId=u["GROUP-ID"],a.name=u.NAME,a.type=r,a.default="YES"===u.DEFAULT,a.autoselect="YES"===u.AUTOSELECT,a.forced="YES"===u.FORCED,u.URI&&(a.url=this.resolve(u.URI,e)),a.lang=u.LANGUAGE,a.name||(a.name=a.lang),n&&(a.audioCodec=n),a.id=s++,o.push(a))}return o},e.prototype.avc1toavcoti=function(t){var e,r=t.split(".");return r.length>2?(e=r.shift()+".",e+=parseInt(r.shift()).toString(16),e+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):e=t,e},e.prototype.parseLevelPlaylist=function(t,e,r,n){var i,o,s=0,a=0,u={type:null,version:null,url:e,fragments:[],live:!0,startSN:0},c=new Vt,l=0,f=null,d=new qt;for(Gt.lastIndex=0;null!==(i=Gt.exec(t));){var h=i[1];if(h){d.duration=parseFloat(h);var p=(" "+i[2]).slice(1);d.title=p||null,d.tagList.push(p?["INF",h,p]:["INF",h])}else if(i[3]){if(!isNaN(d.duration)){var v=s++;d.type=n,d.start=a,d.levelkey=c,d.sn=v,d.level=r,d.cc=l,d.baseurl=e,d.relurl=(" "+i[3]).slice(1),u.fragments.push(d),f=d,a+=d.duration,d=new qt}}else if(i[4]){if(d.rawByteRange=(" "+i[4]).slice(1),f){var g=f.byteRangeEndOffset;g&&(d.lastByteRangeEndOffset=g)}}else if(i[5])d.rawProgramDateTime=(" "+i[5]).slice(1),d.tagList.push(["PROGRAM-DATE-TIME",d.rawProgramDateTime]),void 0===u.programDateTime&&(u.programDateTime=new Date(new Date(Date.parse(i[5]))-1e3*a));else{for(i=i[0].match(Ht),o=1;o<i.length&&void 0===i[o];o++);var y=(" "+i[o+1]).slice(1),m=(" "+i[o+2]).slice(1);switch(i[o]){case"#":d.tagList.push(m?[y,m]:[y]);break;case"PLAYLIST-TYPE":u.type=y.toUpperCase();break;case"MEDIA-SEQUENCE":s=u.startSN=parseInt(y);break;case"TARGETDURATION":u.targetduration=parseFloat(y);break;case"VERSION":u.version=parseInt(y);break;case"EXTM3U":break;case"ENDLIST":u.live=!1;break;case"DIS":l++,d.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":l=parseInt(y);break;case"KEY":var E=y,_=new xt(E),b=_.enumeratedString("METHOD"),T=_.URI,S=_.hexadecimalInteger("IV");b&&(c=new Vt,T&&["AES-128","SAMPLE-AES"].indexOf(b)>=0&&(c.method=b,c.baseuri=e,c.reluri=T,c.key=null,c.iv=S));break;case"START":var w=y,A=new xt(w),R=A.decimalFloatingPoint("TIME-OFFSET");isNaN(R)||(u.startTimeOffset=R);break;case"MAP":var D=new xt(y);d.relurl=D.URI,d.rawByteRange=D.BYTERANGE,d.baseurl=e,d.level=r,d.type=n,d.sn="initSegment",u.initSegment=d,d=new qt;break;default:Lt.b.warn("line parsed but not handled: "+i)}}}return d=f,d&&!d.relurl&&(u.fragments.pop(),a-=d.duration),u.totalduration=a,u.averagetargetduration=a/u.fragments.length,u.endSN=s-1,u.startCC=u.fragments[0]?u.fragments[0].cc:0,u.endCC=l,u},e.prototype.loadsuccess=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=t.data,o=t.url,s=r.type,a=r.id,u=r.level,c=this.hls;if(this.loaders[s]=void 0,void 0!==o&&0!==o.indexOf("data:")||(o=r.url),e.tload=performance.now(),0===i.indexOf("#EXTM3U"))if(i.indexOf("#EXTINF:")>0){var l="audioTrack"!==s&&"subtitleTrack"!==s,f=isNaN(u)?isNaN(a)?0:a:u,d=this.parseLevelPlaylist(i,o,f,"audioTrack"===s?"audio":"subtitleTrack"===s?"subtitle":"main");d.tload=e.tload,"manifest"===s&&c.trigger(Dt.a.MANIFEST_LOADED,{levels:[{url:o,details:d}],audioTracks:[],url:o,stats:e,networkDetails:n}),e.tparsed=performance.now(),d.targetduration?l?c.trigger(Dt.a.LEVEL_LOADED,{details:d,level:u||0,id:a||0,stats:e,networkDetails:n}):"audioTrack"===s?c.trigger(Dt.a.AUDIO_TRACK_LOADED,{details:d,id:a,stats:e,networkDetails:n}):"subtitleTrack"===s&&c.trigger(Dt.a.SUBTITLE_TRACK_LOADED,{details:d,id:a,stats:e,networkDetails:n}):c.trigger(Dt.a.ERROR,{type:Ot.b.NETWORK_ERROR,details:Ot.a.MANIFEST_PARSING_ERROR,fatal:!0,url:o,reason:"invalid targetduration",networkDetails:n})}else{var h=this.parseMasterPlaylist(i,o);if(h.length){var p=this.parseMasterPlaylistMedia(i,o,"AUDIO",h[0].audioCodec),v=this.parseMasterPlaylistMedia(i,o,"SUBTITLES");if(p.length){var g=!1;p.forEach(function(t){t.url||(g=!0)}),!1===g&&h[0].audioCodec&&!h[0].attrs.AUDIO&&(Lt.b.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main"}))}c.trigger(Dt.a.MANIFEST_LOADED,{levels:h,audioTracks:p,subtitles:v,url:o,stats:e,networkDetails:n})}else c.trigger(Dt.a.ERROR,{type:Ot.b.NETWORK_ERROR,details:Ot.a.MANIFEST_PARSING_ERROR,fatal:!0,url:o,reason:"no level found in manifest",networkDetails:n})}else c.trigger(Dt.a.ERROR,{type:Ot.b.NETWORK_ERROR,details:Ot.a.MANIFEST_PARSING_ERROR,fatal:!0,url:o,reason:"no EXTM3U delimiter",networkDetails:n})},e.prototype.loaderror=function(t,e){var r,n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=e.loader;switch(e.type){case"manifest":r=Ot.a.MANIFEST_LOAD_ERROR,n=!0;break;case"level":r=Ot.a.LEVEL_LOAD_ERROR,n=!1;break;case"audioTrack":r=Ot.a.AUDIO_TRACK_LOAD_ERROR,n=!1}o&&(o.abort(),this.loaders[e.type]=void 0),this.hls.trigger(Dt.a.ERROR,{type:Ot.b.NETWORK_ERROR,details:r,fatal:n,url:o.url,loader:o,response:t,context:e,networkDetails:i})},e.prototype.loadtimeout=function(t,e){var r,n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=e.loader;switch(e.type){case"manifest":r=Ot.a.MANIFEST_LOAD_TIMEOUT,n=!0;break;case"level":r=Ot.a.LEVEL_LOAD_TIMEOUT,n=!1;break;case"audioTrack":r=Ot.a.AUDIO_TRACK_LOAD_TIMEOUT,n=!1}o&&(o.abort(),this.loaders[e.type]=void 0),this.hls.trigger(Dt.a.ERROR,{type:Ot.b.NETWORK_ERROR,details:r,fatal:n,url:o.url,loader:o,context:e,networkDetails:i})},e}(Pt),Yt=Wt,Kt=function(t){function e(r){l(this,e);var n=f(this,t.call(this,r,Dt.a.FRAG_LOADING));return n.loaders={},n}return d(e,t),e.prototype.destroy=function(){var t=this.loaders;for(var e in t){var r=t[e];r&&r.destroy()}this.loaders={},Pt.prototype.destroy.call(this)},e.prototype.onFragLoading=function(t){var e=t.frag,r=e.type,n=this.loaders[r],i=this.hls.config;e.loaded=0,n&&(Lt.b.warn("abort previous fragment loader for type:"+r),n.abort()),n=this.loaders[r]=e.loader=void 0!==i.fLoader?new i.fLoader(i):new i.loader(i);var o=void 0,s=void 0,a=void 0;o={url:e.url,frag:e,responseType:"arraybuffer",progressData:!1};var u=e.byteRangeStartOffset,c=e.byteRangeEndOffset;isNaN(u)||isNaN(c)||(o.rangeStart=u,o.rangeEnd=c),s={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:i.fragLoadingMaxRetryTimeout},a={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},n.load(o,s,a)},e.prototype.loadsuccess=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=t.data,o=r.frag;o.loader=void 0,this.loaders[o.type]=void 0,this.hls.trigger(Dt.a.FRAG_LOADED,{payload:i,frag:o,stats:e,networkDetails:n})},e.prototype.loaderror=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e.loader;n&&n.abort(),this.loaders[e.type]=void 0,this.hls.trigger(Dt.a.ERROR,{type:Ot.b.NETWORK_ERROR,details:Ot.a.FRAG_LOAD_ERROR,fatal:!1,frag:e.frag,response:t,networkDetails:r})},e.prototype.loadtimeout=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e.loader;n&&n.abort(),this.loaders[e.type]=void 0,this.hls.trigger(Dt.a.ERROR,{type:Ot.b.NETWORK_ERROR,details:Ot.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e.frag,networkDetails:r})},e.prototype.loadprogress=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e.frag;i.loaded=t.loaded,this.hls.trigger(Dt.a.FRAG_LOAD_PROGRESS,{frag:i,stats:t,networkDetails:n})},e}(Pt),zt=Kt,Xt=function(t){function e(r){h(this,e);var n=p(this,t.call(this,r,Dt.a.KEY_LOADING));return n.loaders={},n.decryptkey=null,n.decrypturl=null,n}return v(e,t),e.prototype.destroy=function(){for(var t in this.loaders){var e=this.loaders[t];e&&e.destroy()}this.loaders={},Pt.prototype.destroy.call(this)},e.prototype.onKeyLoading=function(t){var e=t.frag,r=e.type,n=this.loaders[r],i=e.decryptdata,o=i.uri;if(o!==this.decrypturl||null===this.decryptkey){var s=this.hls.config;n&&(Lt.b.warn("abort previous key loader for type:"+r),n.abort()),e.loader=this.loaders[r]=new s.loader(s),this.decrypturl=o,this.decryptkey=null;var a=void 0,u=void 0,c=void 0;a={url:o,frag:e,responseType:"arraybuffer"},u={timeout:s.fragLoadingTimeOut,maxRetry:s.fragLoadingMaxRetry,retryDelay:s.fragLoadingRetryDelay,maxRetryDelay:s.fragLoadingMaxRetryTimeout},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},e.loader.load(a,u,c)}else this.decryptkey&&(i.key=this.decryptkey,this.hls.trigger(Dt.a.KEY_LOADED,{frag:e}))},e.prototype.loadsuccess=function(t,e,r){var n=r.frag;this.decryptkey=n.decryptdata.key=new Uint8Array(t.data),n.loader=void 0,this.loaders[n.type]=void 0,this.hls.trigger(Dt.a.KEY_LOADED,{frag:n})},e.prototype.loaderror=function(t,e){var r=e.frag,n=r.loader;n&&n.abort(),this.loaders[e.type]=void 0,this.hls.trigger(Dt.a.ERROR,{type:Ot.b.NETWORK_ERROR,details:Ot.a.KEY_LOAD_ERROR,fatal:!1,frag:r,response:t})},e.prototype.loadtimeout=function(t,e){var r=e.frag,n=r.loader;n&&n.abort(),this.loaders[e.type]=void 0,this.hls.trigger(Dt.a.ERROR,{type:Ot.b.NETWORK_ERROR,details:Ot.a.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})},e}(Pt),Qt=Xt,$t={search:function(t,e){for(var r=0,n=t.length-1,i=null,o=null;r<=n;){i=(r+n)/2|0,o=t[i];var s=e(o);if(s>0)r=i+1;else{if(!(s<0))return o;n=i-1}}return null}},Zt=$t,Jt={isBuffered:function(t,e){if(t)for(var r=t.buffered,n=0;n<r.length;n++)if(e>=r.start(n)&&e<=r.end(n))return!0;return!1},bufferInfo:function(t,e,r){if(t){var n,i=t.buffered,o=[];for(n=0;n<i.length;n++)o.push({start:i.start(n),end:i.end(n)});return this.bufferedInfo(o,e,r)}return{len:0,start:e,end:e,nextStart:void 0}},bufferedInfo:function(t,e,r){var n,i,o,s,a,u=[];for(t.sort(function(t,e){var r=t.start-e.start;return r||e.end-t.end}),a=0;a<t.length;a++){var c=u.length;if(c){var l=u[c-1].end;t[a].start-l<r?t[a].end>l&&(u[c-1].end=t[a].end):u.push(t[a])}else u.push(t[a])}for(a=0,n=0,i=o=e;a<u.length;a++){var f=u[a].start,d=u[a].end;if(e+r>=f&&e<d)i=f,o=d,n=o-e;else if(e+r<f){s=f;break}}return{len:n,start:i,end:o,nextStart:s}}},te=Jt,ee=r(6),re=r(4),ne=r.n(re),ie=r(8),oe=r.n(ie),se=function(){function t(e,r){g(this,t),this.hls=e,this.id=r;var n=this.observer=new ne.a,i=e.config;n.trigger=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];n.emit.apply(n,[t,t].concat(r))},n.off=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];n.removeListener.apply(n,[t].concat(r))};var o=function(t,r){r=r||{},r.frag=this.frag,r.id=this.id,e.trigger(t,r)}.bind(this);n.on(Dt.a.FRAG_DECRYPTED,o),n.on(Dt.a.FRAG_PARSING_INIT_SEGMENT,o),n.on(Dt.a.FRAG_PARSING_DATA,o),n.on(Dt.a.FRAG_PARSED,o),n.on(Dt.a.ERROR,o),n.on(Dt.a.FRAG_PARSING_METADATA,o),n.on(Dt.a.FRAG_PARSING_USERDATA,o),n.on(Dt.a.INIT_PTS_FOUND,o);var s={mp4:MediaSource.isTypeSupported("video/mp4"),mpeg:MediaSource.isTypeSupported("audio/mpeg"),mp3:MediaSource.isTypeSupported('audio/mp4; codecs="mp3"')},a=navigator.vendor;if(i.enableWorker&&"undefined"!=typeof Worker){Lt.b.log("demuxing in webworker");var u=void 0;try{u=this.w=oe()(9),this.onwmsg=this.onWorkerMessage.bind(this),u.addEventListener("message",this.onwmsg),u.onerror=function(t){e.trigger(Dt.a.ERROR,{type:Ot.b.OTHER_ERROR,details:Ot.a.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})},u.postMessage({cmd:"init",typeSupported:s,vendor:a,id:r,config:JSON.stringify(i)})}catch(t){Lt.b.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),u&&URL.revokeObjectURL(u.objectURL),this.demuxer=new ee.a(n,s,i,a),this.w=void 0}}else this.demuxer=new ee.a(n,s,i,a)}return t.prototype.destroy=function(){var t=this.w;if(t)t.removeEventListener("message",this.onwmsg),t.terminate(),this.w=null;else{var e=this.demuxer;e&&(e.destroy(),this.demuxer=null)}var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)},t.prototype.push=function(t,e,r,n,i,o,s,a){var u=this.w,c=isNaN(i.startDTS)?i.start:i.startDTS,l=i.decryptdata,f=this.frag,d=!(f&&i.cc===f.cc),h=!(f&&i.level===f.level),p=f&&i.sn===f.sn+1,v=!h&&p;if(d&&Lt.b.log(this.id+":discontinuity detected"),h&&Lt.b.log(this.id+":switch detected"),this.frag=i,u)u.postMessage({cmd:"demux",data:t,decryptdata:l,initSegment:e,audioCodec:r,videoCodec:n,timeOffset:c,discontinuity:d,trackSwitch:h,contiguous:v,duration:o,accurateTimeOffset:s,defaultInitPTS:a},[t]);else{var g=this.demuxer;g&&g.push(t,l,e,r,n,c,d,h,v,o,s,a)}},t.prototype.onWorkerMessage=function(t){var e=t.data,r=this.hls;switch(e.event){case"init":URL.revokeObjectURL(this.w.objectURL);break;case Dt.a.FRAG_PARSING_DATA:e.data.data1=new Uint8Array(e.data1),e.data2&&(e.data.data2=new Uint8Array(e.data2));default:e.data=e.data||{},e.data.frag=this.frag,e.data.id=this.id,r.trigger(e.event,e.data)}},t}(),ae=se,ue={toString:function(t){for(var e="",r=t.length,n=0;n<r;n++)e+="["+t.start(n).toFixed(3)+","+t.end(n).toFixed(3)+"]";return e}},ce=ue,le=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),fe={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR"},de=function(t){function e(r){R(this,e);var n=D(this,t.call(this,r,Dt.a.MEDIA_ATTACHED,Dt.a.MEDIA_DETACHING,Dt.a.MANIFEST_LOADING,Dt.a.MANIFEST_PARSED,Dt.a.LEVEL_LOADED,Dt.a.KEY_LOADED,Dt.a.FRAG_LOADED,Dt.a.FRAG_LOAD_EMERGENCY_ABORTED,Dt.a.FRAG_PARSING_INIT_SEGMENT,Dt.a.FRAG_PARSING_DATA,Dt.a.FRAG_PARSED,Dt.a.ERROR,Dt.a.AUDIO_TRACK_SWITCHING,Dt.a.AUDIO_TRACK_SWITCHED,Dt.a.BUFFER_CREATED,Dt.a.BUFFER_APPENDED,Dt.a.BUFFER_FLUSHED));return n.config=r.config,n.audioCodecSwap=!1,n.ticks=0,n._state=fe.STOPPED,n.ontick=n.tick.bind(n),n}return O(e,t),e.prototype.destroy=function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),Pt.prototype.destroy.call(this),this.state=fe.STOPPED},e.prototype.startLoad=function(t){if(this.levels){var e=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var n=r.startLevel;-1===n&&(n=0,this.bitrateTest=!0),this.level=r.nextLoadLevel=n,this.loadedmetadata=!1}e>0&&-1===t&&(Lt.b.log("override startPosition with lastCurrentTime @"+e.toFixed(3)),t=e),this.state=fe.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}else this.forceStartLoad=!0,this.state=fe.STOPPED},e.prototype.stopLoad=function(){var t=this.fragCurrent;t&&(t.loader&&t.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=fe.STOPPED,this.forceStartLoad=!1},e.prototype.tick=function(){1===++this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)},e.prototype.doTick=function(){switch(this.state){case fe.ERROR:break;case fe.BUFFER_FLUSHING:this.fragLoadError=0;break;case fe.IDLE:this._doTickIdle();break;case fe.WAITING_LEVEL:var t=this.levels[this.level];t&&t.details&&(this.state=fe.IDLE);break;case fe.FRAG_LOADING_WAITING_RETRY:var e=performance.now(),r=this.retryDate;(!r||e>=r||this.media&&this.media.seeking)&&(Lt.b.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=fe.IDLE);break;case fe.ERROR:case fe.STOPPED:case fe.FRAG_LOADING:case fe.PARSING:case fe.PARSED:case fe.ENDED:}this._checkBuffer(),this._checkFragmentChanged()},e.prototype._doTickIdle=function(){var t=this.hls,e=t.config,r=this.media;if(void 0===this.levelLastLoaded||r||!this.startFragRequested&&e.startFragPrefetch){var n=void 0;n=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var i=t.nextLoadLevel,o=this.levels[i];if(o){var s=o.bitrate,a=void 0;a=s?Math.max(8*e.maxBufferSize/s,e.maxBufferLength):e.maxBufferLength,a=Math.min(a,e.maxMaxBufferLength);var u=te.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,n,e.maxBufferHole),c=u.len;if(!(c>=a)){Lt.b.trace("buffer length of "+c.toFixed(3)+" is below max of "+a.toFixed(3)+". checking for more payload ..."),this.level=t.nextLoadLevel=i;var l=o.details;if(void 0===l||l.live&&this.levelLastLoaded!==i)return void(this.state=fe.WAITING_LEVEL);var f=this.fragPrevious;if(!l.live&&f&&f.sn===l.endSN&&!u.nextStart){if(Math.min(r.duration,f.start+f.duration)-Math.max(u.end,f.start)<=Math.max(.2,f.duration)){var d={};return this.altAudio&&(d.type="video"),this.hls.trigger(Dt.a.BUFFER_EOS,d),void(this.state=fe.ENDED)}}this._fetchPayloadOrEos(n,u,l)}}}},e.prototype._fetchPayloadOrEos=function(t,e,r){var n=this.fragPrevious,i=this.level,o=r.fragments,s=o.length;if(0!==s){var a=o[0].start,u=o[s-1].start+o[s-1].duration,c=e.end,l=void 0;if(r.initSegment&&!r.initSegment.data)l=r.initSegment;else if(r.live){var f=this.config.initialLiveManifestSize;if(s<f)return void Lt.b.warn("Can not start playback of a level, reason: not enough fragments "+s+" < "+f);if(null===(l=this._ensureFragmentAtLivePoint(r,c,a,u,n,o,s)))return}else c<a&&(l=o[0]);l||(l=this._findFragment(a,n,s,o,c,u,r)),l&&this._loadFragmentOrKey(l,i,r,t,c)}},e.prototype._ensureFragmentAtLivePoint=function(t,e,r,n,i,o,s){var a=this.hls.config,u=this.media,c=void 0,l=void 0!==a.liveMaxLatencyDuration?a.liveMaxLatencyDuration:a.liveMaxLatencyDurationCount*t.targetduration;if(e<Math.max(r-a.maxFragLookUpTolerance,n-l)){var f=this.liveSyncPosition=this.computeLivePosition(r,t);Lt.b.log("buffer end: "+e.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+f.toFixed(3)),e=f,u&&u.readyState&&u.duration>f&&(u.currentTime=f),this.nextLoadPosition=f}if(t.PTSKnown&&e>n&&u&&u.readyState)return null;if(this.startFragRequested&&!t.PTSKnown){if(i){var d=i.sn+1;if(d>=t.startSN&&d<=t.endSN){var h=o[d-t.startSN];i.cc===h.cc&&(c=h,Lt.b.log("live playlist, switching playlist, load frag with next SN: "+c.sn))}c||(c=Zt.search(o,function(t){return i.cc-t.cc}))&&Lt.b.log("live playlist, switching playlist, load frag with same CC: "+c.sn)}c||(c=o[Math.min(s-1,Math.round(s/2))],Lt.b.log("live playlist, switching playlist, unknown, load middle frag : "+c.sn))}return c},e.prototype._findFragment=function(t,e,r,n,i,o,s){var a=this.hls.config,u=void 0,c=void 0,l=a.maxFragLookUpTolerance,f=e?n[e.sn-n[0].sn+1]:void 0,d=function(t){var e=Math.min(l,t.duration);return t.start+t.duration-e<=i?1:t.start-e>i&&t.start?-1:0};if(i<o?(i>o-l&&(l=0),c=f&&!d(f)?f:Zt.search(n,d)):c=n[r-1],c){u=c;var h=u.sn-s.startSN,p=e&&u.level===e.level,v=n[h-1],g=n[h+1];if(e&&u.sn===e.sn)if(p&&!u.backtracked)if(u.sn<s.endSN){var y=e.deltaPTS;y&&y>a.maxBufferHole&&e.dropped&&h?(u=v,Lt.b.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this"),e.loadCounter--):(u=g,Lt.b.log("SN just loaded, load next one: "+u.sn))}else u=null;else u.backtracked&&(g&&g.backtracked?(Lt.b.warn("Already backtracked from fragment "+g.sn+", will not backtrack to fragment "+u.sn+". Loading fragment "+g.sn),u=g):(Lt.b.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),u.dropped=0,v?(v.loadCounter&&v.loadCounter--,u=v,u.backtracked=!0):h&&(u=null)))}return u},e.prototype._loadFragmentOrKey=function(t,e,r,n,i){var o=this.hls,s=o.config;if(!t.decryptdata||null==t.decryptdata.uri||null!=t.decryptdata.key){if(Lt.b.log("Loading "+t.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+e+", currentTime:"+n.toFixed(3)+",bufferEnd:"+i.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,t.loadCounter){t.loadCounter++;var a=s.fragLoadingLoopThreshold;if(t.loadCounter>a&&Math.abs(this.fragLoadIdx-t.loadIdx)<a)return void o.trigger(Dt.a.ERROR,{type:Ot.b.MEDIA_ERROR,details:Ot.a.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:t})}else t.loadCounter=1;return t.loadIdx=this.fragLoadIdx,t.autoLevel=o.autoLevelEnabled,t.bitrateTest=this.bitrateTest,this.fragCurrent=t,this.startFragRequested=!0,isNaN(t.sn)||t.bitrateTest||(this.nextLoadPosition=t.start+t.duration),o.trigger(Dt.a.FRAG_LOADING,{frag:t}),this.demuxer||(this.demuxer=new ae(o,"main")),void(this.state=fe.FRAG_LOADING)}Lt.b.log("Loading key for "+t.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+e),this.state=fe.KEY_LOADING,o.trigger(Dt.a.KEY_LOADING,{frag:t})},e.prototype.getBufferedFrag=function(t){return Zt.search(this._bufferedFrags,function(e){return t<e.startPTS?-1:t>e.endPTS?1:0})},e.prototype.followingBufferedFrag=function(t){return t?this.getBufferedFrag(t.endPTS+.5):null},e.prototype._checkFragmentChanged=function(){var t,e,r=this.media;if(r&&r.readyState&&!1===r.seeking&&(e=r.currentTime,e>r.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=e),te.isBuffered(r,e)?t=this.getBufferedFrag(e):te.isBuffered(r,e+.1)&&(t=this.getBufferedFrag(e+.1)),t)){var n=t;if(n!==this.fragPlaying){this.hls.trigger(Dt.a.FRAG_CHANGED,{frag:n});var i=n.level;this.fragPlaying&&this.fragPlaying.level===i||this.hls.trigger(Dt.a.LEVEL_SWITCHED,{level:i}),this.fragPlaying=n}}},e.prototype.immediateLevelSwitch=function(){if(Lt.b.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var t=this.media,e=void 0;t?(e=t.paused,t.pause()):e=!0,this.previouslyPaused=e}var r=this.fragCurrent;r&&r.loader&&r.loader.abort(),this.fragCurrent=null,void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},e.prototype.immediateLevelSwitchEnd=function(){var t=this.media;t&&t.buffered.length&&(this.immediateSwitch=!1,te.isBuffered(t,t.currentTime)&&(t.currentTime-=1e-4),this.previouslyPaused||t.play())},e.prototype.nextLevelSwitch=function(){var t=this.media;if(t&&t.readyState){var e=void 0,r=void 0,n=void 0;if(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,r=this.getBufferedFrag(t.currentTime),r&&r.startPTS>1&&this.flushMainBuffer(0,r.startPTS-1),t.paused)e=0;else{var i=this.hls.nextLoadLevel,o=this.levels[i],s=this.fragLastKbps;e=s&&this.fragCurrent?this.fragCurrent.duration*o.bitrate/(1e3*s)+1:0}if((n=this.getBufferedFrag(t.currentTime+e))&&(n=this.followingBufferedFrag(n))){var a=this.fragCurrent;a&&a.loader&&a.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(n.maxStartPTS,Number.POSITIVE_INFINITY)}}},e.prototype.flushMainBuffer=function(t,e){this.state=fe.BUFFER_FLUSHING;var r={startOffset:t,endOffset:e};this.altAudio&&(r.type="video"),this.hls.trigger(Dt.a.BUFFER_FLUSHING,r)},e.prototype.onMediaAttached=function(t){var e=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),e.addEventListener("seeking",this.onvseeking),e.addEventListener("seeked",this.onvseeked),e.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition)},e.prototype.onMediaDetaching=function(){var t=this.media;t&&t.ended&&(Lt.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var e=this.levels;e&&e.forEach(function(t){t.details&&t.details.fragments.forEach(function(t){t.loadCounter=void 0,t.backtracked=void 0})}),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("seeked",this.onvseeked),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},e.prototype.onMediaSeeking=function(){var t=this.media,e=t?t.currentTime:void 0,r=this.config;isNaN(e)||Lt.b.log("media seeking to "+e.toFixed(3));var n=this.mediaBuffer?this.mediaBuffer:t,i=te.bufferInfo(n,e,this.config.maxBufferHole);if(this.state===fe.FRAG_LOADING){var o=this.fragCurrent;if(0===i.len&&o){var s=r.maxFragLookUpTolerance,a=o.start-s,u=o.start+o.duration+s;e<a||e>u?(o.loader&&(Lt.b.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),o.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=fe.IDLE):Lt.b.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===fe.ENDED&&(0===i.len&&(this.fragPrevious=0),this.state=fe.IDLE);t&&(this.lastCurrentTime=e),this.state!==fe.FRAG_LOADING&&void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*r.fragLoadingLoopThreshold),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=e),this.tick()},e.prototype.onMediaSeeked=function(){var t=this.media,e=t?t.currentTime:void 0;isNaN(e)||Lt.b.log("media seeked to "+e.toFixed(3)),this.tick()},e.prototype.onMediaEnded=function(){Lt.b.log("media ended"),this.startPosition=this.lastCurrentTime=0},e.prototype.onManifestLoading=function(){Lt.b.log("trigger BUFFER_RESET"),this.hls.trigger(Dt.a.BUFFER_RESET),this._bufferedFrags=[],this.stalled=!1,this.startPosition=this.lastCurrentTime=0},e.prototype.onManifestParsed=function(t){var e,r=!1,n=!1;t.levels.forEach(function(t){(e=t.audioCodec)&&(-1!==e.indexOf("mp4a.40.2")&&(r=!0),-1!==e.indexOf("mp4a.40.5")&&(n=!0))}),this.audioCodecSwitch=r&&n,this.audioCodecSwitch&&Lt.b.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startLevelLoaded=!1,this.startFragRequested=!1;var i=this.config;(i.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(i.startPosition)},e.prototype.onLevelLoaded=function(t){var e=t.details,r=t.level,n=this.levels[this.levelLastLoaded],i=this.levels[r],o=e.totalduration,s=0;if(Lt.b.log("level "+r+" loaded ["+e.startSN+","+e.endSN+"],duration:"+o),e.live){var a=i.details;a&&e.fragments.length>0?(E(a,e),s=e.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(s,a),e.PTSKnown&&!isNaN(s)?Lt.b.log("live playlist sliding:"+s.toFixed(3)):(Lt.b.log("live playlist - outdated PTS, unknown sliding"),A(this.fragPrevious,n,e))):(Lt.b.log("live playlist - first load, unknown sliding"),e.PTSKnown=!1,A(this.fragPrevious,n,e))}else e.PTSKnown=!1;if(i.details=e,this.levelLastLoaded=r,this.hls.trigger(Dt.a.LEVEL_UPDATED,{details:e,level:r}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var u=e.startTimeOffset;isNaN(u)?e.live?(this.startPosition=this.computeLivePosition(s,e),Lt.b.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(u<0&&(Lt.b.log("negative start time offset "+u+", count from end of last fragment"),u=s+o+u),Lt.b.log("start time offset found in playlist, adjust startPosition to "+u),this.startPosition=u),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===fe.WAITING_LEVEL&&(this.state=fe.IDLE),this.tick()},e.prototype.onKeyLoaded=function(){this.state===fe.KEY_LOADING&&(this.state=fe.IDLE,this.tick())},e.prototype.onFragLoaded=function(t){var e=this.fragCurrent,r=t.frag;if(this.state===fe.FRAG_LOADING&&e&&"main"===r.type&&r.level===e.level&&r.sn===e.sn){var n=t.stats,i=this.levels[e.level],o=i.details;if(Lt.b.log("Loaded  "+e.sn+" of ["+o.startSN+" ,"+o.endSN+"],level "+e.level),this.bitrateTest=!1,this.stats=n,!0===r.bitrateTest&&this.hls.nextLoadLevel)this.state=fe.IDLE,this.startFragRequested=!1,n.tparsed=n.tbuffered=performance.now(),this.hls.trigger(Dt.a.FRAG_BUFFERED,{stats:n,frag:e,id:"main"}),this.tick();else if("initSegment"===r.sn)this.state=fe.IDLE,n.tparsed=n.tbuffered=performance.now(),o.initSegment.data=t.payload,this.hls.trigger(Dt.a.FRAG_BUFFERED,{stats:n,frag:e,id:"main"}),this.tick();else{this.state=fe.PARSING;var s=o.totalduration,a=e.level,u=e.sn,c=this.config.defaultAudioCodec||i.audioCodec;this.audioCodecSwap&&(Lt.b.log("swapping playlist audio codec"),void 0===c&&(c=this.lastAudioCodec),c&&(c=-1!==c.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),this.pendingBuffering=!0,this.appended=!1,Lt.b.log("Parsing "+u+" of ["+o.startSN+" ,"+o.endSN+"],level "+a+", cc "+e.cc);var l=this.demuxer;l||(l=this.demuxer=new ae(this.hls,"main"));var f=this.media,d=f&&f.seeking,h=!d&&(o.PTSKnown||!o.live),p=o.initSegment?o.initSegment.data:[];l.push(t.payload,p,c,i.videoCodec,e,s,h,void 0)}}this.fragLoadError=0},e.prototype.onFragParsingInitSegment=function(t){var e=this.fragCurrent,r=t.frag;if(e&&"main"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===fe.PARSING){var n,i,o=t.tracks;if(o.audio&&this.altAudio&&delete o.audio,i=o.audio){var s=this.levels[this.level].audioCodec,a=navigator.userAgent.toLowerCase();s&&this.audioCodecSwap&&(Lt.b.log("swapping playlist audio codec"),s=-1!==s.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==i.metadata.channelCount&&-1===a.indexOf("firefox")&&(s="mp4a.40.5"),-1!==a.indexOf("android")&&"audio/mpeg"!==i.container&&(s="mp4a.40.2",Lt.b.log("Android: force audio codec to "+s)),i.levelCodec=s,i.id=t.id}i=o.video,i&&(i.levelCodec=this.levels[this.level].videoCodec,i.id=t.id),this.hls.trigger(Dt.a.BUFFER_CODECS,o);for(n in o){i=o[n],Lt.b.log("main track:"+n+",container:"+i.container+",codecs[level/parsed]=["+i.levelCodec+"/"+i.codec+"]");var u=i.initSegment;u&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(Dt.a.BUFFER_APPENDING,{type:n,data:u,parent:"main",content:"initSegment"}))}this.tick()}},e.prototype.onFragParsingData=function(t){var e=this,r=this.fragCurrent,n=t.frag;if(r&&"main"===t.id&&n.sn===r.sn&&n.level===r.level&&("audio"!==t.type||!this.altAudio)&&this.state===fe.PARSING){var i=this.levels[this.level],o=r;if(isNaN(t.endPTS)&&(t.endPTS=t.startPTS+r.duration,t.endDTS=t.startDTS+r.duration),Lt.b.log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0)),"video"===t.type)if(o.dropped=t.dropped,o.dropped){if(!o.backtracked)return Lt.b.warn("missing video frame(s), backtracking fragment"),o.backtracked=!0,this.nextLoadPosition=t.startPTS,this.state=fe.IDLE,this.fragPrevious=o,void this.tick();Lt.b.warn("Already backtracked on this fragment, appending with the gap")}else o.backtracked=!1;var s=m(i.details,o,t.startPTS,t.endPTS,t.startDTS,t.endDTS),a=this.hls;a.trigger(Dt.a.LEVEL_PTS_UPDATED,{details:i.details,level:this.level,drift:s,type:t.type,start:t.startPTS,end:t.endPTS}),[t.data1,t.data2].forEach(function(r){r&&r.length&&e.state===fe.PARSING&&(e.appended=!0,e.pendingBuffering=!0,a.trigger(Dt.a.BUFFER_APPENDING,{type:t.type,data:r,parent:"main",content:"data"}))}),this.tick()}},e.prototype.onFragParsed=function(t){var e=this.fragCurrent,r=t.frag;e&&"main"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===fe.PARSING&&(this.stats.tparsed=performance.now(),this.state=fe.PARSED,this._checkAppendedParsed())},e.prototype.onAudioTrackSwitching=function(t){var e=!!t.url,r=t.id;if(!e){if(this.mediaBuffer!==this.media){Lt.b.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var n=this.fragCurrent;n.loader&&(Lt.b.log("switching to main audio track, cancel main fragment load"),n.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=fe.IDLE}var i=this.hls;i.trigger(Dt.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),i.trigger(Dt.a.AUDIO_TRACK_SWITCHED,{id:r}),this.altAudio=!1}},e.prototype.onAudioTrackSwitched=function(t){var e=t.id,r=!!this.hls.audioTracks[e].url;if(r){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(Lt.b.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=r,this.tick()},e.prototype.onBufferCreated=function(t){var e=t.tracks,r=void 0,n=void 0,i=!1;for(var o in e){var s=e[o];"main"===s.id?(n=o,r=s,"video"===o&&(this.videoBuffer=e[o].buffer)):i=!0}i&&r?(Lt.b.log("alternate track found, use "+n+".buffered to schedule main fragment loading"),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media},e.prototype.onBufferAppended=function(t){if("main"===t.parent){var e=this.state;e!==fe.PARSING&&e!==fe.PARSED||(this.pendingBuffering=t.pending>0,this._checkAppendedParsed())}},e.prototype._checkAppendedParsed=function(){if(!(this.state!==fe.PARSED||this.appended&&this.pendingBuffering)){var t=this.fragCurrent;if(t){var e=this.mediaBuffer?this.mediaBuffer:this.media;Lt.b.log("main buffered : "+ce.toString(e.buffered));var r=this._bufferedFrags.filter(function(t){return te.isBuffered(e,(t.startPTS+t.endPTS)/2)});r.push(t),this._bufferedFrags=r.sort(function(t,e){return t.startPTS-e.startPTS}),this.fragPrevious=t;var n=this.stats;n.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*n.total/(n.tbuffered-n.tfirst)),this.hls.trigger(Dt.a.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.state=fe.IDLE}this.tick()}},e.prototype.onError=function(t){var e=t.frag||this.fragCurrent;if(!e||"main"===e.type){var r=!!this.media&&te.isBuffered(this.media,this.media.currentTime)&&te.isBuffered(this.media,this.media.currentTime+.5);switch(t.details){case Ot.a.FRAG_LOAD_ERROR:case Ot.a.FRAG_LOAD_TIMEOUT:case Ot.a.KEY_LOAD_ERROR:case Ot.a.KEY_LOAD_TIMEOUT:if(!t.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var n=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);e.loadCounter=0,Lt.b.warn("mediaController: frag loading failed, retry in "+n+" ms"),this.retryDate=performance.now()+n,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=fe.FRAG_LOADING_WAITING_RETRY}else Lt.b.error("mediaController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=fe.ERROR;break;case Ot.a.FRAG_LOOP_LOADING_ERROR:t.fatal||(r?(this._reduceMaxBufferLength(e.duration),this.state=fe.IDLE):e.autoLevel&&0!==e.level||(t.fatal=!0,this.state=fe.ERROR));break;case Ot.a.LEVEL_LOAD_ERROR:case Ot.a.LEVEL_LOAD_TIMEOUT:this.state!==fe.ERROR&&(t.fatal?(this.state=fe.ERROR,Lt.b.warn("streamController: "+t.details+",switch to "+this.state+" state ...")):t.levelRetry||this.state!==fe.WAITING_LEVEL||(this.state=fe.IDLE));break;case Ot.a.BUFFER_FULL_ERROR:"main"!==t.parent||this.state!==fe.PARSING&&this.state!==fe.PARSED||(r?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=fe.IDLE):(Lt.b.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},e.prototype._reduceMaxBufferLength=function(t){var e=this.config;e.maxMaxBufferLength>=t&&(e.maxMaxBufferLength/=2,Lt.b.warn("main:reduce max buffer length to "+e.maxMaxBufferLength+"s"),this.fragLoadIdx+=2*e.fragLoadingLoopThreshold)},e.prototype._checkBuffer=function(){var t=this.media,e=this.config;if(t&&t.readyState){var r=t.currentTime,n=this.mediaBuffer?this.mediaBuffer:t,i=n.buffered;if(!this.loadedmetadata&&i.length){this.loadedmetadata=!0;var o=t.seeking?r:this.startPosition,s=te.isBuffered(n,o),a=i.start(0);(r!==o||!s&&Math.abs(o-a)<e.maxSeekHole)&&(Lt.b.log("target start position:"+o),s||(o=a,Lt.b.log("target start position not buffered, seek to buffered.start(0) "+o)),Lt.b.log("adjust currentTime from "+r+" to "+o),t.currentTime=o)}else if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var u=te.bufferInfo(t,r,0),c=!(t.paused||t.ended||0===t.buffered.length),l=.5,f=r!==this.lastCurrentTime;if(f)this.stallReported&&(Lt.b.warn("playback not stuck anymore @"+r+", after "+Math.round(performance.now()-this.stalled)+"ms"),this.stallReported=!1),this.stalled=void 0,this.nudgeRetry=0;else if(c){var d=performance.now(),h=this.hls;if(this.stalled){var p=d-this.stalled,v=u.len,g=this.nudgeRetry||0;if(v<=l&&p>1e3*e.lowBufferWatchdogPeriod){this.stallReported||(this.stallReported=!0,Lt.b.warn("playback stalling in low buffer @"+r),h.trigger(Dt.a.ERROR,{type:Ot.b.MEDIA_ERROR,details:Ot.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:v}));var y=u.nextStart,m=y-r;if(y&&m<e.maxSeekHole&&m>0){this.nudgeRetry=++g;var E=g*e.nudgeOffset;Lt.b.log("adjust currentTime from "+t.currentTime+" to next buffered @ "+y+" + nudge "+E),t.currentTime=y+E,this.stalled=void 0,h.trigger(Dt.a.ERROR,{type:Ot.b.MEDIA_ERROR,details:Ot.a.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:y+E-r})}}else if(v>l&&p>1e3*e.highBufferWatchdogPeriod)if(this.stallReported||(this.stallReported=!0,Lt.b.warn("playback stalling in high buffer @"+r),h.trigger(Dt.a.ERROR,{type:Ot.b.MEDIA_ERROR,details:Ot.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:v})),this.stalled=void 0,this.nudgeRetry=++g,g<e.nudgeMaxRetry){var _=t.currentTime,b=_+g*e.nudgeOffset;Lt.b.log("adjust currentTime from "+_+" to "+b),t.currentTime=b,h.trigger(Dt.a.ERROR,{type:Ot.b.MEDIA_ERROR,details:Ot.a.BUFFER_NUDGE_ON_STALL,fatal:!1})}else Lt.b.error("still stuck in high buffer @"+r+" after "+e.nudgeMaxRetry+", raise fatal error"),h.trigger(Dt.a.ERROR,{type:Ot.b.MEDIA_ERROR,details:Ot.a.BUFFER_STALLED_ERROR,fatal:!0})}else this.stalled=d,this.stallReported=!1}}}},e.prototype.onFragLoadEmergencyAborted=function(){this.state=fe.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},e.prototype.onBufferFlushed=function(){var t=this.mediaBuffer?this.mediaBuffer:this.media;this._bufferedFrags=this._bufferedFrags.filter(function(e){return te.isBuffered(t,(e.startPTS+e.endPTS)/2)}),this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=fe.IDLE,this.fragPrevious=null},e.prototype.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},e.prototype.computeLivePosition=function(t,e){var r=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*e.targetduration;return t+Math.max(0,e.totalduration-r)},le(e,[{key:"state",set:function(t){if(this.state!==t){var e=this.state;this._state=t,Lt.b.log("main stream:"+e+"->"+t),this.hls.trigger(Dt.a.STREAM_STATE_TRANSITION,{previousState:e,nextState:t})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var t=this.media;if(t){var e=this.getBufferedFrag(t.currentTime);if(e)return e.level}return-1}},{key:"nextBufferedFrag",get:function(){var t=this.media;return t?this.followingBufferedFrag(this.getBufferedFrag(t.currentTime)):null}},{key:"nextLevel",get:function(){var t=this.nextBufferedFrag;return t?t.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(t){this._liveSyncPosition=t}}]),e}(Pt),he=de,pe=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),ve=function(t){function e(r){L(this,e);var n=C(this,t.call(this,r,Dt.a.MANIFEST_LOADED,Dt.a.LEVEL_LOADED,Dt.a.FRAG_LOADED,Dt.a.ERROR));return n.ontick=n.tick.bind(n),n._manualLevel=-1,n}return I(e,t),e.prototype.destroy=function(){this.cleanTimer(),this._manualLevel=-1},e.prototype.cleanTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},e.prototype.startLoad=function(){this.canload=!0;var t=this._levels;t&&t.forEach(function(t){t.loadError=0;var e=t.details;e&&e.live&&(t.details=void 0)}),this.timer&&this.tick()},e.prototype.stopLoad=function(){this.canload=!1},e.prototype.onManifestLoaded=function(t){var e,r=[],n=[],i={},o=!1,a=!1,u=this.hls,c=/chrome|firefox/.test(navigator.userAgent.toLowerCase());if(t.levels.forEach(function(t){t.videoCodec&&(o=!0),c&&t.audioCodec&&-1!==t.audioCodec.indexOf("mp4a.40.34")&&(t.audioCodec=void 0),(t.audioCodec||t.attrs&&t.attrs.AUDIO)&&(a=!0);var e=i[t.bitrate];void 0===e?(i[t.bitrate]=r.length,t.url=[t.url],t.urlId=0,r.push(t)):r[e].url.push(t.url)}),o&&a?r.forEach(function(t){t.videoCodec&&n.push(t)}):n=r,n=n.filter(function(t){var e=t.audioCodec,r=t.videoCodec;return(!e||s(e))&&(!r||s(r))}),n.length){e=n[0].bitrate,n.sort(function(t,e){return t.bitrate-e.bitrate}),this._levels=n;for(var l=0;l<n.length;l++)if(n[l].bitrate===e){this._firstLevel=l,Lt.b.log("manifest loaded,"+n.length+" level(s) found, first bitrate:"+e);break}u.trigger(Dt.a.MANIFEST_PARSED,{levels:n,firstLevel:this._firstLevel,stats:t.stats,audio:a,video:o,altAudio:t.audioTracks.length>0})}else u.trigger(Dt.a.ERROR,{type:Ot.b.MEDIA_ERROR,details:Ot.a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:u.url,reason:"no level with compatible codecs found in manifest"})},e.prototype.setLevelInternal=function(t){var e=this._levels,r=this.hls;if(t>=0&&t<e.length){if(this.cleanTimer(),this._level!==t){Lt.b.log("switching to level "+t),this._level=t;var n=e[t];n.level=t,r.trigger(Dt.a.LEVEL_SWITCH,n),r.trigger(Dt.a.LEVEL_SWITCHING,n)}var i=e[t],o=i.details;if(!o||!0===o.live){var s=i.urlId;r.trigger(Dt.a.LEVEL_LOADING,{url:i.url[s],level:t,id:s})}}else r.trigger(Dt.a.ERROR,{type:Ot.b.OTHER_ERROR,details:Ot.a.LEVEL_SWITCH_ERROR,level:t,fatal:!1,reason:"invalid level idx"})},e.prototype.onError=function(t){if(t.fatal)return void(t.type===Ot.b.NETWORK_ERROR&&this.cleanTimer());var e=t.details,r=this.hls,n=void 0,i=void 0,o=!1;switch(e){case Ot.a.FRAG_LOAD_ERROR:case Ot.a.FRAG_LOAD_TIMEOUT:case Ot.a.FRAG_LOOP_LOADING_ERROR:case Ot.a.KEY_LOAD_ERROR:case Ot.a.KEY_LOAD_TIMEOUT:n=t.frag.level;break;case Ot.a.LEVEL_LOAD_ERROR:case Ot.a.LEVEL_LOAD_TIMEOUT:n=t.context.level,o=!0;break;case Ot.a.REMUX_ALLOC_ERROR:n=t.level}if(void 0!==n){i=this._levels[n],i.loadError?i.loadError++:i.loadError=1;var s=i.url.length;if(s>1&&i.loadError<s)i.urlId=(i.urlId+1)%s,i.details=void 0,Lt.b.warn("level controller,"+e+" for level "+n+": switching to redundant stream id "+i.urlId);else{if(-1===this._manualLevel&&n)Lt.b.warn("level controller,"+e+": switch-down for next fragment"),r.nextAutoLevel=Math.max(0,n-1);else if(i&&i.details&&i.details.live)Lt.b.warn("level controller,"+e+" on live stream, discard"),o&&(this._level=void 0);else if(e===Ot.a.LEVEL_LOAD_ERROR||e===Ot.a.LEVEL_LOAD_TIMEOUT){var a=r.media,u=a&&te.isBuffered(a,a.currentTime)&&te.isBuffered(a,a.currentTime+.5);if(u){var c=r.config.levelLoadingRetryDelay;Lt.b.warn("level controller,"+e+", but media buffered, retry in "+c+"ms"),this.timer=setTimeout(this.ontick,c),t.levelRetry=!0}else Lt.b.error("cannot recover "+e+" error"),this._level=void 0,this.cleanTimer(),t.fatal=!0}}}},e.prototype.onFragLoaded=function(t){var e=t.frag;if(e&&"main"===e.type){var r=this._levels[e.level];r&&(r.loadError=0)}},e.prototype.onLevelLoaded=function(t){var e=t.level;if(e===this._level){var r=this._levels[e];r.loadError=0;var n=t.details;if(n.live){var i=1e3*(n.averagetargetduration?n.averagetargetduration:n.targetduration),o=r.details;o&&n.endSN===o.endSN&&(i/=2,Lt.b.log("same live playlist, reload twice faster")),i-=performance.now()-t.stats.trequest,i=Math.max(1e3,Math.round(i)),Lt.b.log("live playlist, reload in "+i+" ms"),this.timer=setTimeout(this.ontick,i)}else this.timer=null}},e.prototype.tick=function(){var t=this._level;if(void 0!==t&&this.canload){var e=this._levels[t];if(e&&e.url){var r=e.urlId;this.hls.trigger(Dt.a.LEVEL_LOADING,{url:e.url[r],level:t,id:r})}}},pe(e,[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this._level},set:function(t){var e=this._levels;e&&e.length>t&&(this._level===t&&void 0!==e[t].details||this.setLevelInternal(t))}},{key:"manualLevel",get:function(){return this._manualLevel},set:function(t){this._manualLevel=t,void 0===this._startLevel&&(this._startLevel=t),-1!==t&&(this.level=t)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(t){this._firstLevel=t}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var t=this.hls.config.startLevel;return void 0!==t?t:this._firstLevel}return this._startLevel},set:function(t){this._startLevel=t}},{key:"nextLoadLevel",get:function(){return-1!==this._manualLevel?this._manualLevel:this.hls.nextAutoLevel},set:function(t){this.level=t,-1===this._manualLevel&&(this.hls.nextAutoLevel=t)}}]),e}(Pt),ge=ve,ye=r(3),me=function(t){function e(r){P(this,e);var n=M(this,t.call(this,r,Dt.a.MEDIA_ATTACHED,Dt.a.MEDIA_DETACHING,Dt.a.FRAG_PARSING_METADATA));return n.id3Track=void 0,n.media=void 0,n}return N(e,t),e.prototype.destroy=function(){Pt.prototype.destroy.call(this)},e.prototype.onMediaAttached=function(t){this.media=t.media,this.media},e.prototype.onMediaDetaching=function(){this.media=void 0},e.prototype.onFragParsingMetadata=function(t){var e=t.frag,r=t.samples;this.id3Track||(this.id3Track=this.media.addTextTrack("metadata","id3"),this.id3Track.mode="hidden");for(var n=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,i=0;i<r.length;i++){var o=ye.a.getID3Frames(r[i].data);if(o){var s=r[i].pts,a=i<r.length-1?r[i+1].pts:e.endPTS;s===a&&(a+=1e-4);for(var u=0;u<o.length;u++){var c=o[u];if(!ye.a.isTimeStampFrame(c)){var l=new n(s,a,"");l.value=c,this.id3Track.addCue(l)}}}}},e}(Pt),Ee=me,_e=function(){function t(e){k(this,t),this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}return t.prototype.sample=function(t,e){var r=Math.pow(this.alpha_,t);this.estimate_=e*(1-r)+r*this.estimate_,this.totalWeight_+=t},t.prototype.getTotalWeight=function(){return this.totalWeight_},t.prototype.getEstimate=function(){if(this.alpha_){var t=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/t}return this.estimate_},t}(),be=_e,Te=function(){function t(e,r,n,i){x(this,t),this.hls=e,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new be(r),this.fast_=new be(n)}return t.prototype.sample=function(t,e){t=Math.max(t,this.minDelayMs_);var r=8e3*e/t,n=t/1e3;this.fast_.sample(n,r),this.slow_.sample(n,r)},t.prototype.canEstimate=function(){var t=this.fast_;return t&&t.getTotalWeight()>=this.minWeight_},t.prototype.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.prototype.destroy=function(){},t}(),Se=Te,we=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),Ae=function(t){function e(r){F(this,e);var n=U(this,t.call(this,r,Dt.a.FRAG_LOADING,Dt.a.FRAG_LOADED,Dt.a.FRAG_BUFFERED,Dt.a.ERROR));return n.lastLoadedFragLevel=0,n._nextAutoLevel=-1,n.hls=r,n.timer=null,n._bwEstimator=null,n.onCheck=n._abandonRulesCheck.bind(n),n}return B(e,t),e.prototype.destroy=function(){this.clearTimer(),Pt.prototype.destroy.call(this)},e.prototype.onFragLoading=function(t){var e=t.frag;if("main"===e.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this._bwEstimator){var r=this.hls,n=t.frag.level,i=r.levels[n].details.live,o=r.config,s=void 0,a=void 0;i?(s=o.abrEwmaFastLive,a=o.abrEwmaSlowLive):(s=o.abrEwmaFastVoD,a=o.abrEwmaSlowVoD),this._bwEstimator=new Se(r,a,s,o.abrEwmaDefaultEstimate)}this.fragCurrent=e}},e.prototype._abandonRulesCheck=function(){var t=this.hls,e=t.media,r=this.fragCurrent,n=r.loader,i=t.minAutoLevel;if(!n||n.stats&&n.stats.aborted)return Lt.b.warn("frag loader destroy or aborted, disarm abandonRules"),void this.clearTimer();var o=n.stats;if(e&&o&&(!e.paused&&0!==e.playbackRate||!e.readyState)&&r.autoLevel&&r.level){var s=performance.now()-o.trequest,a=Math.abs(e.playbackRate);if(s>500*r.duration/a){var u=t.levels,c=Math.max(1,o.bw?o.bw/8:1e3*o.loaded/s),l=u[r.level],f=l.realBitrate?Math.max(l.realBitrate,l.bitrate):l.bitrate,d=o.total?o.total:Math.max(o.loaded,Math.round(r.duration*f/8)),h=e.currentTime,p=(d-o.loaded)/c,v=(te.bufferInfo(e,h,t.config.maxBufferHole).end-h)/a;if(v<2*r.duration/a&&p>v){var g=void 0,y=void 0;for(y=r.level-1;y>i;y--){var m=u[y].realBitrate?Math.max(u[y].realBitrate,u[y].bitrate):u[y].bitrate;if((g=r.duration*m/(6.4*c))<v)break}g<p&&(Lt.b.warn("loading too slow, abort fragment loading and switch to level "+y+":fragLoadedDelay["+y+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+g.toFixed(1)+"<"+p.toFixed(1)+":"+v.toFixed(1)),t.nextLoadLevel=y,this._bwEstimator.sample(s,o.loaded),n.abort(),this.clearTimer(),t.trigger(Dt.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:o}))}}}},e.prototype.onFragLoaded=function(t){var e=t.frag;if("main"===e.type&&!isNaN(e.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=e.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var r=this.hls.levels[e.level],n=(r.loaded?r.loaded.bytes:0)+t.stats.loaded,i=(r.loaded?r.loaded.duration:0)+t.frag.duration;r.loaded={bytes:n,duration:i},r.realBitrate=Math.round(8*n/i)}if(t.frag.bitrateTest){var o=t.stats;o.tparsed=o.tbuffered=o.tload,this.onFragBuffered(t)}}},e.prototype.onFragBuffered=function(t){var e=t.stats,r=t.frag;if(!(!0===e.aborted||1!==r.loadCounter||"main"!==r.type||isNaN(r.sn)||r.bitrateTest&&e.tload!==e.tbuffered)){var n=e.tparsed-e.trequest;Lt.b.log("latency/loading/parsing/append/kbps:"+Math.round(e.tfirst-e.trequest)+"/"+Math.round(e.tload-e.tfirst)+"/"+Math.round(e.tparsed-e.tload)+"/"+Math.round(e.tbuffered-e.tparsed)+"/"+Math.round(8*e.loaded/(e.tbuffered-e.trequest))),this._bwEstimator.sample(n,e.loaded),e.bwEstimate=this._bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=n/1e3:this.bitrateTestDelay=0}},e.prototype.onError=function(t){switch(t.details){case Ot.a.FRAG_LOAD_ERROR:case Ot.a.FRAG_LOAD_TIMEOUT:this.clearTimer()}},e.prototype.clearTimer=function(){clearInterval(this.timer),this.timer=null},e.prototype._findBestLevel=function(t,e,r,n,i,o,s,a,u){for(var c=i;c>=n;c--){var l=u[c],f=l.details,d=f?f.totalduration/f.fragments.length:e,h=!!f&&f.live,p=void 0;p=c<=t?s*r:a*r;var v=u[c].realBitrate?Math.max(u[c].realBitrate,u[c].bitrate):u[c].bitrate,g=v*d/p;if(Lt.b.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+c+"/"+Math.round(p)+"/"+v+"/"+d+"/"+o+"/"+g),p>v&&(!g||h&&!this.bitrateTestDelay||g<o))return c}return-1},we(e,[{key:"nextAutoLevel",get:function(){var t=this._nextAutoLevel,e=this._bwEstimator;if(!(-1===t||e&&e.canEstimate()))return t;var r=this._nextABRAutoLevel;return-1!==t&&(r=Math.min(t,r)),r},set:function(t){this._nextAutoLevel=t}},{key:"_nextABRAutoLevel",get:function(){var t=this.hls,e=t.maxAutoLevel,r=t.levels,n=t.config,i=t.minAutoLevel,o=t.media,s=this.lastLoadedFragLevel,a=this.fragCurrent?this.fragCurrent.duration:0,u=o?o.currentTime:0,c=o&&0!==o.playbackRate?Math.abs(o.playbackRate):1,l=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,f=(te.bufferInfo(o,u,n.maxBufferHole).end-u)/c,d=this._findBestLevel(s,a,l,i,e,f,n.abrBandWidthFactor,n.abrBandWidthUpFactor,r);if(d>=0)return d;Lt.b.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var h=a?Math.min(a,n.maxStarvationDelay):n.maxStarvationDelay,p=n.abrBandWidthFactor,v=n.abrBandWidthUpFactor;if(0===f){var g=this.bitrateTestDelay;if(g){h=(a?Math.min(a,n.maxLoadingDelay):n.maxLoadingDelay)-g,Lt.b.trace("bitrate test took "+Math.round(1e3*g)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*h)+" ms"),p=v=1}}return d=this._findBestLevel(s,a,l,i,e,f+h,p,v,r),Math.max(d,0)}}]),e}(Pt),Re=Ae,De=function(t){function e(r){j(this,e);var n=G(this,t.call(this,r,Dt.a.MEDIA_ATTACHING,Dt.a.MEDIA_DETACHING,Dt.a.MANIFEST_PARSED,Dt.a.BUFFER_RESET,Dt.a.BUFFER_APPENDING,Dt.a.BUFFER_CODECS,Dt.a.BUFFER_EOS,Dt.a.BUFFER_FLUSHING,Dt.a.LEVEL_PTS_UPDATED,Dt.a.LEVEL_UPDATED));return n._msDuration=null,n._levelDuration=null,n.onsbue=n.onSBUpdateEnd.bind(n),n.onsbe=n.onSBUpdateError.bind(n),n.pendingTracks={},n.tracks={},n}return H(e,t),e.prototype.destroy=function(){Pt.prototype.destroy.call(this)},e.prototype.onLevelPtsUpdated=function(t){var e=t.type,r=this.tracks.audio;if("audio"===e&&r&&"audio/mpeg"===r.container){var n=this.sourceBuffer.audio;if(Math.abs(n.timestampOffset-t.start)>.1){var i=n.updating;try{n.abort()}catch(t){i=!0,Lt.b.warn("can not abort audio buffer: "+t)}i?this.audioTimestampOffset=t.start:(Lt.b.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+t.start),n.timestampOffset=t.start)}}},e.prototype.onManifestParsed=function(t){var e=t.audio,r=t.video||t.levels.length&&t.audio,n=0;t.altAudio&&(e||r)&&(n=(e?1:0)+(r?1:0),Lt.b.log(n+" sourceBuffer(s) expected")),this.sourceBufferNb=n},e.prototype.onMediaAttaching=function(t){var e=this.media=t.media;if(e){var r=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),r.addEventListener("sourceopen",this.onmso),r.addEventListener("sourceended",this.onmse),r.addEventListener("sourceclose",this.onmsc),e.src=URL.createObjectURL(r)}},e.prototype.onMediaDetaching=function(){Lt.b.log("media source detaching");var t=this.mediaSource;if(t){if("open"===t.readyState)try{t.endOfStream()}catch(t){Lt.b.warn("onMediaDetaching:"+t.message+" while calling endOfStream")}t.removeEventListener("sourceopen",this.onmso),t.removeEventListener("sourceended",this.onmse),t.removeEventListener("sourceclose",this.onmsc),this.media&&(URL.revokeObjectURL(this.media.src),this.media.removeAttribute("src"),this.media.load()),this.mediaSource=null,this.media=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(Dt.a.MEDIA_DETACHED)},e.prototype.onMediaSourceOpen=function(){Lt.b.log("media source opened"),this.hls.trigger(Dt.a.MEDIA_ATTACHED,{media:this.media});var t=this.mediaSource;t&&t.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()},e.prototype.checkPendingTracks=function(){var t=this.pendingTracks,e=Object.keys(t).length;e&&(this.sourceBufferNb<=e||0===this.sourceBufferNb)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},e.prototype.onMediaSourceClose=function(){Lt.b.log("media source closed")},e.prototype.onMediaSourceEnded=function(){Lt.b.log("media source ended")},e.prototype.onSBUpdateEnd=function(){if(this.audioTimestampOffset){var t=this.sourceBuffer.audio;Lt.b.warn("change mpeg audio timestamp offset from "+t.timestampOffset+" to "+this.audioTimestampOffset),t.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var e=this.parent,r=this.segments.reduce(function(t,r){return r.parent===e?t+1:t},0);this.hls.trigger(Dt.a.BUFFER_APPENDED,{parent:e,pending:r}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()},e.prototype.onSBUpdateError=function(t){Lt.b.error("sourceBuffer error:",t),this.hls.trigger(Dt.a.ERROR,{type:Ot.b.MEDIA_ERROR,details:Ot.a.BUFFER_APPENDING_ERROR,fatal:!1})},e.prototype.onBufferReset=function(){var t=this.sourceBuffer;for(var e in t){var r=t[e];try{this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this.onsbue),r.removeEventListener("error",this.onsbe)}catch(t){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},e.prototype.onBufferCodecs=function(t){if(0===Object.keys(this.sourceBuffer).length){for(var e in t)this.pendingTracks[e]=t[e];var r=this.mediaSource;r&&"open"===r.readyState&&this.checkPendingTracks()}},e.prototype.createSourceBuffers=function(t){var e=this.sourceBuffer,r=this.mediaSource;for(var n in t)if(!e[n]){var i=t[n],o=i.levelCodec||i.codec,s=i.container+";codecs="+o;Lt.b.log("creating sourceBuffer("+s+")");try{var a=e[n]=r.addSourceBuffer(s);a.addEventListener("updateend",this.onsbue),a.addEventListener("error",this.onsbe),this.tracks[n]={codec:o,container:i.container},i.buffer=a}catch(t){Lt.b.error("error while trying to add sourceBuffer:"+t.message),this.hls.trigger(Dt.a.ERROR,{type:Ot.b.MEDIA_ERROR,details:Ot.a.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:t,mimeType:s})}}this.hls.trigger(Dt.a.BUFFER_CREATED,{tracks:t})},e.prototype.onBufferAppending=function(t){this._needsFlush||(this.segments?this.segments.push(t):this.segments=[t],this.doAppending())},e.prototype.onBufferAppendFail=function(t){Lt.b.error("sourceBuffer error:",t.event),this.hls.trigger(Dt.a.ERROR,{type:Ot.b.MEDIA_ERROR,details:Ot.a.BUFFER_APPENDING_ERROR,fatal:!1})},e.prototype.onBufferEos=function(t){var e=this.sourceBuffer,r=t.type;for(var n in e)r&&n!==r||e[n].ended||(e[n].ended=!0,Lt.b.log(n+" sourceBuffer now EOS"));this.checkEos()},e.prototype.checkEos=function(){var t=this.sourceBuffer,e=this.mediaSource;if(!e||"open"!==e.readyState)return void(this._needsEos=!1);for(var r in t){var n=t[r];if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}Lt.b.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{e.endOfStream()}catch(t){Lt.b.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1},e.prototype.onBufferFlushing=function(t){this.flushRange.push({start:t.startOffset,end:t.endOffset,type:t.type}),this.flushBufferCounter=0,this.doFlush()},e.prototype.onLevelUpdated=function(t){var e=t.details;0!==e.fragments.length&&(this._levelDuration=e.totalduration+e.fragments[0].start,this.updateMediaElementDuration())},e.prototype.updateMediaElementDuration=function(){var t=this.media,e=this.mediaSource,r=this.sourceBuffer,n=this._levelDuration;if(null!==n&&t&&e&&r&&0!==t.readyState&&"open"===e.readyState){for(var i in r)if(r[i].updating)return;null===this._msDuration&&(this._msDuration=e.duration);var o=t.duration;(n>this._msDuration&&n>o||o===1/0||isNaN(o))&&(Lt.b.log("Updating mediasource duration to "+n.toFixed(3)),this._msDuration=e.duration=n)}},e.prototype.doFlush=function(){for(;this.flushRange.length;){var t=this.flushRange[0];if(!this.flushBuffer(t.start,t.end,t.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var e=0,r=this.sourceBuffer;try{for(var n in r)e+=r[n].buffered.length}catch(t){Lt.b.error("error while accessing sourceBuffer.buffered")}this.appended=e,this.hls.trigger(Dt.a.BUFFER_FLUSHED)}},e.prototype.doAppending=function(){var t=this.hls,e=this.sourceBuffer,r=this.segments;if(Object.keys(e).length){if(this.media.error)return this.segments=[],void Lt.b.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(r&&r.length){var n=r.shift();try{var i=n.type,o=e[i];o?o.updating?r.unshift(n):(o.ended=!1,this.parent=n.parent,o.appendBuffer(n.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(e){Lt.b.error("error while trying to append buffer:"+e.message),r.unshift(n);var s={type:Ot.b.MEDIA_ERROR,parent:n.parent};if(22===e.code)return this.segments=[],s.details=Ot.a.BUFFER_FULL_ERROR,s.fatal=!1,void t.trigger(Dt.a.ERROR,s);if(this.appendError?this.appendError++:this.appendError=1,s.details=Ot.a.BUFFER_APPEND_ERROR,this.appendError>t.config.appendErrorMaxRetry)return Lt.b.log("fail "+t.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),r=[],s.fatal=!0,void t.trigger(Dt.a.ERROR,s);s.fatal=!1,t.trigger(Dt.a.ERROR,s)}}}},e.prototype.flushBuffer=function(t,e,r){var n,i,o,s,a,u,c=this.sourceBuffer;if(Object.keys(c).length){if(Lt.b.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+t+"/"+e),this.flushBufferCounter<this.appended){for(var l in c)if(!r||l===r){if(n=c[l],n.ended=!1,n.updating)return Lt.b.warn("cannot flush, sb updating in progress"),!1;try{for(i=0;i<n.buffered.length;i++)if(o=n.buffered.start(i),s=n.buffered.end(i),-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&e===Number.POSITIVE_INFINITY?(a=t,u=e):(a=Math.max(o,t),u=Math.min(s,e)),Math.min(u,s)-a>.5)return this.flushBufferCounter++,Lt.b.log("flush "+l+" ["+a+","+u+"], of ["+o+","+s+"], pos:"+this.media.currentTime),n.remove(a,u),!1}catch(t){Lt.b.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else Lt.b.warn("abort flushing too many retries");Lt.b.log("buffer flushed")}return!0},e}(Pt),Oe=De,Le=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),Ce=function(t){function e(r){return V(this,e),q(this,t.call(this,r,Dt.a.FPS_DROP_LEVEL_CAPPING,Dt.a.MEDIA_ATTACHING,Dt.a.MANIFEST_PARSED))}return W(e,t),e.prototype.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))},e.prototype.onFpsDropLevelCapping=function(t){e.isLevelAllowed(t.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(t.droppedLevel)},e.prototype.onMediaAttaching=function(t){this.media=t.media instanceof HTMLVideoElement?t.media:null},e.prototype.onManifestParsed=function(t){var e=this.hls;this.restrictedLevels=[],e.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=t.levels,e.firstLevel=this.getMaxLevel(t.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},e.prototype.detectPlayerSize=function(){if(this.media){var t=this.levels?this.levels.length:0;if(t){var e=this.hls;e.autoLevelCapping=this.getMaxLevel(t-1),e.autoLevelCapping>this.autoLevelCapping&&e.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}},e.prototype.getMaxLevel=function(t){var r=this;if(!this.levels)return-1;var n=this.levels.filter(function(n,i){return e.isLevelAllowed(i,r.restrictedLevels)&&i<=t});return e.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)},e.isLevelAllowed=function(t){return-1===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).indexOf(t)},e.getMaxLevelByMediaSize=function(t,e,r){if(!t||t&&!t.length)return-1;for(var n=function(t,e){return!e||(t.width!==e.width||t.height!==e.height)},i=t.length-1,o=0;o<t.length;o+=1){var s=t[o];if((s.width>=e||s.height>=r)&&n(s,t[o+1])){i=o;break}}return i},Le(e,[{key:"mediaWidth",get:function(){var t=void 0,r=this.media;return r&&(t=r.width||r.clientWidth||r.offsetWidth,t*=e.contentScaleFactor),t}},{key:"mediaHeight",get:function(){var t=void 0,r=this.media;return r&&(t=r.height||r.clientHeight||r.offsetHeight,t*=e.contentScaleFactor),t}}],[{key:"contentScaleFactor",get:function(){var t=1;try{t=window.devicePixelRatio}catch(t){}return t}}]),e}(Pt),Ie=Ce,Pe=function(t){function e(r){return Y(this,e),K(this,t.call(this,r,Dt.a.MEDIA_ATTACHING))}return z(e,t),e.prototype.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},e.prototype.onMediaAttaching=function(t){var e=this.hls.config;if(e.capLevelOnFPSDrop){"function"==typeof(this.video=t.media instanceof HTMLVideoElement?t.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),e.fpsDroppedMonitoringPeriod)}},e.prototype.checkFPS=function(t,e,r){var n=performance.now();if(e){if(this.lastTime){var i=n-this.lastTime,o=r-this.lastDroppedFrames,s=e-this.lastDecodedFrames,a=1e3*o/i,u=this.hls;if(u.trigger(Dt.a.FPS_DROP,{currentDropped:o,currentDecoded:s,totalDroppedFrames:r}),a>0&&o>u.config.fpsDroppedMonitoringThreshold*s){var c=u.currentLevel;Lt.b.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(-1===u.autoLevelCapping||u.autoLevelCapping>=c)&&(c-=1,u.trigger(Dt.a.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:u.currentLevel}),u.autoLevelCapping=c,u.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=e}},e.prototype.checkFPSInterval=function(){var t=this.video;if(t)if(this.isVideoPlaybackQualityAvailable){var e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)},e}(Pt),Me=Pe,Ne=function(){function t(e){X(this,t),e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}return t.prototype.destroy=function(){this.abort(),this.loader=null},t.prototype.abort=function(){var t=this.loader;t&&4!==t.readyState&&(this.stats.aborted=!0,t.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},t.prototype.load=function(t,e,r){this.context=t,this.config=e,this.callbacks=r,this.stats={trequest:performance.now(),retry:0},this.retryDelay=e.retryDelay,this.loadInternal()},t.prototype.loadInternal=function(){var t,e=this.context;t="undefined"!=typeof XDomainRequest?this.loader=new XDomainRequest:this.loader=new XMLHttpRequest;var r=this.stats;r.tfirst=0,r.loaded=0;var n=this.xhrSetup;try{if(n)try{n(t,e.url)}catch(r){t.open("GET",e.url,!0),n(t,e.url)}t.readyState||t.open("GET",e.url,!0)}catch(r){return void this.callbacks.onError({code:t.status,text:r.message},e,t)}e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),t.send()},t.prototype.readystatechange=function(t){var e=t.currentTarget,r=e.readyState,n=this.stats,i=this.context,o=this.config;if(!n.aborted&&r>=2)if(window.clearTimeout(this.requestTimeout),0===n.tfirst&&(n.tfirst=Math.max(performance.now(),n.trequest)),4===r){var s=e.status;if(s>=200&&s<300){n.tload=Math.max(n.tfirst,performance.now());var a=void 0,u=void 0;"arraybuffer"===i.responseType?(a=e.response,u=a.byteLength):(a=e.responseText,u=a.length),n.loaded=n.total=u;var c={url:e.responseURL,data:a};this.callbacks.onSuccess(c,n,i,e)}else n.retry>=o.maxRetry||s>=400&&s<499?(Lt.b.error(s+" while loading "+i.url),this.callbacks.onError({code:s,text:e.statusText},i,e)):(Lt.b.warn(s+" while loading "+i.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,o.maxRetryDelay),n.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),o.timeout)},t.prototype.loadtimeout=function(){Lt.b.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},t.prototype.loadprogress=function(t){var e=t.currentTarget,r=this.stats;r.loaded=t.loaded,t.lengthComputable&&(r.total=t.total);var n=this.callbacks.onProgress;n&&n(r,this.context,null,e)},t}(),ke=Ne,xe=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),Fe=function(t){function e(r){Q(this,e);var n=$(this,t.call(this,r,Dt.a.MANIFEST_LOADING,Dt.a.MANIFEST_LOADED,Dt.a.AUDIO_TRACK_LOADED,Dt.a.ERROR));return n.ticks=0,n.ontick=n.tick.bind(n),n}return Z(e,t),e.prototype.destroy=function(){this.cleanTimer(),Pt.prototype.destroy.call(this)},e.prototype.cleanTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},e.prototype.tick=function(){1===++this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)},e.prototype.doTick=function(){this.updateTrack(this.trackId)},e.prototype.onError=function(t){t.fatal&&t.type===Ot.b.NETWORK_ERROR&&this.cleanTimer()},e.prototype.onManifestLoading=function(){this.tracks=[],this.trackId=-1},e.prototype.onManifestLoaded=function(t){var e=this,r=t.audioTracks||[],n=!1;this.tracks=r,this.hls.trigger(Dt.a.AUDIO_TRACKS_UPDATED,{audioTracks:r});var i=0;r.forEach(function(t){if(t.default&&!n)return e.audioTrack=i,void(n=!0);i++}),!1===n&&r.length&&(Lt.b.log("no default audio track defined, use first audio track as default"),this.audioTrack=0)},e.prototype.onAudioTrackLoaded=function(t){t.id<this.tracks.length&&(Lt.b.log("audioTrack "+t.id+" loaded"),this.tracks[t.id].details=t.details,t.details.live&&!this.timer&&(this.timer=setInterval(this.ontick,1e3*t.details.targetduration)),!t.details.live&&this.timer&&this.cleanTimer())},e.prototype.setAudioTrackInternal=function(t){if(t>=0&&t<this.tracks.length){this.cleanTimer(),this.trackId=t,Lt.b.log("switching to audioTrack "+t);var e=this.tracks[t],r=this.hls,n=e.type,i=e.url,o={id:t,type:n,url:i};r.trigger(Dt.a.AUDIO_TRACK_SWITCH,o),r.trigger(Dt.a.AUDIO_TRACK_SWITCHING,o);var s=e.details;!i||void 0!==s&&!0!==s.live||(Lt.b.log("(re)loading playlist for audioTrack "+t),r.trigger(Dt.a.AUDIO_TRACK_LOADING,{url:i,id:t}))}},e.prototype.updateTrack=function(t){if(t>=0&&t<this.tracks.length){this.cleanTimer(),this.trackId=t,Lt.b.log("updating audioTrack "+t);var e=this.tracks[t],r=e.url,n=e.details;!r||void 0!==n&&!0!==n.live||(Lt.b.log("(re)loading playlist for audioTrack "+t),this.hls.trigger(Dt.a.AUDIO_TRACK_LOADING,{url:r,id:t}))}},xe(e,[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this.trackId},set:function(t){this.trackId===t&&void 0!==this.tracks[t].details||this.setAudioTrackInternal(t)}}]),e}(Pt),Ue=Fe,Be=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),je={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS"},Ge=function(t){function e(r){J(this,e);var n=tt(this,t.call(this,r,Dt.a.MEDIA_ATTACHED,Dt.a.MEDIA_DETACHING,Dt.a.AUDIO_TRACKS_UPDATED,Dt.a.AUDIO_TRACK_SWITCHING,Dt.a.AUDIO_TRACK_LOADED,Dt.a.KEY_LOADED,Dt.a.FRAG_LOADED,Dt.a.FRAG_PARSING_INIT_SEGMENT,Dt.a.FRAG_PARSING_DATA,Dt.a.FRAG_PARSED,Dt.a.ERROR,Dt.a.BUFFER_CREATED,Dt.a.BUFFER_APPENDED,Dt.a.BUFFER_FLUSHED,Dt.a.INIT_PTS_FOUND));return n.config=r.config,n.audioCodecSwap=!1,n.ticks=0,n._state=je.STOPPED,n.ontick=n.tick.bind(n),n.initPTS=[],n.waitingFragment=null,n.videoTrackCC=null,n}return et(e,t),e.prototype.destroy=function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),Pt.prototype.destroy.call(this),this.state=je.STOPPED},e.prototype.onInitPtsFound=function(t){var e=t.id,r=t.frag.cc,n=t.initPTS;"main"===e&&(this.initPTS[r]=n,this.videoTrackCC=r,Lt.b.log("InitPTS for cc:"+r+" found from video track:"+n),this.state===je.WAITING_INIT_PTS&&this.tick())},e.prototype.startLoad=function(t){if(this.tracks){var e=this.lastCurrentTime;this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.fragLoadError=0,e>0&&-1===t?(Lt.b.log("audio:override startPosition with lastCurrentTime @"+e.toFixed(3)),this.state=je.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:t,this.state=je.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=t,this.state=je.STOPPED},e.prototype.stopLoad=function(){var t=this.fragCurrent;t&&(t.loader&&t.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=je.STOPPED},e.prototype.tick=function(){1===++this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)},e.prototype.doTick=function(){var t,e,r,n=this.hls,i=n.config;switch(this.state){case je.ERROR:case je.PAUSED:case je.BUFFER_FLUSHING:break;case je.STARTING:this.state=je.WAITING_TRACK,this.loadedmetadata=!1;break;case je.IDLE:var o=this.tracks;if(!o)break;if(!this.media&&(this.startFragRequested||!i.startFragPrefetch))break;if(this.loadedmetadata)t=this.media.currentTime;else if(void 0===(t=this.nextLoadPosition))break;var s=this.mediaBuffer?this.mediaBuffer:this.media,a=te.bufferInfo(s,t,i.maxBufferHole),u=a.len,c=a.end,l=this.fragPrevious,f=i.maxMaxBufferLength,d=this.audioSwitch,h=this.trackId;if((u<f||d)&&h<o.length){if(void 0===(r=o[h].details)){this.state=je.WAITING_TRACK;break}if(!d&&!r.live&&l&&l.sn===r.endSN&&(!this.media.seeking||this.media.duration-c<l.duration/2)){this.hls.trigger(Dt.a.BUFFER_EOS,{type:"audio"}),this.state=je.ENDED;break}var p=r.fragments,v=p.length,g=p[0].start,y=p[v-1].start+p[v-1].duration,m=void 0;if(d)if(r.live&&!r.PTSKnown)Lt.b.log("switching audiotrack, live stream, unknown PTS,load first fragment"),c=0;else if(c=t,r.PTSKnown&&t<g){if(!(a.end>g||a.nextStart))return;Lt.b.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=g+.05}if(r.initSegment&&!r.initSegment.data)m=r.initSegment;else if(c<=g){if(m=p[0],null!==this.videoTrackCC&&m.cc!==this.videoTrackCC&&(m=b(p,this.videoTrackCC)),r.live&&m.loadIdx&&m.loadIdx===this.fragLoadIdx){var E=a.nextStart?a.nextStart:g;return Lt.b.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(E+.05)),void(this.media.currentTime=E+.05)}}else{var _=void 0,T=i.maxFragLookUpTolerance,S=l?p[l.sn-p[0].sn+1]:void 0,w=function(t){var e=Math.min(T,t.duration);return t.start+t.duration-e<=c?1:t.start-e>c&&t.start?-1:0};c<y?(c>y-T&&(T=0),_=S&&!w(S)?S:Zt.search(p,w)):_=p[v-1],_&&(m=_,g=_.start,l&&m.level===l.level&&m.sn===l.sn&&(m.sn<r.endSN?(m=p[m.sn+1-r.startSN],Lt.b.log("SN just loaded, load next one: "+m.sn)):m=null))}if(m)if(m.decryptdata&&null!=m.decryptdata.uri&&null==m.decryptdata.key)Lt.b.log("Loading key for "+m.sn+" of ["+r.startSN+" ,"+r.endSN+"],track "+h),this.state=je.KEY_LOADING,n.trigger(Dt.a.KEY_LOADING,{frag:m});else{if(Lt.b.log("Loading "+m.sn+", cc: "+m.cc+" of ["+r.startSN+" ,"+r.endSN+"],track "+h+", currentTime:"+t+",bufferEnd:"+c.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,m.loadCounter){m.loadCounter++;var A=i.fragLoadingLoopThreshold;if(m.loadCounter>A&&Math.abs(this.fragLoadIdx-m.loadIdx)<A)return void n.trigger(Dt.a.ERROR,{type:Ot.b.MEDIA_ERROR,details:Ot.a.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:m})}else m.loadCounter=1;m.loadIdx=this.fragLoadIdx,this.fragCurrent=m,this.startFragRequested=!0,isNaN(m.sn)||(this.nextLoadPosition=m.start+m.duration),n.trigger(Dt.a.FRAG_LOADING,{frag:m}),this.state=je.FRAG_LOADING}}break;case je.WAITING_TRACK:e=this.tracks[this.trackId],e&&e.details&&(this.state=je.IDLE);break;case je.FRAG_LOADING_WAITING_RETRY:var R=performance.now(),D=this.retryDate;s=this.media;var O=s&&s.seeking;(!D||R>=D||O)&&(Lt.b.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=je.IDLE);break;case je.WAITING_INIT_PTS:var L=this.videoTrackCC;if(void 0===this.initPTS[L])break;var C=this.waitingFragment;if(C){var I=C.frag.cc;L!==I?(e=this.tracks[this.trackId],e.details&&e.details.live&&(Lt.b.warn("Waiting fragment CC ("+I+") does not match video track CC ("+L+")"),this.waitingFragment=null,this.state=je.IDLE)):(this.state=je.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=je.IDLE;break;case je.STOPPED:case je.FRAG_LOADING:case je.PARSING:case je.PARSED:case je.ENDED:}},e.prototype.onMediaAttached=function(t){var e=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),e.addEventListener("seeking",this.onvseeking),e.addEventListener("ended",this.onvended);var r=this.config;this.tracks&&r.autoStartLoad&&this.startLoad(r.startPosition)},e.prototype.onMediaDetaching=function(){var t=this.media;t&&t.ended&&(Lt.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var e=this.tracks;e&&e.forEach(function(t){t.details&&t.details.fragments.forEach(function(t){t.loadCounter=void 0})}),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},e.prototype.onMediaSeeking=function(){this.state===je.ENDED&&(this.state=je.IDLE),this.media&&(this.lastCurrentTime=this.media.currentTime),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.tick()},e.prototype.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},e.prototype.onAudioTracksUpdated=function(t){Lt.b.log("audio tracks updated"),this.tracks=t.audioTracks},e.prototype.onAudioTrackSwitching=function(t){var e=!!t.url;this.trackId=t.id,this.fragCurrent=null,this.state=je.PAUSED,this.waitingFragment=null,e?this.timer||(this.timer=setInterval(this.ontick,100)):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),e&&(this.audioSwitch=!0,this.state=je.IDLE,void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold)),this.tick()},e.prototype.onAudioTrackLoaded=function(t){var e=t.details,r=t.id,n=this.tracks[r],i=e.totalduration,o=0;if(Lt.b.log("track "+r+" loaded ["+e.startSN+","+e.endSN+"],duration:"+i),e.live){var s=n.details;s&&e.fragments.length>0?(E(s,e),o=e.fragments[0].start,e.PTSKnown?Lt.b.log("live audio playlist sliding:"+o.toFixed(3)):Lt.b.log("live audio playlist - outdated PTS, unknown sliding")):(e.PTSKnown=!1,Lt.b.log("live audio playlist - first load, unknown sliding"))}else e.PTSKnown=!1;if(n.details=e,!this.startFragRequested){if(-1===this.startPosition){var a=e.startTimeOffset;isNaN(a)?this.startPosition=0:(Lt.b.log("start time offset found in playlist, adjust startPosition to "+a),this.startPosition=a)}this.nextLoadPosition=this.startPosition}this.state===je.WAITING_TRACK&&(this.state=je.IDLE),this.tick()},e.prototype.onKeyLoaded=function(){this.state===je.KEY_LOADING&&(this.state=je.IDLE,this.tick())},e.prototype.onFragLoaded=function(t){var e=this.fragCurrent,r=t.frag;if(this.state===je.FRAG_LOADING&&e&&"audio"===r.type&&r.level===e.level&&r.sn===e.sn){var n=this.tracks[this.trackId],i=n.details,o=i.totalduration,s=e.level,a=e.sn,u=e.cc,c=this.config.defaultAudioCodec||n.audioCodec||"mp4a.40.2",l=this.stats=t.stats;if("initSegment"===a)this.state=je.IDLE,l.tparsed=l.tbuffered=performance.now(),i.initSegment.data=t.payload,this.hls.trigger(Dt.a.FRAG_BUFFERED,{stats:l,frag:e,id:"audio"}),this.tick();else{this.state=je.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new ae(this.hls,"audio"));var f=this.initPTS[u],d=i.initSegment?i.initSegment.data:[];if(i.initSegment||void 0!==f){this.pendingBuffering=!0,Lt.b.log("Demuxing "+a+" of ["+i.startSN+" ,"+i.endSN+"],track "+s);this.demuxer.push(t.payload,d,c,null,e,o,!1,f)}else Lt.b.log("unknown video PTS for continuity counter "+u+", waiting for video PTS before demuxing audio frag "+a+" of ["+i.startSN+" ,"+i.endSN+"],track "+s),this.waitingFragment=t,this.state=je.WAITING_INIT_PTS}}this.fragLoadError=0},e.prototype.onFragParsingInitSegment=function(t){var e=this.fragCurrent,r=t.frag;if(e&&"audio"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===je.PARSING){var n=t.tracks,i=void 0;if(n.video&&delete n.video,i=n.audio){i.levelCodec=i.codec,i.id=t.id,this.hls.trigger(Dt.a.BUFFER_CODECS,n),Lt.b.log("audio track:audio,container:"+i.container+",codecs[level/parsed]=["+i.levelCodec+"/"+i.codec+"]");var o=i.initSegment;if(o){var s={type:"audio",data:o,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[s]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(Dt.a.BUFFER_APPENDING,s))}this.tick()}}},e.prototype.onFragParsingData=function(t){var e=this,r=this.fragCurrent,n=t.frag;if(r&&"audio"===t.id&&"audio"===t.type&&n.sn===r.sn&&n.level===r.level&&this.state===je.PARSING){var i=this.trackId,o=this.tracks[i],s=this.hls;isNaN(t.endPTS)&&(t.endPTS=t.startPTS+r.duration,t.endDTS=t.startDTS+r.duration),Lt.b.log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb),m(o.details,r,t.startPTS,t.endPTS);var a=this.audioSwitch,u=this.media,c=!1;if(a&&u)if(u.readyState){var l=u.currentTime;Lt.b.log("switching audio track : currentTime:"+l),l>=t.startPTS&&(Lt.b.log("switching audio track : flushing all audio"),this.state=je.BUFFER_FLUSHING,s.trigger(Dt.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),c=!0,this.audioSwitch=!1,s.trigger(Dt.a.AUDIO_TRACK_SWITCHED,{id:i}))}else this.audioSwitch=!1,s.trigger(Dt.a.AUDIO_TRACK_SWITCHED,{id:i});var f=this.pendingData;this.audioSwitch||([t.data1,t.data2].forEach(function(e){e&&e.length&&f.push({type:t.type,data:e,parent:"audio",content:"data"})}),!c&&f.length&&(f.forEach(function(t){e.state===je.PARSING&&(e.pendingBuffering=!0,e.hls.trigger(Dt.a.BUFFER_APPENDING,t))}),this.pendingData=[],this.appended=!0)),this.tick()}},e.prototype.onFragParsed=function(t){var e=this.fragCurrent,r=t.frag;e&&"audio"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===je.PARSING&&(this.stats.tparsed=performance.now(),this.state=je.PARSED,this._checkAppendedParsed())},e.prototype.onBufferCreated=function(t){var e=t.tracks.audio;e&&(this.mediaBuffer=e.buffer,this.loadedmetadata=!0)},e.prototype.onBufferAppended=function(t){if("audio"===t.parent){var e=this.state;e!==je.PARSING&&e!==je.PARSED||(this.pendingBuffering=t.pending>0,this._checkAppendedParsed())}},e.prototype._checkAppendedParsed=function(){if(!(this.state!==je.PARSED||this.appended&&this.pendingBuffering)){var t=this.fragCurrent,e=this.stats,r=this.hls;if(t){this.fragPrevious=t,e.tbuffered=performance.now(),r.trigger(Dt.a.FRAG_BUFFERED,{stats:e,frag:t,id:"audio"});var n=this.mediaBuffer?this.mediaBuffer:this.media;Lt.b.log("audio buffered : "+ce.toString(n.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,r.trigger(Dt.a.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=je.IDLE}this.tick()}},e.prototype.onError=function(t){var e=t.frag;if(!e||"audio"===e.type)switch(t.details){case Ot.a.FRAG_LOAD_ERROR:case Ot.a.FRAG_LOAD_TIMEOUT:if(!t.fatal){var r=this.fragLoadError;r?r++:r=1;var n=this.config;if(r<=n.fragLoadingMaxRetry){this.fragLoadError=r,e.loadCounter=0;var i=Math.min(Math.pow(2,r-1)*n.fragLoadingRetryDelay,n.fragLoadingMaxRetryTimeout);Lt.b.warn("audioStreamController: frag loading failed, retry in "+i+" ms"),this.retryDate=performance.now()+i,this.state=je.FRAG_LOADING_WAITING_RETRY}else Lt.b.error("audioStreamController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=je.ERROR}break;case Ot.a.FRAG_LOOP_LOADING_ERROR:case Ot.a.AUDIO_TRACK_LOAD_ERROR:case Ot.a.AUDIO_TRACK_LOAD_TIMEOUT:case Ot.a.KEY_LOAD_ERROR:case Ot.a.KEY_LOAD_TIMEOUT:this.state!==je.ERROR&&(this.state=t.fatal?je.ERROR:je.IDLE,Lt.b.warn("audioStreamController: "+t.details+" while loading frag,switch to "+this.state+" state ..."));break;case Ot.a.BUFFER_FULL_ERROR:if("audio"===t.parent&&(this.state===je.PARSING||this.state===je.PARSED)){var o=this.mediaBuffer,s=this.media.currentTime;if(o&&te.isBuffered(o,s)&&te.isBuffered(o,s+.5)){var a=this.config;a.maxMaxBufferLength>=a.maxBufferLength&&(a.maxMaxBufferLength/=2,Lt.b.warn("audio:reduce max buffer length to "+a.maxMaxBufferLength+"s"),this.fragLoadIdx+=2*a.fragLoadingLoopThreshold),this.state=je.IDLE}else Lt.b.warn("buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=je.BUFFER_FLUSHING,this.hls.trigger(Dt.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},e.prototype.onBufferFlushed=function(){var t=this,e=this.pendingData;e&&e.length?(Lt.b.log("appending pending audio data on Buffer Flushed"),e.forEach(function(e){t.hls.trigger(Dt.a.BUFFER_APPENDING,e)}),this.appended=!0,this.pendingData=[],this.state=je.PARSED):(this.state=je.IDLE,this.fragPrevious=null,this.tick())},Be(e,[{key:"state",set:function(t){if(this.state!==t){var e=this.state;this._state=t,Lt.b.log("audio stream:"+e+"->"+t)}},get:function(){return this._state}}]),e}(Pt),He=Ge,Ve=function(){function t(t){return"string"==typeof t&&(!!o[t.toLowerCase()]&&t.toLowerCase())}function e(t){return"string"==typeof t&&(!!s[t.toLowerCase()]&&t.toLowerCase())}function r(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}function n(n,o,s){var a=this,u=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),c={};u?a=document.createElement("custom"):c.enumerable=!0,a.hasBeenReset=!1;var l="",f=!1,d=n,h=o,p=s,v=null,g="",y=!0,m="auto",E="start",_=50,b="middle",T=50,S="middle";if(Object.defineProperty(a,"id",r({},c,{get:function(){return l},set:function(t){l=""+t}})),Object.defineProperty(a,"pauseOnExit",r({},c,{get:function(){return f},set:function(t){f=!!t}})),Object.defineProperty(a,"startTime",r({},c,{get:function(){return d},set:function(t){if("number"!=typeof t)throw new TypeError("Start time must be set to a number.");d=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"endTime",r({},c,{get:function(){return h},set:function(t){if("number"!=typeof t)throw new TypeError("End time must be set to a number.");h=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"text",r({},c,{get:function(){return p},set:function(t){p=""+t,this.hasBeenReset=!0}})),Object.defineProperty(a,"region",r({},c,{get:function(){return v},set:function(t){v=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"vertical",r({},c,{get:function(){return g},set:function(e){var r=t(e);if(!1===r)throw new SyntaxError("An invalid or illegal string was specified.");g=r,this.hasBeenReset=!0}})),Object.defineProperty(a,"snapToLines",r({},c,{get:function(){return y},set:function(t){y=!!t,this.hasBeenReset=!0}})),Object.defineProperty(a,"line",r({},c,{get:function(){return m},set:function(t){if("number"!=typeof t&&t!==i)throw new SyntaxError("An invalid number or illegal string was specified.");m=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"lineAlign",r({},c,{get:function(){return E},set:function(t){var r=e(t);if(!r)throw new SyntaxError("An invalid or illegal string was specified.");E=r,this.hasBeenReset=!0}})),Object.defineProperty(a,"position",r({},c,{get:function(){return _},set:function(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");_=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"positionAlign",r({},c,{get:function(){return b},set:function(t){var r=e(t);if(!r)throw new SyntaxError("An invalid or illegal string was specified.");b=r,this.hasBeenReset=!0}})),Object.defineProperty(a,"size",r({},c,{get:function(){return T},set:function(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");T=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"align",r({},c,{get:function(){return S},set:function(t){var r=e(t);if(!r)throw new SyntaxError("An invalid or illegal string was specified.");S=r,this.hasBeenReset=!0}})),a.displayState=void 0,u)return a}if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var i="auto",o={"":!0,lr:!0,rl:!0},s={start:!0,middle:!0,end:!0,left:!0,right:!0};return n.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},n}(),qe=function(){return{decode:function(t){if(!t)return"";if("string"!=typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}};it.prototype={set:function(t,e){this.get(t)||""===e||(this.values[t]=e)},get:function(t,e,r){return r?this.has(t)?this.values[t]:e[r]:this.has(t)?this.values[t]:e},has:function(t){return t in this.values},alt:function(t,e,r){for(var n=0;n<r.length;++n)if(e===r[n]){this.set(t,e);break}},integer:function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},percent:function(t,e){return!!(e.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(e=parseFloat(e))>=0&&e<=100)&&(this.set(t,e),!0)}};var We=new Ve(0,0,0),Ye="middle"===We.align?"middle":"center";rt.prototype={parse:function(t){function e(){var t=n.buffer,e=0;for(t=at(t);e<t.length&&"\r"!==t[e]&&"\n"!==t[e];)++e;var r=t.substr(0,e);return"\r"===t[e]&&++e,"\n"===t[e]&&++e,n.buffer=t.substr(e),r}function r(t){ot(t,function(t,e){t},/:/)}var n=this;t&&(n.buffer+=n.decoder.decode(t,{stream:!0}));try{var i;if("INITIAL"===n.state){if(!/\r\n|\n/.test(n.buffer))return this;i=e();var o=i.match(/^(Ã¯Â»Â¿)?WEBVTT([ \t].*)?$/);if(!o||!o[0])throw new Error("Malformed WebVTT signature.");n.state="HEADER"}for(var s=!1;n.buffer;){if(!/\r\n|\n/.test(n.buffer))return this;switch(s?s=!1:i=e(),n.state){case"HEADER":/:/.test(i)?r(i):i||(n.state="ID");continue;case"NOTE":i||(n.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){n.state="NOTE";break}if(!i)continue;if(n.cue=new Ve(0,0,""),n.state="CUE",-1===i.indexOf("--\x3e")){n.cue.id=i;continue}case"CUE":try{st(i,n.cue,n.regionList)}catch(t){n.cue=null,n.state="BADCUE";continue}n.state="CUETEXT";continue;case"CUETEXT":var a=-1!==i.indexOf("--\x3e");if(!i||a&&(s=!0)){n.oncue&&n.oncue(n.cue),n.cue=null,n.state="ID";continue}n.cue.text&&(n.cue.text+="\n"),n.cue.text+=i;continue;case"BADCUE":i||(n.state="ID");continue}}}catch(t){"CUETEXT"===n.state&&n.cue&&n.oncue&&n.oncue(n.cue),n.cue=null,n.state="INITIAL"===n.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),(t.cue||"HEADER"===t.state)&&(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state)throw new Error("Malformed WebVTT signature.")}catch(t){throw t}return t.onflush&&t.onflush(),this}};var Ke=rt,ze={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Xe=function(t){var e=t;return ze.hasOwnProperty(t)&&(e=ze[t]),String.fromCharCode(e)},Qe=15,$e=100,Ze={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Je={17:2,18:4,21:6,22:8,23:10,19:13,20:15},tr={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},er={25:2,26:4,29:6,30:8,31:10,27:13,28:15},rr=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],nr={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(t){this.time=t},log:function(t,e){var r=this.verboseFilter[t];this.verboseLevel>=r&&this.time}},ir=function(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r].toString(16));return e},or=function(){function t(e,r,n,i,o){ct(this,t),this.foreground=e||"white",this.underline=r||!1,this.italics=n||!1,this.background=i||"black",this.flash=o||!1}return t.prototype.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},t.prototype.setStyles=function(t){for(var e=["foreground","underline","italics","background","flash"],r=0;r<e.length;r++){var n=e[r];t.hasOwnProperty(n)&&(this[n]=t[n])}},t.prototype.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.prototype.equals=function(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash},t.prototype.copy=function(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash},t.prototype.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},t}(),sr=function(){function t(e,r,n,i,o,s){ct(this,t),this.uchar=e||" ",this.penState=new or(r,n,i,o,s)}return t.prototype.reset=function(){this.uchar=" ",this.penState.reset()},t.prototype.setChar=function(t,e){this.uchar=t,this.penState.copy(e)},t.prototype.setPenState=function(t){this.penState.copy(t)},t.prototype.equals=function(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)},t.prototype.copy=function(t){this.uchar=t.uchar,this.penState.copy(t.penState)},t.prototype.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},t}(),ar=function(){function t(){ct(this,t),this.chars=[];for(var e=0;e<$e;e++)this.chars.push(new sr);this.pos=0,this.currPenState=new or}return t.prototype.equals=function(t){for(var e=!0,r=0;r<$e;r++)if(!this.chars[r].equals(t.chars[r])){e=!1;break}return e},t.prototype.copy=function(t){for(var e=0;e<$e;e++)this.chars[e].copy(t.chars[e])},t.prototype.isEmpty=function(){for(var t=!0,e=0;e<$e;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t},t.prototype.setCursor=function(t){this.pos!==t&&(this.pos=t),this.pos<0?(nr.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>$e&&(nr.log("ERROR","Too large cursor position "+this.pos),this.pos=$e)},t.prototype.moveCursor=function(t){var e=this.pos+t;if(t>1)for(var r=this.pos+1;r<e+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(e)},t.prototype.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.prototype.insertChar=function(t){t>=144&&this.backSpace();var e=Xe(t);if(this.pos>=$e)return void nr.log("ERROR","Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!");this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1)},t.prototype.clearFromPos=function(t){var e;for(e=t;e<$e;e++)this.chars[e].reset()},t.prototype.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.prototype.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.prototype.getTextString=function(){for(var t=[],e=!0,r=0;r<$e;r++){var n=this.chars[r].uchar;" "!==n&&(e=!1),t.push(n)}return e?"":t.join("")},t.prototype.setPenStyles=function(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)},t}(),ur=function(){function t(){ct(this,t),this.rows=[];for(var e=0;e<Qe;e++)this.rows.push(new ar);this.currRow=Qe-1,this.nrRollUpRows=null,this.reset()}return t.prototype.reset=function(){for(var t=0;t<Qe;t++)this.rows[t].clear();this.currRow=Qe-1},t.prototype.equals=function(t){for(var e=!0,r=0;r<Qe;r++)if(!this.rows[r].equals(t.rows[r])){e=!1;break}return e},t.prototype.copy=function(t){for(var e=0;e<Qe;e++)this.rows[e].copy(t.rows[e])},t.prototype.isEmpty=function(){for(var t=!0,e=0;e<Qe;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t},t.prototype.backSpace=function(){this.rows[this.currRow].backSpace()},t.prototype.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.prototype.insertChar=function(t){this.rows[this.currRow].insertChar(t)},t.prototype.setPen=function(t){this.rows[this.currRow].setPenStyles(t)},t.prototype.moveCursor=function(t){this.rows[this.currRow].moveCursor(t)},t.prototype.setCursor=function(t){nr.log("INFO","setCursor: "+t),this.rows[this.currRow].setCursor(t)},t.prototype.setPAC=function(t){nr.log("INFO","pacData = "+JSON.stringify(t));var e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(var r=0;r<Qe;r++)this.rows[r].clear();var n=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){var o=i.rows[n].cueStartTime;if(o&&o<nr.time)for(var s=0;s<this.nrRollUpRows;s++)this.rows[e-this.nrRollUpRows+s+1].copy(i.rows[n+s])}}this.currRow=e;var a=this.rows[this.currRow];if(null!==t.indent){var u=t.indent,c=Math.max(u-1,0);a.setCursor(t.indent),t.color=a.chars[c].penState.foreground}var l={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(l)},t.prototype.setBkgData=function(t){nr.log("INFO","bkgData = "+JSON.stringify(t)),this.backSpace(),this.setPen(t),this.insertChar(32)},t.prototype.setRollUpRows=function(t){this.nrRollUpRows=t},t.prototype.rollUp=function(){if(null===this.nrRollUpRows)return void nr.log("DEBUG","roll_up but nrRollUpRows not set yet");nr.log("TEXT",this.getDisplayText());var t=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(t,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),nr.log("INFO","Rolling up")},t.prototype.getDisplayText=function(t){t=t||!1;for(var e=[],r="",n=-1,i=0;i<Qe;i++){var o=this.rows[i].getTextString();o&&(n=i+1,t?e.push("Row "+n+": '"+o+"'"):e.push(o.trim()))}return e.length>0&&(r=t?"["+e.join(" | ")+"]":e.join("\n")),r},t.prototype.getTextAndFormat=function(){return this.rows},t}(),cr=function(){function t(e,r){ct(this,t),this.chNr=e,this.outputFilter=r,this.mode=null,this.verbose=0,this.displayedMemory=new ur,this.nonDisplayedMemory=new ur,this.lastOutputScreen=new ur,this.currRollUpRow=this.displayedMemory.rows[Qe-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return t.prototype.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[Qe-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},t.prototype.getHandler=function(){return this.outputFilter},t.prototype.setHandler=function(t){this.outputFilter=t},t.prototype.setPAC=function(t){this.writeScreen.setPAC(t)},t.prototype.setBkgData=function(t){this.writeScreen.setBkgData(t)},t.prototype.setMode=function(t){t!==this.mode&&(this.mode=t,nr.log("INFO","MODE="+t),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)},t.prototype.insertChars=function(t){for(var e=0;e<t.length;e++)this.writeScreen.insertChar(t[e]);var r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";nr.log("INFO",r+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(nr.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},t.prototype.ccRCL=function(){nr.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},t.prototype.ccBS=function(){nr.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.prototype.ccAOF=function(){},t.prototype.ccAON=function(){},t.prototype.ccDER=function(){nr.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.prototype.ccRU=function(t){nr.log("INFO","RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)},t.prototype.ccFON=function(){nr.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},t.prototype.ccRDC=function(){nr.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},t.prototype.ccTR=function(){nr.log("INFO","TR"),this.setMode("MODE_TEXT")},t.prototype.ccRTD=function(){nr.log("INFO","RTD"),this.setMode("MODE_TEXT")},t.prototype.ccEDM=function(){nr.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},t.prototype.ccCR=function(){nr.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},t.prototype.ccENM=function(){nr.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},t.prototype.ccEOC=function(){if(nr.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,nr.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},t.prototype.ccTO=function(t){nr.log("INFO","TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)},t.prototype.ccMIDROW=function(t){var e={flash:!1};if(e.underline=t%2==1,e.italics=t>=46,e.italics)e.foreground="white";else{var r=Math.floor(t/2)-16,n=["white","green","blue","cyan","red","yellow","magenta"];e.foreground=n[r]}nr.log("INFO","MIDROW: "+JSON.stringify(e)),this.writeScreen.setPen(e)},t.prototype.outputDataUpdate=function(){var t=nr.time;null!==t&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(t,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},t.prototype.cueSplitAtTime=function(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))},t}(),lr=function(){function t(e,r,n){ct(this,t),this.field=e||1,this.outputs=[r,n],this.channels=[new cr(1,r),new cr(2,n)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}return t.prototype.getHandler=function(t){return this.channels[t].getHandler()},t.prototype.setHandler=function(t,e){this.channels[t].setHandler(e)},t.prototype.addData=function(t,e){var r,n,i,o=!1;this.lastTime=t,nr.setTime(t);for(var s=0;s<e.length;s+=2)if(n=127&e[s],i=127&e[s+1],0!==n||0!==i){if(nr.log("DATA","["+ir([e[s],e[s+1]])+"] -> ("+ir([n,i])+")"),r=this.parseCmd(n,i),r||(r=this.parseMidrow(n,i)),r||(r=this.parsePAC(n,i)),r||(r=this.parseBackgroundAttributes(n,i)),!r&&(o=this.parseChars(n,i)))if(this.currChNr&&this.currChNr>=0){var a=this.channels[this.currChNr-1];a.insertChars(o)}else nr.log("WARNING","No channel found yet. TEXT-MODE?");r?this.dataCounters.cmd+=2:o?this.dataCounters.char+=2:(this.dataCounters.other+=2,nr.log("WARNING","Couldn't parse cleaned data "+ir([n,i])+" orig: "+ir([e[s],e[s+1]])))}else this.dataCounters.padding+=2},t.prototype.parseCmd=function(t,e){var r=null,n=(20===t||28===t)&&32<=e&&e<=47,i=(23===t||31===t)&&33<=e&&e<=35;if(!n&&!i)return!1;if(t===this.lastCmdA&&e===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,nr.log("DEBUG","Repeated command ("+ir([t,e])+") is dropped"),!0;r=20===t||23===t?1:2;var o=this.channels[r-1];return 20===t||28===t?32===e?o.ccRCL():33===e?o.ccBS():34===e?o.ccAOF():35===e?o.ccAON():36===e?o.ccDER():37===e?o.ccRU(2):38===e?o.ccRU(3):39===e?o.ccRU(4):40===e?o.ccFON():41===e?o.ccRDC():42===e?o.ccTR():43===e?o.ccRTD():44===e?o.ccEDM():45===e?o.ccCR():46===e?o.ccENM():47===e&&o.ccEOC():o.ccTO(e-32),this.lastCmdA=t,this.lastCmdB=e,this.currChNr=r,!0},t.prototype.parseMidrow=function(t,e){var r=null;if((17===t||25===t)&&32<=e&&e<=47){if((r=17===t?1:2)!==this.currChNr)return nr.log("ERROR","Mismatch channel in midrow parsing"),!1;return this.channels[r-1].ccMIDROW(e),nr.log("DEBUG","MIDROW ("+ir([t,e])+")"),!0}return!1},t.prototype.parsePAC=function(t,e){var r=null,n=null,i=(17<=t&&t<=23||25<=t&&t<=31)&&64<=e&&e<=127,o=(16===t||24===t)&&64<=e&&e<=95;if(!i&&!o)return!1;if(t===this.lastCmdA&&e===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;r=t<=23?1:2,n=64<=e&&e<=95?1===r?Ze[t]:tr[t]:1===r?Je[t]:er[t];var s=this.interpretPAC(n,e);return this.channels[r-1].setPAC(s),this.lastCmdA=t,this.lastCmdB=e,this.currChNr=r,!0},t.prototype.interpretPAC=function(t,e){var r=e,n={color:null,italics:!1,indent:null,underline:!1,row:t};return r=e>95?e-96:e-64,n.underline=1==(1&r),r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((r-16)/2),n},t.prototype.parseChars=function(t,e){var r=null,n=null,i=null;if(t>=25?(r=2,i=t-8):(r=1,i=t),17<=i&&i<=19){var o=e;o=17===i?e+80:18===i?e+112:e+144,nr.log("INFO","Special char '"+Xe(o)+"' in channel "+r),n=[o]}else 32<=t&&t<=127&&(n=0===e?[t]:[t,e]);if(n){var s=ir(n);nr.log("DEBUG","Char codes =  "+s.join(",")),this.lastCmdA=null,this.lastCmdB=null}return n},t.prototype.parseBackgroundAttributes=function(t,e){var r,n,i,o,s=(16===t||24===t)&&32<=e&&e<=47,a=(23===t||31===t)&&45<=e&&e<=47;return!(!s&&!a)&&(r={},16===t||24===t?(n=Math.floor((e-32)/2),r.background=rr[n],e%2==1&&(r.background=r.background+"_semi")):45===e?r.background="transparent":(r.foreground="black",47===e&&(r.underline=!0)),i=t<24?1:2,o=this.channels[i-1],o.setBkgData(r),this.lastCmdA=null,this.lastCmdB=null,!0)},t.prototype.reset=function(){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].reset();this.lastCmdA=null,this.lastCmdB=null},t.prototype.cueSplitAtTime=function(t){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].cueSplitAtTime(t)},t}(),fr=lr,dr=function(t,e,r){return t.substr(r||0,e.length)===e},hr=function(t){var e=parseInt(t.substr(-3)),r=parseInt(t.substr(-6,2)),n=parseInt(t.substr(-9,2)),i=t.length>9?parseInt(t.substr(0,t.indexOf(":"))):0;return isNaN(e)||isNaN(r)||isNaN(n)||isNaN(i)?-1:(e+=1e3*r,e+=6e4*n,e+=36e5*i)},pr=function(t){for(var e=5381,r=t.length;r;)e=33*e^t.charCodeAt(--r);return(e>>>0).toString()},vr=function(t,e,r){var n=t[e],i=t[n.prevCC];if(!i||!i.new&&n.new)return t.ccOffset=t.presentationOffset=n.start,void(n.new=!1);for(;i&&i.new;)t.ccOffset+=n.start-i.start,n.new=!1,n=i,i=t[n.prevCC];t.presentationOffset=r},gr={parse:function(t,e,r,n,i,o){var s=/\r\n|\n\r|\n|\r/g,a=String.fromCharCode.apply(null,new Uint8Array(t)).trim().replace(s,"\n").split("\n"),u="00:00.000",c=0,l=0,f=0,d=[],h=void 0,p=!0,v=new Ke;v.oncue=function(t){var e=r[n],i=r.ccOffset;e&&e.new&&(void 0!==l?i=r.ccOffset=e.start:vr(r,n,f)),f&&(i=f+r.ccOffset-r.presentationOffset),t.startTime+=i-l,t.endTime+=i-l,t.id=pr(t.startTime)+pr(t.endTime)+pr(t.text),t.text=decodeURIComponent(escape(t.text)),t.endTime>0&&d.push(t)},v.onparsingerror=function(t){h=t},v.onflush=function(){if(h&&o)return void o(h);i(d)},a.forEach(function(t){if(p){if(dr(t,"X-TIMESTAMP-MAP=")){p=!1,t.substr(16).split(",").forEach(function(t){dr(t,"LOCAL:")?u=t.substr(6):dr(t,"MPEGTS:")&&(c=parseInt(t.substr(7)))});try{e=e<0?e+8589934592:e,c-=e,l=hr(u)/1e3,f=c/9e4,-1===l&&(h=new Error("Malformed X-TIMESTAMP-MAP: "+t))}catch(e){h=new Error("Malformed X-TIMESTAMP-MAP: "+t)}return}""===t&&(p=!1)}v.parse(t+"\n")}),v.flush()}},yr=gr,mr=function(t){function e(r){lt(this,e);var n=ft(this,t.call(this,r,Dt.a.MEDIA_ATTACHING,Dt.a.MEDIA_DETACHING,Dt.a.FRAG_PARSING_USERDATA,Dt.a.MANIFEST_LOADING,Dt.a.MANIFEST_LOADED,Dt.a.FRAG_LOADED,Dt.a.LEVEL_SWITCHING,Dt.a.INIT_PTS_FOUND));if(n.hls=r,n.config=r.config,n.enabled=!0,n.Cues=r.config.cueHandler,n.textTracks=[],n.tracks=[],n.unparsedVttFrags=[],n.initPTS=void 0,n.cueRanges=[],n.config.enableCEA708Captions){var i=n,o=function(t,e){var r=null;try{r=new window.Event("addtrack")}catch(t){r=document.createEvent("Event"),r.initEvent("addtrack",!1,!1)}r.track=t,e.dispatchEvent(r)},s={newCue:function(t,e,r){if(!i.textTrack1){var n=i.getExistingTrack("1");if(n)i.textTrack1=n,ht(i.textTrack1),o(i.textTrack1,i.media);else{var s=i.createTextTrack("captions",i.config.captionsTextTrack1Label,i.config.captionsTextTrack1LanguageCode);s&&(s.textTrack1=!0,i.textTrack1=s)}}i.addCues("textTrack1",t,e,r)}},a={newCue:function(t,e,r){if(!i.textTrack2){var n=i.getExistingTrack("2");if(n)i.textTrack2=n,ht(i.textTrack2),o(i.textTrack2,i.media);else{var s=i.createTextTrack("captions",i.config.captionsTextTrack2Label,i.config.captionsTextTrack1LanguageCode);s&&(s.textTrack2=!0,i.textTrack2=s)}}i.addCues("textTrack2",t,e,r)}};n.cea608Parser=new fr(0,s,a)}return n}return dt(e,t),e.prototype.addCues=function(t,e,r,n){for(var i=this.cueRanges,o=!1,s=i.length;s--;){var a=i[s],u=vt(a[0],a[1],e,r);if(u>=0&&(a[0]=Math.min(a[0],e),a[1]=Math.max(a[1],r),o=!0,u/(r-e)>.5))return}o||i.push([e,r]),this.Cues.newCue(this[t],e,r,n)},e.prototype.onInitPtsFound=function(t){var e=this;void 0===this.initPTS&&(this.initPTS=t.initPTS),this.unparsedVttFrags.length&&(this.unparsedVttFrags.forEach(function(t){e.onFragLoaded(t)}),this.unparsedVttFrags=[])},e.prototype.getExistingTrack=function(t){var e=this.media;if(e)for(var r=0;r<e.textTracks.length;r++){var n=e.textTracks[r],i="textTrack"+t;if(!0===n[i])return n}return null},e.prototype.createTextTrack=function(t,e,r){var n=this.media;if(n)return n.addTextTrack(t,e,r)},e.prototype.destroy=function(){Pt.prototype.destroy.call(this)},e.prototype.onMediaAttaching=function(t){this.media=t.media},e.prototype.onMediaDetaching=function(){ht(this.textTrack1),ht(this.textTrack2)},e.prototype.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0};var t=this.media;if(t){var e=t.textTracks;if(e)for(var r=0;r<e.length;r++)ht(e[r])}},e.prototype.onManifestLoaded=function(t){var e=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=void 0,this.cueRanges=[],this.config.enableWebVTT){this.tracks=t.subtitles||[];var r=this.media?this.media.textTracks:[];this.tracks.forEach(function(t,n){var i=void 0;if(n<r.length){var o=r[n];pt(o,t)&&(i=o)}i||(i=e.createTextTrack("subtitles",t.name,t.lang)),i.mode=t.default?"showing":"hidden",e.textTracks.push(i)})}},e.prototype.onLevelSwitching=function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions},e.prototype.onFragLoaded=function(t){var e=t.frag,r=t.payload;if("main"===e.type){var n=e.sn;if(n!==this.lastSn+1){var i=this.cea608Parser;i&&i.reset()}this.lastSn=n}else if("subtitle"===e.type)if(r.byteLength){if(void 0===this.initPTS)return void this.unparsedVttFrags.push(t);var o=this.vttCCs;o[e.cc]||(o[e.cc]={start:e.start,prevCC:this.prevCC,new:!0},this.prevCC=e.cc);var s=this.textTracks,a=this.hls;yr.parse(r,this.initPTS,o,e.cc,function(t){var r=s[e.trackId];t.forEach(function(t){if(!r.cues.getCueById(t.id))try{r.addCue(t)}catch(n){var e=new window.TextTrackCue(t.startTime,t.endTime,t.text);e.id=t.id,r.addCue(e)}}),a.trigger(Dt.a.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},function(t){Lt.b.log("Failed to parse VTT cue: "+t),a.trigger(Dt.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})})}else this.hls.trigger(Dt.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})},e.prototype.onFragParsingUserdata=function(t){if(this.enabled&&this.config.enableCEA708Captions)for(var e=0;e<t.samples.length;e++){var r=this.extractCea608Data(t.samples[e].bytes);this.cea608Parser.addData(t.samples[e].pts,r)}},e.prototype.extractCea608Data=function(t){for(var e,r,n,i,o,s=31&t[0],a=2,u=[],c=0;c<s;c++)e=t[a++],r=127&t[a++],n=127&t[a++],i=0!=(4&e),o=3&e,0===r&&0===n||i&&0===o&&(u.push(r),u.push(n));return u},e}(Pt),Er=mr,_r=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),br=function(t){function e(r){gt(this,e);var n=yt(this,t.call(this,r,Dt.a.MEDIA_ATTACHED,Dt.a.MEDIA_DETACHING,Dt.a.MANIFEST_LOADING,Dt.a.MANIFEST_LOADED,Dt.a.SUBTITLE_TRACK_LOADED));return n.tracks=[],n.trackId=-1,n.media=void 0,n}return mt(e,t),e.prototype._onTextTracksChanged=function(){if(this.media){for(var t=-1,e=Et(this.media.textTracks),r=0;r<e.length;r++)"showing"===e[r].mode&&(t=r);this.subtitleTrack=t}},e.prototype.destroy=function(){Pt.prototype.destroy.call(this)},e.prototype.onMediaAttached=function(t){var e=this;this.media=t.media,this.media&&(this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){e.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},e.prototype.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=void 0)},e.prototype.onManifestLoading=function(){this.tracks=[],this.trackId=-1},e.prototype.onManifestLoaded=function(t){var e=this,r=t.subtitles||[],n=!1;this.tracks=r,this.trackId=-1,this.hls.trigger(Dt.a.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:r}),r.forEach(function(t){t.default&&(e.subtitleTrack=t.id,n=!0)})},e.prototype.onTick=function(){var t=this.trackId,e=this.tracks[t];if(e){var r=e.details;void 0!==r&&!0!==r.live||(Lt.b.log("(re)loading playlist for subtitle track "+t),this.hls.trigger(Dt.a.SUBTITLE_TRACK_LOADING,{url:e.url,id:t}))}},e.prototype.onSubtitleTrackLoaded=function(t){var e=this;t.id<this.tracks.length&&(Lt.b.log("subtitle track "+t.id+" loaded"),this.tracks[t.id].details=t.details,t.details.live&&!this.timer&&(this.timer=setInterval(function(){e.onTick()},1e3*t.details.targetduration,this)),!t.details.live&&this.timer&&(clearInterval(this.timer),this.timer=null))},e.prototype.setSubtitleTrackInternal=function(t){if(t>=0&&t<this.tracks.length){this.timer&&(clearInterval(this.timer),this.timer=null),this.trackId=t,Lt.b.log("switching to subtitle track "+t);var e=this.tracks[t];this.hls.trigger(Dt.a.SUBTITLE_TRACK_SWITCH,{id:t});var r=e.details;void 0!==r&&!0!==r.live||(Lt.b.log("(re)loading playlist for subtitle track "+t),this.hls.trigger(Dt.a.SUBTITLE_TRACK_LOADING,{url:e.url,id:t}))}},_r(e,[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(t){this.trackId!==t&&this.setSubtitleTrackInternal(t)}}]),e}(Pt),Tr=br,Sr=function(t){function e(r){_t(this,e);var n=bt(this,t.call(this,r,Dt.a.ERROR,Dt.a.SUBTITLE_TRACKS_UPDATED,Dt.a.SUBTITLE_TRACK_SWITCH,Dt.a.SUBTITLE_TRACK_LOADED,Dt.a.SUBTITLE_FRAG_PROCESSED));return n.config=r.config,n.vttFragSNsProcessed={},n.vttFragQueues=void 0,n.currentlyProcessing=null,n.currentTrackId=-1,n}return Tt(e,t),e.prototype.destroy=function(){Pt.prototype.destroy.call(this)},e.prototype.clearVttFragQueues=function(){var t=this;this.vttFragQueues={},this.tracks.forEach(function(e){t.vttFragQueues[e.id]=[]})},e.prototype.nextFrag=function(){if(null===this.currentlyProcessing&&this.currentTrackId>-1&&this.vttFragQueues[this.currentTrackId].length){var t=this.currentlyProcessing=this.vttFragQueues[this.currentTrackId].shift();this.hls.trigger(Dt.a.FRAG_LOADING,{frag:t})}},e.prototype.onSubtitleFragProcessed=function(t){t.success&&this.vttFragSNsProcessed[t.frag.trackId].push(t.frag.sn),this.currentlyProcessing=null,this.nextFrag()},e.prototype.onError=function(t){var e=t.frag;e&&"subtitle"!==e.type||this.currentlyProcessing&&(this.currentlyProcessing=null,this.nextFrag())},e.prototype.onSubtitleTracksUpdated=function(t){var e=this;Lt.b.log("subtitle tracks updated"),this.tracks=t.subtitleTracks,this.clearVttFragQueues(),this.vttFragSNsProcessed={},this.tracks.forEach(function(t){e.vttFragSNsProcessed[t.id]=[]})},e.prototype.onSubtitleTrackSwitch=function(t){this.currentTrackId=t.id,this.clearVttFragQueues()},e.prototype.onSubtitleTrackLoaded=function(t){var e=this.vttFragSNsProcessed[t.id],r=this.vttFragQueues[t.id],n=this.currentlyProcessing?this.currentlyProcessing.sn:-1,i=function(t){return e.indexOf(t.sn)>-1},o=function(t){return r.some(function(e){return e.sn===t.sn})};t.details.fragments.forEach(function(e){i(e)||e.sn===n||o(e)||(e.trackId=t.id,r.push(e))}),this.nextFrag()},e}(Pt),wr=Sr,Ar={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,maxSeekHole:2,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.2,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,fragLoadingLoopThreshold:3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:ke,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,fetchSetup:void 0,abrController:Re,bufferController:Oe,capLevelController:Ie,fpsController:Me,stretchShortVideoTrack:!1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0};Ar.subtitleStreamController=wr,Ar.subtitleTrackController=Tr,Ar.timelineController=Er,Ar.cueHandler=wt,Ar.enableCEA708Captions=!0,Ar.enableWebVTT=!0,Ar.captionsTextTrack1Label="English",Ar.captionsTextTrack1LanguageCode="en",Ar.captionsTextTrack2Label="Spanish",Ar.captionsTextTrack2LanguageCode="es",Ar.audioStreamController=He,Ar.audioTrackController=Ue;var Rr=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),Dr=function(){function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};St(this,t);var n=t.DefaultConfig;if((r.liveSyncDurationCount||r.liveMaxLatencyDurationCount)&&(r.liveSyncDuration||r.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var i in n)i in r||(r[i]=n[i]);if(void 0!==r.liveMaxLatencyDurationCount&&r.liveMaxLatencyDurationCount<=r.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==r.liveMaxLatencyDuration&&(r.liveMaxLatencyDuration<=r.liveSyncDuration||void 0===r.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(Lt.a)(r.debug),this.config=r,this._autoLevelCapping=-1;var o=this.observer=new ne.a;o.trigger=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];o.emit.apply(o,[t,t].concat(r))},o.off=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];o.removeListener.apply(o,[t].concat(r))},this.on=o.on.bind(o),this.off=o.off.bind(o),this.trigger=o.trigger.bind(o);var s=this.abrController=new r.abrController(this),a=new r.bufferController(this),u=new r.capLevelController(this),c=new r.fpsController(this),l=new Yt(this),f=new zt(this),d=new Qt(this),h=new Ee(this),p=this.levelController=new ge(this),v=this.streamController=new he(this),g=[p,v],y=r.audioStreamController;y&&g.push(new y(this)),this.networkControllers=g;var m=[l,f,d,s,a,u,c,h];if(y=r.audioTrackController){var E=new y(this);this.audioTrackController=E,m.push(E)}if(y=r.subtitleTrackController){var _=new y(this);this.subtitleTrackController=_,m.push(_)}[r.subtitleStreamController,r.timelineController].forEach(function(t){t&&m.push(new t(e))}),this.coreComponents=m}return t.isSupported=function(){var t=window.MediaSource=window.MediaSource||window.WebKitMediaSource,e=window.SourceBuffer=window.SourceBuffer||window.WebKitSourceBuffer,r=t&&"function"==typeof t.isTypeSupported&&t.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!e||e.prototype&&"function"==typeof e.prototype.appendBuffer&&"function"==typeof e.prototype.remove;return r&&n},Rr(t,null,[{key:"version",get:function(){return"0.8.2"}},{key:"Events",get:function(){return Dt.a}},{key:"ErrorTypes",get:function(){return Ot.b}},{key:"ErrorDetails",get:function(){return Ot.a}},{key:"DefaultConfig",get:function(){return t.defaultConfig?t.defaultConfig:Ar},set:function(e){t.defaultConfig=e}}]),t.prototype.destroy=function(){Lt.b.log("destroy"),this.trigger(Dt.a.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(t){t.destroy()}),this.url=null,this.observer.removeAllListeners(),this._autoLevelCapping=-1},t.prototype.attachMedia=function(t){Lt.b.log("attachMedia"),this.media=t,this.trigger(Dt.a.MEDIA_ATTACHING,{media:t})},t.prototype.detachMedia=function(){Lt.b.log("detachMedia"),this.trigger(Dt.a.MEDIA_DETACHING),this.media=null},t.prototype.loadSource=function(t){t=Rt.a.buildAbsoluteURL(window.location.href,t,{alwaysNormalize:!0}),Lt.b.log("loadSource:"+t),this.url=t,this.trigger(Dt.a.MANIFEST_LOADING,{url:t})},t.prototype.startLoad=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;Lt.b.log("startLoad("+t+")"),this.networkControllers.forEach(function(e){e.startLoad(t)})},t.prototype.stopLoad=function(){Lt.b.log("stopLoad"),this.networkControllers.forEach(function(t){t.stopLoad()})},t.prototype.swapAudioCodec=function(){Lt.b.log("swapAudioCodec"),this.streamController.swapAudioCodec()},t.prototype.recoverMediaError=function(){Lt.b.log("recoverMediaError");var t=this.media;this.detachMedia(),this.attachMedia(t)},Rr(t,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(t){Lt.b.log("set currentLevel:"+t),this.loadLevel=t,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(t){Lt.b.log("set nextLevel:"+t),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(t){Lt.b.log("set loadLevel:"+t),this.levelController.manualLevel=t}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(t){this.levelController.nextLoadLevel=t}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(t){Lt.b.log("set firstLevel:"+t),this.levelController.firstLevel=t}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(t){Lt.b.log("set startLevel:"+t);var e=this;-1!==t&&(t=Math.max(t,e.minAutoLevel)),e.levelController.startLevel=t}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(t){Lt.b.log("set autoLevelCapping:"+t),this._autoLevelCapping=t}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var t=this,e=t.levels,r=t.config.minAutoBitrate,n=e?e.length:0,i=0;i<n;i++){if((e[i].realBitrate?Math.max(e[i].realBitrate,e[i].bitrate):e[i].bitrate)>r)return i}return 0}},{key:"maxAutoLevel",get:function(){var t=this,e=t.levels,r=t.autoLevelCapping;return-1===r&&e&&e.length?e.length-1:r}},{key:"nextAutoLevel",get:function(){var t=this;return Math.min(Math.max(t.abrController.nextAutoLevel,t.minAutoLevel),t.maxAutoLevel)},set:function(t){var e=this;e.abrController.nextAutoLevel=Math.max(e.minAutoLevel,t)}},{key:"audioTracks",get:function(){var t=this.audioTrackController;return t?t.audioTracks:[]}},{key:"audioTrack",get:function(){var t=this.audioTrackController;return t?t.audioTrack:-1},set:function(t){var e=this.audioTrackController;e&&(e.audioTrack=t)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTrack:-1},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}}]),t}();e.default=Dr},function(t,e,r){function n(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e.oe=function(t){throw console.error(t),t};var n=e(e.s=ENTRY_MODULE);return n.default||n}function i(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function o(t){var e=[],r=t.toString(),n=r.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!n)return e;for(var o,s=n[1],a=new RegExp("(\\\\n|\\W)"+i(s)+"\\((/\\*.*?\\*/)?s?.*?([\\.|\\-|\\w|/|@]+).*?\\)","g");o=a.exec(r);)e.push(o[3]);return e}function s(t,e){for(var r=[e],n=[],i={};r.length;){var s=r.pop();if(!i[s]&&t[s]){i[s]=!0,n.push(s);var a=o(t[s]);r=r.concat(a)}}return n}t.exports=function(t,e){e=e||{};var i=r.m,o=e.all?Object.keys(i):s(i,t),a="("+n.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+o.map(function(t){return JSON.stringify(t)+": "+i[t].toString()}).join(",")+"})(self);",u=new window.Blob([a],{type:"text/javascript"});if(e.bare)return u;var c=window.URL||window.webkitURL||window.mozURL||window.msURL,l=c.createObjectURL(u),f=new window.Worker(l);return f.objectURL=l,f}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(6),i=r(1),o=r(0),s=r(4),a=r.n(s),u=function(t){var e=new a.a;e.trigger=function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];e.emit.apply(e,[t,t].concat(n))},e.off=function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];e.removeListener.apply(e,[t].concat(n))};var r=function(e,r){t.postMessage({event:e,data:r})};t.addEventListener("message",function(i){var s=i.data;switch(s.cmd){case"init":var a=JSON.parse(s.config);t.demuxer=new n.a(e,s.typeSupported,a,s.vendor);try{Object(o.a)(!0===a.debug)}catch(t){}r("init",null);break;case"demux":t.demuxer.push(s.data,s.decryptdata,s.initSegment,s.audioCodec,s.videoCodec,s.timeOffset,s.discontinuity,s.trackSwitch,s.contiguous,s.duration,s.accurateTimeOffset,s.defaultInitPTS)}}),e.on(i.a.FRAG_DECRYPTED,r),e.on(i.a.FRAG_PARSING_INIT_SEGMENT,r),e.on(i.a.FRAG_PARSED,r),e.on(i.a.ERROR,r),e.on(i.a.FRAG_PARSING_METADATA,r),e.on(i.a.FRAG_PARSING_USERDATA,r),e.on(i.a.INIT_PTS_FOUND,r),e.on(i.a.FRAG_PARSING_DATA,function(e,r){var n=[],i={event:e,data:r};r.data1&&(i.data1=r.data1.buffer,n.push(r.data1.buffer),delete r.data1),r.data2&&(i.data2=r.data2.buffer,n.push(r.data2.buffer),delete r.data2),t.postMessage(i,n)})};e.default=u}]).default})},function(e,r){e.exports=t},function(t,e,r){"use strict";function n(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}function i(t){try{return encodeURIComponent(t)}catch(t){return null}}function o(t){for(var e,r=/([^=?#&]+)=?([^&]*)/g,i={};e=r.exec(t);){var o=n(e[1]),s=n(e[2]);null===o||null===s||o in i||(i[o]=s)}return i}function s(t,e){e=e||"";var r,n,o=[];"string"!=typeof e&&(e="?");for(n in t)if(u.call(t,n)){if(r=t[n],r||null!==r&&r!==a&&!isNaN(r)||(r=""),n=i(n),r=i(r),null===n||null===r)continue;o.push(n+"="+r)}return o.length?e+o.join("&"):""}var a,u=Object.prototype.hasOwnProperty;e.stringify=s,e.parse=o},function(t,e,r){"use strict";t.exports=function(t,e){if(e=e.split(":")[0],!(t=+t))return!1;switch(e){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t}},function(t,e,r){"use strict";(function(e){function n(t){return(t||"").toString().replace(v,"")}function i(t){var r;r="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};var n=r.location||{};t=t||n;var i,o={},s=typeof t;if("blob:"===t.protocol)o=new a(unescape(t.pathname),{});else if("string"===s){o=new a(t,{});for(i in y)delete o[i]}else if("object"===s){for(i in t)i in y||(o[i]=t[i]);void 0===o.slashes&&(o.slashes=d.test(t.href))}return o}function o(t){t=n(t);var e=h.exec(t);return{protocol:e[1]?e[1].toLowerCase():"",slashes:!!e[2],rest:e[3]}}function s(t,e){if(""===t)return e;for(var r=(e||"/").split("/").slice(0,-1).concat(t.split("/")),n=r.length,i=r[n-1],o=!1,s=0;n--;)"."===r[n]?r.splice(n,1):".."===r[n]?(r.splice(n,1),s++):s&&(0===n&&(o=!0),r.splice(n,1),s--);return o&&r.unshift(""),"."!==i&&".."!==i||r.push(""),r.join("/")}function a(t,e,r){if(t=n(t),!(this instanceof a))return new a(t,e,r);var u,c,d,h,p,v,y=g.slice(),m=typeof e,E=this,_=0;for("object"!==m&&"string"!==m&&(r=e,e=null),r&&"function"!=typeof r&&(r=f.parse),e=i(e),c=o(t||""),u=!c.protocol&&!c.slashes,E.slashes=c.slashes||u&&e.slashes,E.protocol=c.protocol||e.protocol||"",t=c.rest,c.slashes||(y[3]=[/(.*)/,"pathname"]);_<y.length;_++)h=y[_],"function"!=typeof h?(d=h[0],v=h[1],d!==d?E[v]=t:"string"==typeof d?~(p=t.indexOf(d))&&("number"==typeof h[2]?(E[v]=t.slice(0,p),t=t.slice(p+h[2])):(E[v]=t.slice(p),t=t.slice(0,p))):(p=d.exec(t))&&(E[v]=p[1],t=t.slice(0,p.index)),E[v]=E[v]||(u&&h[3]?e[v]||"":""),h[4]&&(E[v]=E[v].toLowerCase())):t=h(t);r&&(E.query=r(E.query)),u&&e.slashes&&"/"!==E.pathname.charAt(0)&&(""!==E.pathname||""!==e.pathname)&&(E.pathname=s(E.pathname,e.pathname)),l(E.port,E.protocol)||(E.host=E.hostname,E.port=""),E.username=E.password="",E.auth&&(h=E.auth.split(":"),E.username=h[0]||"",E.password=h[1]||""),E.origin=E.protocol&&E.host&&"file:"!==E.protocol?E.protocol+"//"+E.host:"null",E.href=E.toString()}function u(t,e,r){var n=this;switch(t){case"query":"string"==typeof e&&e.length&&(e=(r||f.parse)(e)),n[t]=e;break;case"port":n[t]=e,l(e,n.protocol)?e&&(n.host=n.hostname+":"+e):(n.host=n.hostname,n[t]="");break;case"hostname":n[t]=e,n.port&&(e+=":"+n.port),n.host=e;break;case"host":n[t]=e,/:\d+$/.test(e)?(e=e.split(":"),n.port=e.pop(),n.hostname=e.join(":")):(n.hostname=e,n.port="");break;case"protocol":n.protocol=e.toLowerCase(),n.slashes=!r;break;case"pathname":case"hash":if(e){var i="pathname"===t?"/":"#";n[t]=e.charAt(0)!==i?i+e:e}else n[t]=e;break;default:n[t]=e}for(var o=0;o<g.length;o++){var s=g[o];s[4]&&(n[s[1]]=n[s[1]].toLowerCase())}return n.origin=n.protocol&&n.host&&"file:"!==n.protocol?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function c(t){t&&"function"==typeof t||(t=f.stringify);var e,r=this,n=r.protocol;n&&":"!==n.charAt(n.length-1)&&(n+=":");var i=n+(r.slashes?"//":"");return r.username&&(i+=r.username,r.password&&(i+=":"+r.password),i+="@"),i+=r.host+r.pathname,e="object"==typeof r.query?t(r.query):r.query,e&&(i+="?"!==e.charAt(0)?"?"+e:e),r.hash&&(i+=r.hash),i}var l=r(5),f=r(4),d=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,h=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,p="[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]",v=new RegExp("^"+p+"+"),g=[["#","hash"],["?","query"],function(t){return t.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],y={hash:1,query:1};a.prototype={set:u,toString:c},a.extractProtocol=o,a.location=i,a.trimLeft=n,a.qs=f,t.exports=a}).call(e,r(7))},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),c=r(3),l=r(2),f=n(l),d=r(0),h=n(d),p=r(1),v=function(t){function e(){return i(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return s(e,t),u(e,[{key:"_wrapHlsInstance",value:function(){var t=(0,p.getFragmentParameters)();if(null!=t){var e=t.srKey||t.streamrootKey;if("string"==typeof e){var r={playerInfo:{name:"clappr",version:window.Clappr.version}};new h.default(this._hls,e,this._options.dnaConfig,r)}else console.error('Missing or invalid Streamroot key, please make sure to have "?srKey=your-streamroot-key" on script loading tag.')}}},{key:"_coreSetupHls",value:function(){var t=this,e={maxBufferSize:0,maxBufferLength:30,liveSyncDuration:30};this._options.hlsjsConfig&&void 0!==this._options.hlsjsConfig.liveSyncDurationCount&&delete e.liveSyncDuration;var r=a({},e,this._options.hlsjsConfig);this._hls=new f.default(r),this._wrapHlsInstance(),this._hls.on(f.default.Events.MEDIA_ATTACHED,function(){t._hls.loadSource(t._options.src)}),this._hls.on(f.default.Events.LEVEL_LOADED,function(e,r){return t._updatePlaybackType(e,r)}),this._hls.on(f.default.Events.LEVEL_UPDATED,function(e,r){return t._onLevelUpdated(e,r)}),this._hls.on(f.default.Events.LEVEL_SWITCH,function(e,r){return t._onLevelSwitch(e,r)}),this._hls.on(f.default.Events.FRAG_LOADED,function(e,r){return t._onFragmentLoaded(e,r)}),this._hls.on(f.default.Events.ERROR,function(e,r){return t._onHLSJSError(e,r)})}},{key:"_setupHls",value:function(){this._coreSetupHls(),this._hls.attachMedia(this.el)}},{key:"_setup",value:function(){var t=this;this._ccIsSetup=!1,this._ccTracksUpdated=!1,this._coreSetupHls(),this._hls.on(f.default.Events.SUBTITLE_TRACK_LOADED,function(e,r){return t._onSubtitleLoaded(e,r)}),this._hls.on(f.default.Events.SUBTITLE_TRACKS_UPDATED,function(){return t._ccTracksUpdated=!0}),this._hls.attachMedia(this.el),this._ready()}}],[{key:"version",get:function(){return"v1.0.87"}},{key:"name",get:function(){return"HlsDnaPlugin"}}]),e}(c.HLS);v.canPlay=c.HLS.canPlay,e.default=v,t.exports=e.default}])});